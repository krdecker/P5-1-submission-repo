function getModel(){return localStorage.model?JSON.parse(localStorage.model):EatsModel}function buildWindowContent(e){var t="http://maps.googleapis.com/maps/api/streetview?size=200x150&location="+e.position.toString(),o='<img class="bgimg" src="'+t+'">',n='"height:100%;width:80%"',i='<div onclick="itchwindow()" style='+n+">"+o+'<br><span style="color:darkgreen">'+e.title+'</span><br><span style="color:red">-CLICK FOR MORE INFO-</span></div>';return i}function buildSlideContent(e){function t(t){var i=t.response.venues[0];$.ajax({url:fourSquareURL+"/v2/venues/"+i.id,dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,error:n}).success(function(e){o(e)})}function o(t){var o=t.response.venue;i="FourSquare info: <br><br>"+o.name+"<br>"+o.contact.formattedPhone+"<br>- "+o.location.address+"<br>- "+o.location.city+"<br>- "+o.location.country+"<br>x-street: "+o.location.crossStreet+"<br>Check-ins: "+o.stats.checkinsCount.toString()+"<br>"+o.likes.summary+'<br><br><span style="background-color:#'+o.ratingColor+';color:black;padding:1%">Rating: '+o.rating.toString()+'</span><br><img src="'+o.bestPhoto.prefix+"cap300"+o.bestPhoto.suffix+'">',e.slideContent=i}function n(t,o,n){var i="Sorry. 3rd party info unavailable.";e.slideContent=i+n}var i="",s="ll="+e.location.lat.toString()+","+e.location.lng.toString();$.ajax({url:fourSquareURL+"/v2/venues/search",dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,error:n}).success(function(e){t(e)})}function init(){map=new google.maps.Map(document.getElementById("map-div"),mapOptions),model=getModel(),(void 0==model.spots[0].slideContent||"Sorry"==model.spots[0].slideContent.slice(0,5))&&model.spots.forEach(function(e){e.slideContent="",buildSlideContent(e)}),viewModel.spotList(model.spots),infowindow=new google.maps.InfoWindow({}),map.setZoom(model.zoomLevel),map.setCenter(model.center),model.spots.forEach(function(e){eatingSpots.push(new Spot(e))}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(model.center)}),window.setTimeout(function(){localStorage.model=JSON.stringify(model)},3e3)}function filterList(e,t){var o=[],n=new RegExp(e,["i"]);return t.forEach(function(e,t,i){n.test(e.name)&&o.push(e)}),o}function getSpot(e){var t;return eatingSpots.forEach(function(o){o.name==e&&(t=o)}),t}function resetMarkers(e){eatingSpots.forEach(function(e){e.hideMarker()});for(var t in e)getSpot(e[t].name).showMarker()}function itchwindow(){viewModel.openAPIslide(infowindow.anchor.title)}function cleanUpScreen(){infowindow.close(),map.setZoom(model.zoomLevel),map.setCenter(model.center),viewModel.slideOff()}function dubSlideContents(){if(model.spots[0].slideContent)for(var e in model.spots)eatingSpots[e].slideContent=model.spots[e].slideContent,localStorage.model=JSON.stringify(model)}var EatsModel={zoomLevel:18,center:{lat:49.262387,lng:-123.069768},spots:[{name:"Uncle Fatih's Pizza",location:{lat:49.262487,lng:-123.07}},{name:"Buddha's Orient Express",location:{lat:49.262719,lng:-123.069289}},{name:"Booster Juice",location:{lat:49.262641,lng:-123.069438}},{name:"Starbucks Coffee",location:{lat:49.261874,lng:-123.070176}},{name:"Blenz Coffee",location:{lat:49.262534,lng:-123.069529}},{name:"Megabite Pizza",location:{lat:49.262779,lng:-123.069317}},{name:"Broadway Station Sushi",location:{lat:49.262084,lng:-123.070962}}]},model={},fourSquareURL="https://api.foursquare.com",map,eatingSpots=[],infowindow,RedRoadsNGreenBusStops=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{gamma:.65},{hue:"#ff9c30"},{visibility:"on"},{saturation:99},{lightness:-12}]},{featureType:"transit",stylers:[{hue:"#00ff33"},{gamma:.6},{saturation:5},{visibility:"on"},{weight:4.6},{lightness:-12}]}],mapOptions={center:{lat:49.262387,lng:-123.069768},zoom:16,zoomControl:!0,scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,disableDefaultUI:!0,styles:RedRoadsNGreenBusStops},Spot=function(e){var t=this;this.name=e.name,this.location=e.location,this.slideContent=e.slideContent,this.marker=new google.maps.Marker({position:this.location,title:this.name,map:map,opacity:.4}),this.windowContent=buildWindowContent(this.marker),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(){t.doOpening()})};Spot.prototype.doOpening=function(){var e=this;cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.openWindow(),e.marker.setAnimation(null)},1e3)},Spot.prototype.openWindow=function(){viewModel.listCollapse(),infowindow.setContent(this.windowContent),infowindow.open(map,this.marker)},Spot.prototype.hideMarker=function(){this.marker.setMap(null)},Spot.prototype.showMarker=function(){this.marker.setMap(map)};var ViewModel=function(){var e=this;e.listOn=ko.observable(!0),e.burgerMenu=ko.observable(!1),e.spotList=ko.observableArray(),e.slideOn=ko.observable(!1),e.slideContent=ko.observable(),e.filterSlot=ko.observable(),e.isSelected=ko.observable(!1),e.spotPick=function(){var e=getSpot(this.name);e.doOpening()},e.setFilterSelected=function(){this.isSelected(!0),cleanUpScreen(),e.listExpand()},e.filterSlot.subscribe(function(t){e.listExpand(),e.spotList(filterList(t,eatingSpots)),resetMarkers(e.spotList())}),e.onEnter=function(t,o){return 13===o.keyCode?infowindow.anchor?e.openAPIslide(infowindow.anchor.title):1===e.spotList().length&&e.spotList()[0].doOpening():(infowindow&&infowindow.close(),e.slideOff(),e.listExpand()),!0},e.listCollapse=function(){e.listOn(!1),e.burgerMenu(!0)},e.listExpand=function(){cleanUpScreen(),e.burgerMenu(!1),e.listOn(!0)},e.openAPIslide=function(e){var t=getSpot(e);t.slideContent||dubSlideContents(),viewModel.slideContent(t.slideContent),viewModel.slideOn(!0)},e.slideOff=function(){this.slideOn(!1)}},viewModel=new ViewModel;ko.applyBindings(viewModel);var kr={foursquare:{Owner:"KR Decker",Client_id:"ZVLKTKSGULFEQ3XMWWI3AL1A2KXYBEKD1LKSURUZDGZY41JX",Client_secret:"TMT203DHWOPR3R4RSM1HE4RMOKEWLGTT0FLMZMUZ1OJHMAK1"},yelp:{Consumer_Key:"XrxJOUgGNKq9ZuWhBX1LDw",Consumer_Secret:"zr2I76nT8l0O-trkupYE00B9BTA",Token:"-_F8aOxonR6q5SqvURwwgLIdU-qteS-B",Token_Secret:"GF7uRcPWCpzlHcRP3DiJWjvcXJE"}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnZXRNb2RlbCIsImxvY2FsU3RvcmFnZSIsIm1vZGVsIiwiSlNPTiIsInBhcnNlIiwiRWF0c01vZGVsIiwiYnVpbGRXaW5kb3dDb250ZW50IiwibWFya2VyIiwic3RyZWV0dmlld1VybCIsInBvc2l0aW9uIiwidG9TdHJpbmciLCJwaWN0dXJlIiwiY3NzIiwiY29udGVudCIsInRpdGxlIiwiYnVpbGRTbGlkZUNvbnRlbnQiLCJzcG90IiwiZ2V0VmVudWVJbmZvIiwiZGF0YSIsInZlbnVlIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCIkIiwiYWpheCIsInVybCIsImZvdXJTcXVhcmVVUkwiLCJpZCIsImRhdGFUeXBlIiwibG9jIiwibmFtZSIsImtyIiwiZm91cnNxdWFyZSIsIkNsaWVudF9pZCIsIkNsaWVudF9zZWNyZXQiLCJhc3luYyIsImVycm9yIiwic2VuZEVycm9yIiwic3VjY2VzcyIsImZvcm1hdFNob3dEYXRhIiwiZm9ybWF0dGVkRGF0YSIsImNvbnRhY3QiLCJmb3JtYXR0ZWRQaG9uZSIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiY3Jvc3NTdHJlZXQiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJsaWtlcyIsInN1bW1hcnkiLCJyYXRpbmdDb2xvciIsInJhdGluZyIsImJlc3RQaG90byIsInByZWZpeCIsInN1ZmZpeCIsInNsaWRlQ29udGVudCIsIm9iamVjdCIsImV4Y2VwdGlvbiIsImFqYXhfZXJyb3IiLCJsYXQiLCJsbmciLCJpbml0IiwibWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtYXBPcHRpb25zIiwidW5kZWZpbmVkIiwic3BvdHMiLCJzbGljZSIsImZvckVhY2giLCJ2aWV3TW9kZWwiLCJzcG90TGlzdCIsImluZm93aW5kb3ciLCJJbmZvV2luZG93Iiwic2V0Wm9vbSIsInpvb21MZXZlbCIsInNldENlbnRlciIsImNlbnRlciIsImVhdGluZ1Nwb3RzIiwicHVzaCIsIlNwb3QiLCJldmVudCIsImFkZERvbUxpc3RlbmVyIiwid2luZG93Iiwic2V0VGltZW91dCIsInN0cmluZ2lmeSIsImZpbHRlckxpc3QiLCJ1c2VyVGV4dCIsIm1vZGVsQXJyYXkiLCJyZXN1bHQiLCJyZSIsIlJlZ0V4cCIsImVsZW1lbnQiLCJpbmRleCIsImFycmF5IiwidGVzdCIsImdldFNwb3QiLCJyZXNldE1hcmtlcnMiLCJoaWRlTWFya2VyIiwiaSIsInNob3dNYXJrZXIiLCJpdGNod2luZG93Iiwib3BlbkFQSXNsaWRlIiwiYW5jaG9yIiwiY2xlYW5VcFNjcmVlbiIsImNsb3NlIiwic2xpZGVPZmYiLCJkdWJTbGlkZUNvbnRlbnRzIiwiUmVkUm9hZHNOR3JlZW5CdXNTdG9wcyIsImZlYXR1cmVUeXBlIiwiZWxlbWVudFR5cGUiLCJzdHlsZXJzIiwidmlzaWJpbGl0eSIsImdhbW1hIiwiaHVlIiwic2F0dXJhdGlvbiIsImxpZ2h0bmVzcyIsIndlaWdodCIsInpvb20iLCJ6b29tQ29udHJvbCIsInNjcm9sbHdoZWVsIiwiZHJhZ2dhYmxlIiwiZGlzYWJsZURvdWJsZUNsaWNrWm9vbSIsImRpc2FibGVEZWZhdWx0VUkiLCJzdHlsZXMiLCJ0aGF0IiwidGhpcyIsIk1hcmtlciIsIm9wYWNpdHkiLCJ3aW5kb3dDb250ZW50IiwiY2xpY2tFdmVudCIsImFkZExpc3RlbmVyIiwiZG9PcGVuaW5nIiwicHJvdG90eXBlIiwic2V0QW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiQk9VTkNFIiwib3BlbldpbmRvdyIsImxpc3RDb2xsYXBzZSIsInNldENvbnRlbnQiLCJvcGVuIiwic2V0TWFwIiwiVmlld01vZGVsIiwic2VsZiIsImxpc3RPbiIsImtvIiwib2JzZXJ2YWJsZSIsImJ1cmdlck1lbnUiLCJvYnNlcnZhYmxlQXJyYXkiLCJzbGlkZU9uIiwiZmlsdGVyU2xvdCIsImlzU2VsZWN0ZWQiLCJzcG90UGljayIsInNldEZpbHRlclNlbGVjdGVkIiwibGlzdEV4cGFuZCIsInN1YnNjcmliZSIsIm9uRW50ZXIiLCJrZXlDb2RlIiwibGVuZ3RoIiwic3BvdE5hbWUiLCJhcHBseUJpbmRpbmdzIiwiT3duZXIiLCJ5ZWxwIiwiQ29uc3VtZXJfS2V5IiwiQ29uc3VtZXJfU2VjcmV0IiwiVG9rZW4iLCJUb2tlbl9TZWNyZXQiXSwibWFwcGluZ3MiOiJBQThDQSxRQUFTQSxZQUNMLE1BQUlDLGNBQWFDLE1BQ05DLEtBQUtDLE1BQU1ILGFBQWFDLE9BRXhCRyxVQUlmLFFBQVNDLG9CQUFtQkMsR0FDeEIsR0FBSUMsR0FBZ0Isd0VBQ0lELEVBQU9FLFNBQVNDLFdBQ3BDQyxFQUFVLDJCQUE2QkgsRUFBZ0IsS0FDdkRJLEVBQU0sMEJBQ05DLEVBQVUscUNBQ0VELEVBQU0sSUFBTUQsRUFBVSxxQ0FDdEJKLEVBQU9PLE1BQVEsdUVBRy9CLE9BQU9ELEdBT1gsUUFBU0UsbUJBQWtCQyxHQWtCdkIsUUFBU0MsR0FBYUMsR0FDbEIsR0FBSUMsR0FBUUQsRUFBS0UsU0FBU0MsT0FBTyxFQUVqQ0MsR0FBRUMsTUFDRUMsSUFBS0MsY0FBZ0IsY0FBZ0JOLEVBQU1PLEdBQzNDQyxTQUFVLE9BQ1ZULEtBQU0sV0FDUVUsRUFDTixVQUFZWixFQUFLYSxLQUNqQixjQUFlQyxHQUFHQyxXQUFXQyxVQUM3QixrQkFBbUJGLEdBQUdDLFdBQVdFLGNBQ2pDLGNBQ1JDLE9BQU8sRUFDUEMsTUFBT0MsSUFDWkMsUUFBUSxTQUFTakIsR0FDZGtCLEVBQWVsQixLQUdyQixRQUFTa0IsR0FBZXBCLEdBQ3BCLEdBQUlDLEdBQVFELEVBQUtFLFNBQVNELEtBQzFCb0IsR0FBZ0IsNEJBQ2tCcEIsRUFBTVUsS0FBTyxPQUMvQlYsRUFBTXFCLFFBQVFDLGVBQWlCLFNBQ3hCdEIsRUFBTXVCLFNBQVNDLFFBQVUsU0FDekJ4QixFQUFNdUIsU0FBU0UsS0FBUSxTQUN2QnpCLEVBQU11QixTQUFTRyxRQUFXLGlCQUNsQjFCLEVBQU11QixTQUFTSSxZQUFjLGtCQUM1QjNCLEVBQU00QixNQUFNQyxjQUFjdEMsV0FDMUMs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QUFNZ0UsY0FDL0JtQixhQUFhOEMsRUFBS3hFLGNBRXRCd0UsRUFBS2EsUUFBVSxTQUFVOUksRUFBTW1FLEdBZ0IzQixNQWZzQixNQUFsQkEsRUFBTTRFLFFBQ0ZyRixXQUFXK0IsT0FDVHdDLEVBQUt6QyxhQUFhOUIsV0FBVytCLE9BQU83RixPQUdQLElBQTNCcUksRUFBS3hFLFdBQVd1RixRQUNoQmYsRUFBS3hFLFdBQVcsR0FBRzZELGFBS3ZCNUQsWUFBWUEsV0FBV2lDLFFBQzNCc0MsRUFBS3JDLFdBQ0xxQyxFQUFLVyxlQUVGLEdBRVhYLEVBQUtMLGFBQWUsV0FDaEJLLEVBQUtDLFFBQU8sR0FDWkQsRUFBS0ksWUFBVyxJQUVwQkosRUFBS1csV0FBYSxXQUNkbEQsZ0JBQ0F1QyxFQUFLSSxZQUFXLEdBQ2hCSixFQUFLQyxRQUFPLElBRWhCRCxFQUFLekMsYUFBZSxTQUFVeUQsR0FDMUIsR0FBSW5KLEdBQU9vRixRQUFRK0QsRUFDYm5KLEdBQWlCLGNBQ25CK0YsbUJBRUpyQyxVQUFVbEIsYUFBYXhDLEVBQUt3QyxjQUM1QmtCLFVBQVUrRSxTQUFRLElBRXRCTixFQUFLckMsU0FBVyxXQUNab0IsS0FBS3VCLFNBQVEsS0FJakIvRSxVQUFZLEdBQUl3RSxVQUNwQkcsSUFBR2UsY0FBYzFGLFVBbUlqQixJQUFJNUMsS0FDQUMsWUFDSXNJLE1BQU8sWUFDUHJJLFVBQVcsbURBQ1hDLGNBQWUsb0RBRW5CcUksTUFDSUMsYUFBaUIseUJBQ2pCQyxnQkFBaUIsOEJBQ2pCQyxNQUFTLG1DQUNUQyxhQUFpQiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL01PREVMLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLyBlYXRzIGRhdGE6IGFuIGFycmF5IG9mIHBsYWNlcyB0byBlYXRcbi8vIGFyb3VuZCBDb21tZXJjaWFsLUJyb2Fkd2F5IFN0YXRpb25cbi8vIEVhc3QgVmFuXG4vLyBCcml0aXNoIENvbHVtYmlhXG5cbi8vIGJhc2ljIGRhdGEsIGxvYWRlZCBpZiBtb3JlIGRldGFpbGVkIG1vZGVsIG5vdCBmb3VuZCBpbiBsb2NhbFN0b3JhZ2VcbnZhciBFYXRzTW9kZWwgPSB7XG4gICAgem9vbUxldmVsOiAxOCxcbiAgICBjZW50ZXI6IHtsYXQ6IDQ5LjI2MjM4NywgbG5nOiAtMTIzLjA2OTc2OH0sLy80OS4yNjIzODcsIC0xMjMuMDY5NzY4XG4gICAgc3BvdHM6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJVbmNsZSBGYXRpaCdzIFBpenphXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNDg3LCBsbmc6IC0xMjMuMDcwMDAwfSAvL3dhcyAuMjYyNTE3IC4wNzAxNzdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCdWRkaGEncyBPcmllbnQgRXhwcmVzc1wiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjcxOSwgbG5nOiAtMTIzLjA2OTI4OX1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCb29zdGVyIEp1aWNlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNjQxLCBsbmc6IC0xMjMuMDY5NDM4fVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIlN0YXJidWNrcyBDb2ZmZWVcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjE4NzQsIGxuZzogLTEyMy4wNzAxNzZ9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQmxlbnogQ29mZmVlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNTM0LCBsbmc6IC0xMjMuMDY5NTI5fVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIk1lZ2FiaXRlIFBpenphXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNzc5LCBsbmc6IC0xMjMuMDY5MzE3fVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJyb2Fkd2F5IFN0YXRpb24gU3VzaGlcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjIwODQsIGxuZzogLTEyMy4wNzA5NjJ9XG4gICAgICAgIH1cbiAgICBdXG59O1xuXG52YXIgbW9kZWwgPSB7fTtcblxuZnVuY3Rpb24gZ2V0TW9kZWwoKSB7XG4gICAgaWYgKGxvY2FsU3RvcmFnZS5tb2RlbCkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UubW9kZWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBFYXRzTW9kZWw7XG4gICAgfTtcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkV2luZG93Q29udGVudChtYXJrZXIpIHtcbiAgICB2YXIgc3RyZWV0dmlld1VybCA9ICdodHRwOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9zdHJlZXR2aWV3P3NpemU9MjAweDE1MCZsb2NhdGlvbj0nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXIucG9zaXRpb24udG9TdHJpbmcoKSArICcnO1xuICAgIHZhciBwaWN0dXJlID0gJzxpbWcgY2xhc3M9XCJiZ2ltZ1wiIHNyYz1cIicgKyBzdHJlZXR2aWV3VXJsICsgJ1wiPic7XG4gICAgdmFyIGNzcyA9ICdcImhlaWdodDoxMDAlO3dpZHRoOjgwJVwiJztcbiAgICB2YXIgY29udGVudCA9ICc8ZGl2IG9uY2xpY2s9XCJpdGNod2luZG93KClcIiBzdHlsZT0nICtcbiAgICAgICAgICAgICAgICAgICAgY3NzICsgJz4nICsgcGljdHVyZSArICc8YnI+PHNwYW4gc3R5bGU9XCJjb2xvcjpkYXJrZ3JlZW5cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLnRpdGxlICsgJzwvc3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxicj48c3BhbiBzdHlsZT1cImNvbG9yOnJlZFwiPi1DTElDSyBGT1IgTU9SRSBJTkZPLTwvc3Bhbj48L2Rpdj4nO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gM3JkIHBhcnR5IEFQSSBzdHVmZlxudmFyIGZvdXJTcXVhcmVVUkwgPSAnaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20nO1xuXG5mdW5jdGlvbiBidWlsZFNsaWRlQ29udGVudChzcG90KSB7XG4gICAgdmFyIGZvcm1hdHRlZERhdGEgPSBcIlwiO1xuICAgIHZhciBsb2MgPSBcImxsPVwiICsgc3BvdC5sb2NhdGlvbi5sYXQudG9TdHJpbmcoKSArIFwiLFwiICsgc3BvdC5sb2NhdGlvbi5sbmcudG9TdHJpbmcoKTtcbiAgICB2YXIgYWpheF9lcnJvcjtcbiAgICAvLyBnZXQgdGhlIGZvdXJzcXVhcmUgSUQgbnVtYmVyIG9mIHRoZSBzcG90XG4gICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogZm91clNxdWFyZVVSTCArICcvdjIvdmVudWVzL3NlYXJjaCcsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgZGF0YTogJ2xpbWl0PTEnICtcbiAgICAgICAgICAgICAgICAgICAgJyYnICsgbG9jICsgJyZxdWVyeT0nICsgc3BvdC5uYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJyZjbGllbnRfaWQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfaWQgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9zZWNyZXQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfc2VjcmV0ICtcbiAgICAgICAgICAgICAgICAgICAgJyZ2PTIwMTYwMTMwJyxcbiAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgZXJyb3I6IHNlbmRFcnJvclxuICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgIGdldFZlbnVlSW5mbyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIGZ1bmN0aW9uIGdldFZlbnVlSW5mbyhkYXRhKSB7XG4gICAgICAgIHZhciB2ZW51ZSA9IGRhdGEucmVzcG9uc2UudmVudWVzWzBdO1xuICAgICAgICAvL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9WRU5VRV9JRFxuICAgICAgICAkLmFqYXgoeyAvLyB0byBnZXQgdGhlIGRldGFpbGVkIGZvdXJzcXVhcmUgb2YgdGhlICdjb21wbGV0ZSB2ZW51ZScgYmFzZWQgb24gSURcbiAgICAgICAgICAgIHVybDogZm91clNxdWFyZVVSTCArICcvdjIvdmVudWVzLycgKyB2ZW51ZS5pZCxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBkYXRhOiAnbGltaXQ9MScgK1xuICAgICAgICAgICAgICAgICAgICAnJicgKyBsb2MgK1xuICAgICAgICAgICAgICAgICAgICAnJnF1ZXJ5PScgKyBzcG90Lm5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9pZD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9pZCArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X3NlY3JldD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9zZWNyZXQgK1xuICAgICAgICAgICAgICAgICAgICAnJnY9MjAxNjAxMzAnLFxuICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjogc2VuZEVycm9yXG4gICAgfSkuc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgZm9ybWF0U2hvd0RhdGEocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZm9ybWF0U2hvd0RhdGEoZGF0YSl7XG4gICAgICAgIHZhciB2ZW51ZSA9IGRhdGEucmVzcG9uc2UudmVudWU7XG4gICAgICAgIGZvcm1hdHRlZERhdGEgPSAnRm91clNxdWFyZSBpbmZvOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8YnI+JyArICc8YnI+JyArIHZlbnVlLm5hbWUgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVudWUuY29udGFjdC5mb3JtYXR0ZWRQaG9uZSArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uYWRkcmVzcyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uY2l0eSAgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJy0gJyArIHZlbnVlLmxvY2F0aW9uLmNvdW50cnkgICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICd4LXN0cmVldDogJyArIHZlbnVlLmxvY2F0aW9uLmNyb3NzU3RyZWV0ICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDaGVjay1pbnM6ICcgKyB2ZW51ZS5zdGF0cy5jaGVja2luc0NvdW50LnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxicj4nICsgdmVudWUubGlrZXMuc3VtbWFyeSArICc8YnI+JyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiMnICsgdmVudWUucmF0aW5nQ29sb3IgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJztjb2xvcjpibGFjaztwYWRkaW5nOjElXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnUmF0aW5nOiAnICsgdmVudWUucmF0aW5nLnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIicgKyB2ZW51ZS5iZXN0UGhvdG8ucHJlZml4ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjYXAzMDAnICsgdmVudWUuYmVzdFBob3RvLnN1ZmZpeCArICdcIj4nXG4gICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgIHNwb3Quc2xpZGVDb250ZW50ID0gZm9ybWF0dGVkRGF0YTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2VuZEVycm9yKG9iamVjdCwgZXJyb3IsIGV4Y2VwdGlvbikge1xuICAgICAgICB2YXIgYWpheF9lcnJvciA9IFwiU29ycnkuIDNyZCBwYXJ0eSBpbmZvIHVuYXZhaWxhYmxlLlwiO1xuICAgICAgICBzcG90LnNsaWRlQ29udGVudCA9IGFqYXhfZXJyb3IgKyBleGNlcHRpb247XG4gICAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL01BUCBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIG1hcDtcbnZhciBlYXRpbmdTcG90cyA9IFtdO1xudmFyIGluZm93aW5kb3c7XG5cbnZhciBSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzID0gW1xuICB7XG4gICAgXCJmZWF0dXJlVHlwZVwiOiBcInBvaVwiLFxuICAgIFwiZWxlbWVudFR5cGVcIjogXCJsYWJlbHNcIixcbiAgICBcInN0eWxlcnNcIjogW1xuICAgICAgICB7IHZpc2liaWxpdHk6IFwib2ZmXCIgfVxuICAgIF1cbiAgfSxcbiAge1xuICAgIFwiZmVhdHVyZVR5cGVcIjogXCJyb2FkXCIsXG4gICAgXCJzdHlsZXJzXCI6IFtcbiAgICAgIHsgXCJnYW1tYVwiOiAwLjY1IH0sXG4gICAgICB7IFwiaHVlXCI6IFwiI2ZmOWMzMFwiIH0sXG4gICAgICB7IFwidmlzaWJpbGl0eVwiOiBcIm9uXCIgfSxcbiAgICAgIHsgXCJzYXR1cmF0aW9uXCI6IDk5IH0sXG4gICAgICB7IFwibGlnaHRuZXNzXCI6IC0xMiB9XG4gICAgXVxuICB9LHtcbiAgICBcImZlYXR1cmVUeXBlXCI6IFwidHJhbnNpdFwiLFxuICAgIFwic3R5bGVyc1wiOiBbXG4gICAgICB7IFwiaHVlXCI6IFwiIzAwZmYzM1wiIH0sXG4gICAgICB7IFwiZ2FtbWFcIjogMC42MCB9LFxuICAgICAgeyBcInNhdHVyYXRpb25cIjogNSB9LFxuICAgICAgeyBcInZpc2liaWxpdHlcIjogXCJvblwiIH0sXG4gICAgICB7IFwid2VpZ2h0XCI6IDQuNiB9LFxuICAgICAgeyBcImxpZ2h0bmVzc1wiOiAtMTIgfSAvL3dhcyAtMjJcbiAgICBdXG4gIH1cbl07XG5cbnZhciBtYXBPcHRpb25zID0ge1xuICAgICAgICBjZW50ZXI6IHtsYXQ6IDQ5LjI2MjM4NywgbG5nOiAtMTIzLjA2OTc2OH0sLy80OS4yNjIzODcsIC0xMjMuMDY5NzY4XG4gICAgICAgIC8vIENvbW1lcmNpYWwgQnJvYWR3YXkgU3RhdGlvbiA0OcKwMTXigLI0NeKAs04sIDEyM8KwMDTigLIwOOKAs1dcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIHpvb21Db250cm9sOiB0cnVlLFxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2UsXG4gICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgZGlzYWJsZURvdWJsZUNsaWNrWm9vbTogdHJ1ZSxcbiAgICAgICAgZGlzYWJsZURlZmF1bHRVSTogdHJ1ZSxcbiAgICAgICAgc3R5bGVzOiBSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzXG4gICAgfTtcblxuLy8gaW52b2tlZCBieSBtYXAgPHNjcmlwdD4gaW4gaW5kZXguaHRtbFxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtZGl2JyksIG1hcE9wdGlvbnMgKTtcbiAgICBtb2RlbCA9IGdldE1vZGVsKCk7IC8vIGxvYWQgZGF0YSBvYmplY3QgZWl0aGVyIGZyb20gbG9jYWxTdG9yYWdlIG9yIGZpbGVcbiAgICAvLyB0aGVuIGJ1aWxkIHRoZSBzbGlkZSBjb250ZW50IHdpdGggYWpheCBhcGkgY2FsbHMsIGlmIG5lY2Vzc2FyeVxuICAgIGlmICggKG1vZGVsLnNwb3RzWzBdLnNsaWRlQ29udGVudCA9PSB1bmRlZmluZWQpIHx8XG4gICAgICAgICAobW9kZWwuc3BvdHNbMF0uc2xpZGVDb250ZW50LnNsaWNlKDAsNSkgPT0gXCJTb3JyeVwiKSkge1xuICAgICAgICAgICAgbW9kZWwuc3BvdHMuZm9yRWFjaCggZnVuY3Rpb24gKHNwb3QpIHtcbiAgICAgICAgICAgICAgICBzcG90LnNsaWRlQ29udGVudCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYnVpbGRTbGlkZUNvbnRlbnQoc3BvdCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmlld01vZGVsLnNwb3RMaXN0KG1vZGVsLnNwb3RzKTtcbiAgICBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe30pO1xuICAgIG1hcC5zZXRab29tKG1vZGVsLnpvb21MZXZlbCk7XG4gICAgbWFwLnNldENlbnRlcihtb2RlbC5jZW50ZXIpO1xuICAgIG1vZGVsLnNwb3RzLmZvckVhY2goIGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICAgZWF0aW5nU3BvdHMucHVzaChuZXcgU3BvdChzcG90KSk7XG4gICAgfSk7XG4gICAgLy8gc3RheSBjZW50cmVkXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICB9KTtcbiAgICB3aW5kb3cuc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5tb2RlbCA9IEpTT04uc3RyaW5naWZ5KG1vZGVsKTtcbiAgICB9LCAzMDAwKTtcbn1cblxuLy8gY29uc3RydWN0b3JcbnZhciBTcG90ID0gZnVuY3Rpb24oZGF0YSkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcbiAgdGhpcy5sb2NhdGlvbiA9IGRhdGEubG9jYXRpb247XG4gIHRoaXMuc2xpZGVDb250ZW50ID0gZGF0YS5zbGlkZUNvbnRlbnQ7XG4gIHRoaXMubWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgIHBvc2l0aW9uOiB0aGlzLmxvY2F0aW9uLFxuICAgICAgICB0aXRsZTogdGhpcy5uYW1lLFxuICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgb3BhY2l0eTogMC40XG4gIH0pO1xuICB0aGlzLndpbmRvd0NvbnRlbnQgPSBidWlsZFdpbmRvd0NvbnRlbnQodGhpcy5tYXJrZXIpO1xuICB0aGlzLmNsaWNrRXZlbnQgPSBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcmtlciwgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuZG9PcGVuaW5nKCk7XG4gICAgfSk7XG59O1xuXG5TcG90LnByb3RvdHlwZS5kb09wZW5pbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICB0aGlzLm1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XG4gICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGF0Lm9wZW5XaW5kb3coKTtcbiAgICAgICAgdGhhdC5tYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xuICAgIH0sIDEwMDApO1xufTtcblxuU3BvdC5wcm90b3R5cGUub3BlbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2aWV3TW9kZWwubGlzdENvbGxhcHNlKCk7XG4gICAgaW5mb3dpbmRvdy5zZXRDb250ZW50KHRoaXMud2luZG93Q29udGVudCk7XG4gICAgaW5mb3dpbmRvdy5vcGVuKG1hcCwgdGhpcy5tYXJrZXIpO1xufVxuXG5TcG90LnByb3RvdHlwZS5oaWRlTWFya2VyID0gZnVuY3Rpb24gKCkgeyB0aGlzLm1hcmtlci5zZXRNYXAobnVsbCk7IH07XG5TcG90LnByb3RvdHlwZS5zaG93TWFya2VyID0gZnVuY3Rpb24gKCkgeyB0aGlzLm1hcmtlci5zZXRNYXAobWFwKTsgfTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL0tPIFZJRVdNT0RFTC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIFZpZXdNb2RlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAvLyBEYXRhXG4gICAgc2VsZi5saXN0T24gPSBrby5vYnNlcnZhYmxlKHRydWUpO1xuICAgIHNlbGYuYnVyZ2VyTWVudSA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc3BvdExpc3QgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTtcbiAgICBzZWxmLnNsaWRlT24gPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNsaWRlQ29udGVudCA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLmZpbHRlclNsb3QgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgc2VsZi5pc1NlbGVjdGVkID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG5cbiAgICAvLyBCZWhhdmlvdXJzXG4gICAgc2VsZi5zcG90UGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3QuZG9PcGVuaW5nKCk7XG4gICAgfTtcbiAgICBzZWxmLnNldEZpbHRlclNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaXNTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICB9O1xuICAgIHNlbGYuZmlsdGVyU2xvdC5zdWJzY3JpYmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICAgICAgc2VsZi5zcG90TGlzdChmaWx0ZXJMaXN0KGRhdGEsIGVhdGluZ1Nwb3RzKSk7XG4gICAgICAgIHJlc2V0TWFya2VycyhzZWxmLnNwb3RMaXN0KCkpO1xuICAgIH0pO1xuICAgIHNlbGYub25FbnRlciA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93LmFuY2hvcikge1xuICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc3BvdExpc3QoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zcG90TGlzdCgpWzBdLmRvT3BlbmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93KSBpbmZvd2luZG93LmNsb3NlKCk7IC8vZm9yIGFueSBvdGhlciBrZXlwcmVzc1xuICAgICAgICAgICAgc2VsZi5zbGlkZU9mZigpO1xuICAgICAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIG5lY2Vzc2FyeSB0byByZWZsZWN0IHRoZSB0ZXh0IGluIHRoZSBzbG90XG4gICAgfTtcbiAgICBzZWxmLmxpc3RDb2xsYXBzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5saXN0T24oZmFsc2UpO1xuICAgICAgICBzZWxmLmJ1cmdlck1lbnUodHJ1ZSk7XG4gICAgfTtcbiAgICBzZWxmLmxpc3RFeHBhbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICAgICAgc2VsZi5idXJnZXJNZW51KGZhbHNlKTtcbiAgICAgICAgc2VsZi5saXN0T24odHJ1ZSk7XG4gICAgfTtcbiAgICBzZWxmLm9wZW5BUElzbGlkZSA9IGZ1bmN0aW9uIChzcG90TmFtZSkge1xuICAgICAgICB2YXIgc3BvdCA9IGdldFNwb3Qoc3BvdE5hbWUpO1xuICAgICAgICBpZiAoIShzcG90LnNsaWRlQ29udGVudCkpIHtcbiAgICAgICAgICAgIGR1YlNsaWRlQ29udGVudHMoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmlld01vZGVsLnNsaWRlQ29udGVudChzcG90LnNsaWRlQ29udGVudCk7XG4gICAgICAgIHZpZXdNb2RlbC5zbGlkZU9uKHRydWUpO1xuICAgIH07XG4gICAgc2VsZi5zbGlkZU9mZiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zbGlkZU9uKGZhbHNlKTtcbiAgICB9O1xufTtcblxudmFyIHZpZXdNb2RlbCA9IG5ldyBWaWV3TW9kZWwoKTtcbmtvLmFwcGx5QmluZGluZ3Modmlld01vZGVsKTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1IRUxQRVIgRlVOQ1RJT05TLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy90ZXN0IGFycmF5IGFnYWluc3QgYSByZWd1bGFyIGV4cHJlc3Npb25cbmZ1bmN0aW9uIGZpbHRlckxpc3QodXNlclRleHQsIG1vZGVsQXJyYXkpIHtcbiAgICAgdmFyIHJlc3VsdD1bXSxcbiAgICAgICAgIHJlID0gbmV3IFJlZ0V4cCh1c2VyVGV4dCwgWydpJ10pO1xuICAgICBtb2RlbEFycmF5LmZvckVhY2goIGZ1bmN0aW9uKGVsZW1lbnQsIGluZGV4LCBhcnJheSkge1xuICAgICAgICBpZiAocmUudGVzdChlbGVtZW50Lm5hbWUpKSByZXN1bHQucHVzaChlbGVtZW50KTtcbiAgICAgfSk7XG4gICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRTcG90KG5hbWUpIHtcbiAgICB2YXIgcmVzdWx0O1xuICAgIGVhdGluZ1Nwb3RzLmZvckVhY2goIGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICBpZiAoc3BvdC5uYW1lID09IG5hbWUpIHJlc3VsdCA9IHNwb3Q7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIHJlc2V0TWFya2VycyhzcG90cykge1xuICAgIGVhdGluZ1Nwb3RzLmZvckVhY2goIGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICAgc3BvdC5oaWRlTWFya2VyKCk7XG4gICAgfSk7XG4gICAgZm9yICh2YXIgaSBpbiBzcG90cykge1xuICAgICAgICBnZXRTcG90KHNwb3RzW2ldLm5hbWUpLnNob3dNYXJrZXIoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBpdGNod2luZG93KCkge1xuICAgIHZpZXdNb2RlbC5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xufVxuZnVuY3Rpb24gY2xlYW5VcFNjcmVlbigpIHtcbiAgICBpbmZvd2luZG93LmNsb3NlKCk7XG4gICAgbWFwLnNldFpvb20obW9kZWwuem9vbUxldmVsKTtcbiAgICBtYXAuc2V0Q2VudGVyKG1vZGVsLmNlbnRlcik7XG4gICAgdmlld01vZGVsLnNsaWRlT2ZmKCk7XG59XG5mdW5jdGlvbiBkdWJTbGlkZUNvbnRlbnRzKCkge1xuICAgIGlmIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQpIHtcbiAgICAgICAgZm9yICh2YXIgaSBpbiBtb2RlbC5zcG90cykge1xuICAgICAgICAgICAgZWF0aW5nU3BvdHNbaV0uc2xpZGVDb250ZW50ID0gbW9kZWwuc3BvdHNbaV0uc2xpZGVDb250ZW50O1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLm1vZGVsID0gSlNPTi5zdHJpbmdpZnkobW9kZWwpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PVRIRSBFTkQ9PT09PT09PT09PT09PT09PT09XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8vZnJvbSBodHRwczovL2RldmVsb3Blci5mb3Vyc3F1YXJlLmNvbS9vdmVydmlldy9hdXRoI3VzZXJsZXNzXG4vL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2g/bGw9NDAuNywtNzQmY2xpZW50X2lkPUNMSUVOVF9JRCZjbGllbnRfc2VjcmV0PUNMSUVOVF9TRUNSRVQmdj1ZWVlZTU1ERFxuXG4vL2ZvdXJzcXVhcmUuY29tL3YvYnJvYWR3YXktc3RhdGlvbi1zdXNoaS80YWFlOWNiN2Y5NjRhNTIwOWI2MjIwZTNcbnZhciBrciA9IHtcbiAgICBmb3Vyc3F1YXJlOiB7XG4gICAgICAgIE93bmVyOiBcIktSIERlY2tlclwiLFxuICAgICAgICBDbGllbnRfaWQ6IFwiWlZMS1RLU0dVTEZFUTNYTVdXSTNBTDFBMktYWUJFS0QxTEtTVVJVWkRHWlk0MUpYXCIsXG4gICAgICAgIENsaWVudF9zZWNyZXQ6IFwiVE1UMjAzREhXT1BSM1I0UlNNMUhFNFJNT0tFV0xHVFQwRkxNWk1VWjFPSkhNQUsxXCJcbiAgICB9LFxuICAgIHllbHA6IHtcbiAgICAgICAgQ29uc3VtZXJfS2V5OiAgICBcIlhyeEpPVWdHTktxOVp1V2hCWDFMRHdcIixcbiAgICAgICAgQ29uc3VtZXJfU2VjcmV0OiBcInpyMkk3Nm5UOGwwTy10cmt1cFlFMDBCOUJUQVwiLFxuICAgICAgICBUb2tlbjogICBcIi1fRjhhT3hvblI2cTVTcXZVUnd3Z0xJZFUtcXRlUy1CXCIsXG4gICAgICAgIFRva2VuX1NlY3JldDogICAgXCJHRjd1UmNQV0NwemxIY1JQM0RpSldqdmNYSkVcIlxuICAgIH1cbn07XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
