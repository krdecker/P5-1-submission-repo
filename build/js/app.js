"use strict";function getModel(){return localStorage.model?JSON.parse(localStorage.model):EatsModel}function buildWindowContent(e){var t="http://maps.googleapis.com/maps/api/streetview?size=300x250&location="+e.position.toString().slice(1,-1),o='<img class="bgimg" src="'+t+'">',n='"height:100%;width:80%"',i='<div onclick="itchwindow()" style='+n+">"+o+'<br><span style="color:darkgreen">'+e.title+'</span><br><span style="color:red">-CLICK FOR MORE INFO-</span></div>';return i}function buildSlideContent(e){function t(t,i){console.log("In getVenueInfo: status = "+i);var a=t.response.venues[0];$.ajax({url:fourSquareURL+"/v2/venues/"+a.id,dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:o,error:n})}function o(t){var o=t.response.venue;i="FourSquare info: <br><br>"+o.name+"<br>"+o.contact.formattedPhone+"<br>- "+o.location.address+"<br>- "+o.location.city+"<br>- "+o.location.country+"<br>x-street: "+o.location.crossStreet+"<br>Check-ins: "+o.stats.checkinsCount.toString()+"<br>"+o.likes.summary+'<br><br><span style="background-color:#'+o.ratingColor+';color:black;padding:1%">Rating: '+o.rating.toString()+'</span><br><img src="'+o.bestPhoto.prefix+"cap300"+o.bestPhoto.suffix+'">',updateSlideContent(e,i)}function n(t,o,n){var i="Sorry. 3rd party info unavailable.";updateSlideContent(e,i)}var i="",s="ll="+e.location.lat.toString()+","+e.location.lng.toString();$.ajax({url:fourSquareURL+"/v2/venues/search",dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:t,error:n})}function updateSlideContent(e,t){e.slideContent=t;var o=getSpot(e.name);o&&(console.log("in updateSlideContent: viewSpot "),o.slideContent=t)}function init(){map=new google.maps.Map(document.getElementById("map-div"),mapOptions),model=getModel(),(void 0===model.spots[0].slideContent||"Sorry"==model.spots[0].slideContent.slice(0,5))&&model.spots.forEach(function(e){buildSlideContent(e)}),viewModel.spotList(model.spots),infowindow=new google.maps.InfoWindow({}),map.setZoom(model.zoomLevel),map.setCenter(model.center),model.spots.forEach(function(e){vmSpots.push(new Spot(e))}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(model.center)}),window.setTimeout(function(){localStorage.model=JSON.stringify(model)},3e3)}function filterList(e,t){var o=[],n=new RegExp(e,["i"]);return t.forEach(function(e,t,i){n.test(e.name)&&o.push(e)}),o}function getSpot(e){for(var t=0;t<vmSpots.length;t++)if(vmSpots[t].name==e)return vmSpots[t]}function resetMarkers(e){vmSpots.forEach(function(e){e.hideMarker()}),e.forEach(function(e){getSpot(e.name).showMarker()})}function itchwindow(){viewModel.openAPIslide(infowindow.anchor.title)}function cleanUpScreen(){infowindow.close(),map.setZoom(model.zoomLevel),map.setCenter(model.center),viewModel.slideOff(),$("ul.spot-list li").removeClass("hilight under")}function dubSlideContents(){model.spots[0].slideContent&&model.spots.forEach(function(e,t){vmSpots[t].slideContent=e.slideContent,localStorage.model=JSON.stringify(model)})}var EatsModel={zoomLevel:18,center:{lat:49.262387,lng:-123.069956},spots:[{name:"Uncle Fatih's Pizza",location:{lat:49.262437,lng:-123.070215},category:"pizza"},{name:"Buddha's Orient Express",location:{lat:49.262719,lng:-123.069289},category:"asian"},{name:"Booster Juice",location:{lat:49.262641,lng:-123.069438},category:"juice"},{name:"Starbucks Coffee",location:{lat:49.261874,lng:-123.070076},category:"coffee"},{name:"Blenz Coffee",location:{lat:49.262534,lng:-123.069529},category:"coffee"},{name:"Megabite Pizza",location:{lat:49.262779,lng:-123.069317},category:"pizza"},{name:"Broadway Station Sushi",location:{lat:49.262084,lng:-123.070962},category:"asian"}]},model={},fourSquareURL="https://api.foursquare.com",map,vmSpots=[],infowindow,RedRoadsNGreenBusStops=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{gamma:.65},{hue:"#ff9c30"},{visibility:"on"},{saturation:99},{lightness:-12}]},{featureType:"transit",stylers:[{hue:"#00ff33"},{gamma:.6},{saturation:5},{visibility:"on"},{weight:4.6},{lightness:-12}]}],mapOptions={center:{lat:49.262387,lng:-123.069868},zoom:16,zoomControl:!0,scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,disableDefaultUI:!0,styles:RedRoadsNGreenBusStops},icons={asian:{icon:"img/asian.png"},coffee:{icon:"img/coffee.png"},food:{icon:"img/food.png"},juice:{icon:"img/juice.png"},pizza:{icon:"img/pizza.png"}},Spot=function(e){var t=this;this.name=e.name,this.location=e.location,this.category=e.category,this.slideContent=e.slideContent,this.marker=new google.maps.Marker({position:this.location,title:this.name,icon:icons[this.category].icon,map:map,opacity:.4}),this.windowContent=buildWindowContent(this.marker),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(){t.doOpening()}),this.overEvent=google.maps.event.addListener(this.marker,"mouseover",function(){t.hiLightListItem()}),this.outEvent=google.maps.event.addListener(this.marker,"mouseout",function(){t.loLightListItem()})};Spot.prototype.hiLightListItem=function(){var e=this;cleanUpScreen(),$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.loLightListItem=function(){var e=this;$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.doBounce=function(){cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE)},Spot.prototype.stopBounce=function(){this.marker.setAnimation(null)},Spot.prototype.doOpening=function(){var e=this;cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.openWindow(),e.marker.setAnimation(null)},1e3)},Spot.prototype.openWindow=function(){var e=this;viewModel.listCollapse(),infowindow.setContent(this.windowContent),infowindow.open(map,this.marker),this.closeEvent=google.maps.event.addListener(infowindow,"closeclick",function(){cleanUpScreen(),viewModel.listExpand(),google.maps.event.removeListener(e.closeEvent)})},Spot.prototype.hideMarker=function(){this.marker.setMap(null)},Spot.prototype.showMarker=function(){this.marker.setMap(map)};var ViewModel=function(){var e=this;e.listOn=ko.observable(!0),e.burgerMenu=ko.observable(!1),e.spotList=ko.observableArray(),e.slideOn=ko.observable(!1),e.slideContent=ko.observable(),e.filterSlot=ko.observable(),e.isSelected=ko.observable(!1),e.bounceMarker=function(){var e=getSpot(this.name);e.doBounce()},e.unbounceMarker=function(){var e=getSpot(this.name);e.stopBounce()},e.spotPick=function(){var e=getSpot(this.name);e.doOpening()},e.setFilterSelected=function(){this.isSelected(!0),cleanUpScreen(),e.listExpand()},e.filterSlot.subscribe(function(t){e.listExpand(),e.spotList(filterList(t,vmSpots)),resetMarkers(e.spotList())}),e.onEnter=function(t,o){return 13===o.keyCode?infowindow.anchor?e.openAPIslide(infowindow.anchor.title):1===e.spotList().length&&e.spotList()[0].doOpening():(infowindow&&infowindow.close(),e.slideOff(),e.listExpand()),!0},e.listCollapse=function(){var t=window.matchMedia("(max-width: 549px)");t.matches&&(e.listOn(!1),e.burgerMenu(!0))},e.listExpand=function(){cleanUpScreen(),e.burgerMenu(!1),e.listOn(!0)},e.openAPIslide=function(e){var t=getSpot(e);t.slideContent||dubSlideContents(),viewModel.slideContent(t.slideContent),viewModel.slideOn(!0)},e.slideOff=function(){this.slideOn(!1)}},viewModel=new ViewModel;ko.applyBindings(viewModel);var kr={foursquare:{Owner:"KR Decker",Client_id:"ZVLKTKSGULFEQ3XMWWI3AL1A2KXYBEKD1LKSURUZDGZY41JX",Client_secret:"TMT203DHWOPR3R4RSM1HE4RMOKEWLGTT0FLMZMUZ1OJHMAK1"},yelp:{Consumer_Key:"XrxJOUgGNKq9ZuWhBX1LDw",Consumer_Secret:"zr2I76nT8l0O-trkupYE00B9BTA",Token:"-_F8aOxonR6q5SqvURwwgLIdU-qteS-B",Token_Secret:"GF7uRcPWCpzlHcRP3DiJWjvcXJE"},streetview:{key:"AIzaSyAP631z6WqMoptoaGherhJVBGyN1uPHPt4"}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnZXRNb2RlbCIsImxvY2FsU3RvcmFnZSIsIm1vZGVsIiwiSlNPTiIsInBhcnNlIiwiRWF0c01vZGVsIiwiYnVpbGRXaW5kb3dDb250ZW50IiwibWFya2VyIiwic3RyZWV0dmlld1VybCIsInBvc2l0aW9uIiwidG9TdHJpbmciLCJzbGljZSIsInBpY3R1cmUiLCJjc3MiLCJjb250ZW50IiwidGl0bGUiLCJidWlsZFNsaWRlQ29udGVudCIsInNwb3QiLCJnZXRWZW51ZUluZm8iLCJkYXRhIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInZlbnVlIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCIkIiwiYWpheCIsInVybCIsImZvdXJTcXVhcmVVUkwiLCJpZCIsImRhdGFUeXBlIiwibG9jIiwibmFtZSIsImtyIiwiZm91cnNxdWFyZSIsIkNsaWVudF9pZCIsIkNsaWVudF9zZWNyZXQiLCJhc3luYyIsInN1Y2Nlc3MiLCJmb3JtYXRTaG93RGF0YSIsImVycm9yIiwic2VuZEVycm9yIiwiZm9ybWF0dGVkRGF0YSIsImNvbnRhY3QiLCJmb3JtYXR0ZWRQaG9uZSIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiY3Jvc3NTdHJlZXQiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJsaWtlcyIsInN1bW1hcnkiLCJyYXRpbmdDb2xvciIsInJhdGluZyIsImJlc3RQaG90byIsInByZWZpeCIsInN1ZmZpeCIsInVwZGF0ZVNsaWRlQ29udGVudCIsIm9iamVjdCIsImV4Y2VwdGlvbiIsImFqYXhfZXJyb3IiLCJsYXQiLCJsbmciLCJkYXRhU3RyaW5nIiwic2xpZGVDb250ZW50Iiwidm1TcG90IiwiZ2V0U3BvdCIsImluaXQiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1hcE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzcG90cyIsImZvckVhY2giLCJ2aWV3TW9kZWwiLCJzcG90TGlzdCIsImluZm93aW5kb3ciLCJJbmZvV2luZG93Iiwic2V0Wm9vbSIsInpvb21MZXZlbCIsInNldENlbnRlciIsImNlbnRlciIsInZtU3BvdHMiLCJwdXNoIiwiU3BvdCIsImV2ZW50IiwiYWRkRG9tTGlzdGVuZXIiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0Iiwic3RyaW5naWZ5IiwiZmlsdGVyTGlzdCIsInVzZXJUZXh0IiwibW9kZWxBcnJheSIsInJlc3VsdCIsInJlIiwiUmVnRXhwIiwiZWxlbWVudCIsImluZGV4IiwiYXJyYXkiLCJ0ZXN0IiwiaSIsImxlbmd0aCIsInJlc2V0TWFya2VycyIsImhpZGVNYXJrZXIiLCJpdGVtIiwic2hvd01hcmtlciIsIml0Y2h3aW5kb3ciLCJvcGVuQVBJc2xpZGUiLCJhbmNob3IiLCJjbGVhblVwU2NyZWVuIiwiY2xvc2UiLCJzbGlkZU9mZiIsInJlbW92ZUNsYXNzIiwiZHViU2xpZGVDb250ZW50cyIsImNhdGVnb3J5IiwiUmVkUm9hZHNOR3JlZW5CdXNTdG9wcyIsImZlYXR1cmVUeXBlIiwiZWxlbWVudFR5cGUiLCJzdHlsZXJzIiwidmlzaWJpbGl0eSIsImdhbW1hIiwiaHVlIiwic2F0dXJhdGlvbiIsImxpZ2h0bmVzcyIsIndlaWdodCIsInpvb20iLCJ6b29tQ29udHJvbCIsInNjcm9sbHdoZWVsIiwiZHJhZ2dhYmxlIiwiZGlzYWJsZURvdWJsZUNsaWNrWm9vbSIsImRpc2FibGVEZWZhdWx0VUkiLCJzdHlsZXMiLCJpY29ucyIsImFzaWFuIiwiaWNvbiIsImNvZmZlZSIsImZvb2QiLCJqdWljZSIsInBpenphIiwidGhhdCIsInRoaXMiLCJNYXJrZXIiLCJvcGFjaXR5Iiwid2luZG93Q29udGVudCIsImNsaWNrRXZlbnQiLCJhZGRMaXN0ZW5lciIsImRvT3BlbmluZyIsIm92ZXJFdmVudCIsImhpTGlnaHRMaXN0SXRlbSIsIm91dEV2ZW50IiwibG9MaWdodExpc3RJdGVtIiwicHJvdG90eXBlIiwidG9nZ2xlQ2xhc3MiLCJkb0JvdW5jZSIsInNldEFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkJPVU5DRSIsInN0b3BCb3VuY2UiLCJvcGVuV2luZG93IiwibGlzdENvbGxhcHNlIiwic2V0Q29udGVudCIsIm9wZW4iLCJjbG9zZUV2ZW50IiwibGlzdEV4cGFuZCIsInJlbW92ZUxpc3RlbmVyIiwic2V0TWFwIiwiVmlld01vZGVsIiwic2VsZiIsImxpc3RPbiIsImtvIiwib2JzZXJ2YWJsZSIsImJ1cmdlck1lbnUiLCJvYnNlcnZhYmxlQXJyYXkiLCJzbGlkZU9uIiwiZmlsdGVyU2xvdCIsImlzU2VsZWN0ZWQiLCJib3VuY2VNYXJrZXIiLCJ1bmJvdW5jZU1hcmtlciIsInNwb3RQaWNrIiwic2V0RmlsdGVyU2VsZWN0ZWQiLCJzdWJzY3JpYmUiLCJvbkVudGVyIiwia2V5Q29kZSIsIm1lZGlhcXVlcnkiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsInNwb3ROYW1lIiwiYXBwbHlCaW5kaW5ncyIsIk93bmVyIiwieWVscCIsIkNvbnN1bWVyX0tleSIsIkNvbnN1bWVyX1NlY3JldCIsIlRva2VuIiwiVG9rZW5fU2VjcmV0Iiwic3RyZWV0dmlldyIsImtleSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFxREEsU0FBU0EsWUFDTCxNQUFJQyxjQUFhQyxNQUNOQyxLQUFLQyxNQUFNSCxhQUFhQyxPQUV4QkcsVUFLZixRQUFTQyxvQkFBbUJDLEdBQ3hCLEdBQUlDLEdBQWdCLHdFQUNJRCxFQUFPRSxTQUFTQyxXQUFXQyxNQUFNLEVBQUUsSUFJdkRDLEVBQVUsMkJBQTZCSixFQUFnQixLQUN2REssRUFBTSwwQkFDTkMsRUFBVSxxQ0FDRUQsRUFBTSxJQUFNRCxFQUFVLHFDQUN0QkwsRUFBT1EsTUFBUSx1RUFHL0IsT0FBT0QsR0FVWCxRQUFTRSxtQkFBa0JDLEdBcUJ2QixRQUFTQyxHQUFhQyxFQUFNQyxHQUN4QkMsUUFBUUMsSUFBSSw2QkFBK0JGLEVBQzNDLElBQUlHLEdBQVFKLEVBQUtLLFNBQVNDLE9BQU8sRUFFakNDLEdBQUVDLE1BQ0VDLElBQUtDLGNBQWdCLGNB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RyxPQUFPaUcsV0FBWSxxQkFDaENELEdBQVdFLFVBQ1hsQixFQUFLQyxRQUFPLEdBQ1pELEVBQUtJLFlBQVcsS0FJeEJKLEVBQUtKLFdBQWEsV0FDZHRELGdCQUNBMEQsRUFBS0ksWUFBVyxHQUNoQkosRUFBS0MsUUFBTyxJQUdoQkQsRUFBSzVELGFBQWUsU0FBVStFLEdBQzFCLEdBQUloTCxHQUFPb0QsUUFBUTRILEVBQ2JoTCxHQUFpQixjQUNuQnVHLG1CQUVKdkMsVUFBVWQsYUFBYWxELEVBQUtrRCxjQUM1QmMsVUFBVW1HLFNBQVEsSUFHdEJOLEVBQUt4RCxTQUFXLFdBQ1o2QixLQUFLaUMsU0FBUSxLQUlqQm5HLFVBQVksR0FBSTRGLFVBQ3BCRyxJQUFHa0IsY0FBY2pILFVBa0pqQixJQUFJL0MsS0FDQUMsWUFDSWdLLE1BQU8sWUFDUC9KLFVBQVcsbURBQ1hDLGNBQWUsb0RBRW5CK0osTUFDSUMsYUFBaUIseUJBQ2pCQyxnQkFBaUIsOEJBQ2pCQyxNQUFTLG1DQUNUQyxhQUFpQiwrQkFFckJDLFlBQ0lDLElBQUsiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbi8vIGVhdHMgZGF0YTogYW4gYXJyYXkgb2YgcGxhY2VzIHRvIGVhdFxuLy8gYXJvdW5kIENvbW1lcmNpYWwtQnJvYWR3YXkgU3RhdGlvblxuLy8gRWFzdCBWYW5cbi8vIEJyaXRpc2ggQ29sdW1iaWFcblxuLy8gYmFzaWMgZGF0YSwgbG9hZGVkIGlmIG1vcmUgZGV0YWlsZWQgbW9kZWwgbm90IGZvdW5kIGluIGxvY2FsU3RvcmFnZVxudmFyIEVhdHNNb2RlbCA9IHtcbiAgICB6b29tTGV2ZWw6IDE4LFxuICAgIGNlbnRlcjoge2xhdDogNDkuMjYyMzg3LCBsbmc6IC0xMjMuMDY5OTU2fSwvLzQ5LjI2MjM4NywgLTEyMy4wNjk3NjhcbiAgICBzcG90czogW1xuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIlVuY2xlIEZhdGloJ3MgUGl6emFcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI0MzcsIGxuZzogLTEyMy4wNzAyMTV9LFxuICAgICAgICAgICAgY2F0ZWdvcnk6IFwicGl6emFcIlxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJ1ZGRoYSdzIE9yaWVudCBFeHByZXNzXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNzE5LCBsbmc6IC0xMjMuMDY5Mjg5fSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcImFzaWFuXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCb29zdGVyIEp1aWNlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNjQxLCBsbmc6IC0xMjMuMDY5NDM4fSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcImp1aWNlXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJTdGFyYnVja3MgQ29mZmVlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYxODc0LCBsbmc6IC0xMjMuMDcwMDc2fSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcImNvZmZlZVwiXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQmxlbnogQ29mZmVlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNTM0LCBsbmc6IC0xMjMuMDY5NTI5fSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcImNvZmZlZVwiXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiTWVnYWJpdGUgUGl6emFcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI3NzksIGxuZzogLTEyMy4wNjkzMTd9LFxuICAgICAgICAgICAgY2F0ZWdvcnk6IFwicGl6emFcIlxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJyb2Fkd2F5IFN0YXRpb24gU3VzaGlcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjIwODQsIGxuZzogLTEyMy4wNzA5NjJ9LFxuICAgICAgICAgICAgY2F0ZWdvcnk6IFwiYXNpYW5cIlxuICAgICAgICB9XG4gICAgXVxufTtcblxudmFyIG1vZGVsID0ge307XG5cbmZ1bmN0aW9uIGdldE1vZGVsKCkge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UubW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLm1vZGVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gRWF0c01vZGVsO1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBidWlsZFdpbmRvd0NvbnRlbnQobWFya2VyKSB7XG4gICAgdmFyIHN0cmVldHZpZXdVcmwgPSAnaHR0cDovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvc3RyZWV0dmlldz9zaXplPTMwMHgyNTAmbG9jYXRpb249JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLnBvc2l0aW9uLnRvU3RyaW5nKCkuc2xpY2UoMSwtMSkgOy8vICsgJyZrZXk9JyArIGtyLnN0cmVldHZpZXcua2V5O1xuICAgIC8vIG1hcmtlci5wb3NpdGlvbi50b1N0cmluZygpIG1ldGhvZCBjaGFuZ2VkIHRvIGluY2x1ZGUgcGFyZW50aGVzZXMsIGhlbmNlIHRoZSBzbGljZVxuICAgIC8vIGtleSBub3QgcmVxdWlyZWRcblxuICAgIHZhciBwaWN0dXJlID0gJzxpbWcgY2xhc3M9XCJiZ2ltZ1wiIHNyYz1cIicgKyBzdHJlZXR2aWV3VXJsICsgJ1wiPic7XG4gICAgdmFyIGNzcyA9ICdcImhlaWdodDoxMDAlO3dpZHRoOjgwJVwiJztcbiAgICB2YXIgY29udGVudCA9ICc8ZGl2IG9uY2xpY2s9XCJpdGNod2luZG93KClcIiBzdHlsZT0nICtcbiAgICAgICAgICAgICAgICAgICAgY3NzICsgJz4nICsgcGljdHVyZSArICc8YnI+PHNwYW4gc3R5bGU9XCJjb2xvcjpkYXJrZ3JlZW5cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLnRpdGxlICsgJzwvc3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxicj48c3BhbiBzdHlsZT1cImNvbG9yOnJlZFwiPi1DTElDSyBGT1IgTU9SRSBJTkZPLTwvc3Bhbj48L2Rpdj4nO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gM3JkIHBhcnR5IEFQSSBzdHVmZlxudmFyIGZvdXJTcXVhcmVVUkwgPSAnaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20nO1xuXG4vLyBnZXQgY29udGVudCBmb3IgaW5mbyBzbGlkZXMgZnJvbSAzcmQgcGFydHkgc291cmNlc1xuLy8gYmFzZWQgb24gaW5mbyBmcm9tIG1vZGVsXG4vLyB0aGVuIGFkZCB0byBtb2RlbCBhbmQgdG8gdmlldyBvYmplY3RzXG5mdW5jdGlvbiBidWlsZFNsaWRlQ29udGVudChzcG90KSB7XG4gICAgdmFyIGZvcm1hdHRlZERhdGEgPSBcIlwiO1xuICAgIHZhciBsb2MgPSBcImxsPVwiICsgc3BvdC5sb2NhdGlvbi5sYXQudG9TdHJpbmcoKSArIFwiLFwiICsgc3BvdC5sb2NhdGlvbi5sbmcudG9TdHJpbmcoKTtcbiAgICB2YXIgYWpheF9lcnJvcjtcblxuICAgIC8vIGdldCB0aGUgZm91cnNxdWFyZSBJRCBudW1iZXIgb2YgdGhlIHNwb3RcbiAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBmb3VyU3F1YXJlVVJMICsgJy92Mi92ZW51ZXMvc2VhcmNoJyxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBkYXRhOiAnbGltaXQ9MScgK1xuICAgICAgICAgICAgICAgICAgICAnJicgKyBsb2MgKyAnJnF1ZXJ5PScgKyBzcG90Lm5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9pZD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9pZCArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X3NlY3JldD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9zZWNyZXQgK1xuICAgICAgICAgICAgICAgICAgICAnJnY9MjAxNjAxMzAnLFxuICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBnZXRWZW51ZUluZm8sXG4gICAgICAgICAgICBlcnJvcjogc2VuZEVycm9yXG4gICAgfSk7XG5cbiAgICAvLyBnaXZlIHRoZSByZXNwb25zZSBvbiBzcGVjaWZpYyB2ZW51ZSB0byBhbm90aGVyIGNhbGwgZm9yXG4gICAgLy8gbW9yZSBkZXRhaWxlZCBpbmZvcm1hdGlvblxuICAgIGZ1bmN0aW9uIGdldFZlbnVlSW5mbyhkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJJbiBnZXRWZW51ZUluZm86IHN0YXR1cyA9IFwiICsgc3RhdHVzKTtcbiAgICAgICAgdmFyIHZlbnVlID0gZGF0YS5yZXNwb25zZS52ZW51ZXNbMF07XG4gICAgICAgIC8vaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL1ZFTlVFX0lEXG4gICAgICAgICQuYWpheCh7IC8vIHRvIGdldCB0aGUgZGV0YWlsZWQgZm91cnNxdWFyZSBvZiB0aGUgJ2NvbXBsZXRlIHZlbnVlJyBiYXNlZCBvbiBJRFxuICAgICAgICAgICAgdXJsOiBmb3VyU3F1YXJlVVJMICsgJy92Mi92ZW51ZXMvJyArIHZlbnVlLmlkLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgIGRhdGE6ICdsaW1pdD0xJyArXG4gICAgICAgICAgICAgICAgICAgICcmJyArIGxvYyArXG4gICAgICAgICAgICAgICAgICAgICcmcXVlcnk9JyArIHNwb3QubmFtZSArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X2lkPScrIGtyLmZvdXJzcXVhcmUuQ2xpZW50X2lkICtcbiAgICAgICAgICAgICAgICAgICAgJyZjbGllbnRfc2VjcmV0PScrIGtyLmZvdXJzcXVhcmUuQ2xpZW50X3NlY3JldCArXG4gICAgICAgICAgICAgICAgICAgICcmdj0yMDE2MDEzMCcsXG4gICAgICAgICAgICBhc3luYzogdHJ1ZSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZvcm1hdFNob3dEYXRhLFxuICAgICAgICAgICAgZXJyb3I6IHNlbmRFcnJvclxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmb3JtYXRTaG93RGF0YShkYXRhKXtcbiAgICAgICAgdmFyIHZlbnVlID0gZGF0YS5yZXNwb25zZS52ZW51ZTtcbiAgICAgICAgZm9ybWF0dGVkRGF0YSA9ICdGb3VyU3F1YXJlIGluZm86ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxicj4nICsgJzxicj4nICsgdmVudWUubmFtZSArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZW51ZS5jb250YWN0LmZvcm1hdHRlZFBob25lICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICctICcgKyB2ZW51ZS5sb2NhdGlvbi5hZGRyZXNzICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICctICcgKyB2ZW51ZS5sb2NhdGlvbi5jaXR5ICArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uY291bnRyeSAgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ3gtc3RyZWV0OiAnICsgdmVudWUubG9jYXRpb24uY3Jvc3NTdHJlZXQgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NoZWNrLWluczogJyArIHZlbnVlLnN0YXRzLmNoZWNraW5zQ291bnQudG9TdHJpbmcoKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGJyPicgKyB2ZW51ZS5saWtlcy5zdW1tYXJ5ICsgJzxicj4nICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6IycgKyB2ZW51ZS5yYXRpbmdDb2xvciArXG4gICAgICAgICAgICAgICAgICAgICAgICAnO2NvbG9yOmJsYWNrO3BhZGRpbmc6MSVcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdSYXRpbmc6ICcgKyB2ZW51ZS5yYXRpbmcudG9TdHJpbmcoKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPicgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPVwiJyArIHZlbnVlLmJlc3RQaG90by5wcmVmaXggK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NhcDMwMCcgKyB2ZW51ZS5iZXN0UGhvdG8uc3VmZml4ICsgJ1wiPidcbiAgICAgICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgLy9zcG90LnNsaWRlQ29udGVudCA9IGZvcm1hdHRlZERhdGE7XG4gICAgICAgIHVwZGF0ZVNsaWRlQ29udGVudChzcG90LCBmb3JtYXR0ZWREYXRhKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2VuZEVycm9yKG9iamVjdCwgZXJyb3IsIGV4Y2VwdGlvbikge1xuICAgICAgICAvLyBpZiBhcGkgbm90IHdvcmtpbmcgKGFuZCBsb2NhbCBzdG9yYWdlIGlzIGNsZWFyZWQpXG4gICAgICAgIC8vIHRoZW4gY29udGVudCBvZiBlYWNoIHNsaWRlIGlzIHNldCB0byBlcnJvciBtc2dcbiAgICAgICAgdmFyIGFqYXhfZXJyb3IgPSBcIlNvcnJ5LiAzcmQgcGFydHkgaW5mbyB1bmF2YWlsYWJsZS5cIjtcbiAgICAgICAgdXBkYXRlU2xpZGVDb250ZW50KHNwb3QsIGFqYXhfZXJyb3IpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlU2xpZGVDb250ZW50KHNwb3QsIGRhdGFTdHJpbmcpIHtcbiAgICAvLyB1cGRhdGUgdGhlIG1vZGVsXG4gICAgc3BvdC5zbGlkZUNvbnRlbnQgPSBkYXRhU3RyaW5nO1xuICAgIC8vIHVwZGF0ZSB0aGUgdmlld1xuICAgIHZhciB2bVNwb3QgPSBnZXRTcG90KHNwb3QubmFtZSk7XG4gICAgaWYgKHZtU3BvdCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImluIHVwZGF0ZVNsaWRlQ29udGVudDogdmlld1Nwb3QgXCIpO1xuICAgICAgICB2bVNwb3Quc2xpZGVDb250ZW50ID0gZGF0YVN0cmluZztcbiAgICB9XG59XG5cbi8vIE1hcmtOJ3MgaW1wbGVtZW50YXRpb24gb2Zcbi8qKlxuICogR2VuZXJhdGVzIGEgcmFuZG9tIG51bWJlciBhbmQgcmV0dXJucyBpdCBhcyBhIHN0cmluZyBmb3IgT0F1dGhlbnRpY2F0aW9uXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbi8vIGZ1bmN0aW9uIG5vbmNlX2dlbmVyYXRlKCkge1xuLy8gICByZXR1cm4gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDFlMTIpLnRvU3RyaW5nKCkpO1xuLy8gfVxuXG4vLyB2YXIgeWVscF91cmwgPSBZRUxQX0JBU0VfVVJMICsgJ2J1c2luZXNzLycgKyBzZWxmLnNlbGVjdGVkX3BsYWNlKCkuWWVscC5idXNpbmVzc19pZDtcblxuLy8gICAgIHZhciBwYXJhbWV0ZXJzID0ge1xuLy8gICAgICAgb2F1dGhfY29uc3VtZXJfa2V5OiBZRUxQX0tFWSxcbi8vICAgICAgIG9hdXRoX3Rva2VuOiBZRUxQX1RPS0VOLFxuLy8gICAgICAgb2F1dGhfbm9uY2U6IG5vbmNlX2dlbmVyYXRlKCksXG4vLyAgICAgICBvYXV0aF90aW1lc3RhbXA6IE1hdGguZmxvb3IoRGF0ZS5ub3coKS8xMDAwKSxcbi8vICAgICAgIG9hdXRoX3NpZ25hdHVyZV9tZXRob2Q6ICdITUFDLVNIQTEnLFxuLy8gICAgICAgb2F1dGhfdmVyc2lvbiA6ICcxLjAnLFxuLy8gICAgICAgY2FsbGJhY2s6ICdjYicgICAgICAgICAgICAgIC8vIFRoaXMgaXMgY3J1Y2lhbCB0byBpbmNsdWRlIGZvciBqc29ucCBpbXBsZW1lbnRhdGlvbiBpbiBBSkFYIG9yIGVsc2UgdGhlIG9hdXRoLXNpZ25hdHVyZSB3aWxsIGJlIHdyb25nLlxuLy8gICAgIH07XG5cbi8vICAgICB2YXIgZW5jb2RlZFNpZ25hdHVyZSA9IG9hdXRoU2lnbmF0dXJlLmdlbmVyYXRlKCdHRVQnLHllbHBfdXJsLCBwYXJhbWV0ZXJzLCBZRUxQX0tFWV9TRUNSRVQsIFlFTFBfVE9LRU5fU0VDUkVUKTtcbi8vICAgICBwYXJhbWV0ZXJzLm9hdXRoX3NpZ25hdHVyZSA9IGVuY29kZWRTaWduYXR1cmU7XG5cbi8vICAgICB2YXIgc2V0dGluZ3MgPSB7XG4vLyAgICAgICB1cmw6IHllbHBfdXJsLFxuLy8gICAgICAgZGF0YTogcGFyYW1ldGVycyxcbi8vICAgICAgIGNhY2hlOiB0cnVlLCAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGNydWNpYWwgdG8gaW5jbHVkZSBhcyB3ZWxsIHRvIHByZXZlbnQgalF1ZXJ5IGZyb20gYWRkaW5nIG9uIGEgY2FjaGUtYnVzdGVyIHBhcmFtZXRlciBcIl89MjM0ODk0ODk3NDk4MzdcIiwgaW52YWxpZGF0aW5nIG91ciBvYXV0aC1zaWduYXR1cmVcbi8vICAgICAgIGRhdGFUeXBlOiAnanNvbnAnLFxuLy8gICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0cykge1xuLy8gICAgICAgICAvLyBEbyBzdHVmZiB3aXRoIHJlc3VsdHNcbi8vICAgICAgIH0sXG4vLyAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgIC8vIERvIHN0dWZmIG9uIGZhaWxcbi8vICAgICAgIH1cbi8vICAgICB9O1xuXG4vLyAgICAgLy8gU2VuZCBBSkFYIHF1ZXJ5IHZpYSBqUXVlcnkgbGlicmFyeS5cbi8vICAgICAkLmFqYXgoc2V0dGluZ3MpO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vTUFQIFZJRVdNT0RFTC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgbWFwO1xudmFyIHZtU3BvdHMgPSBbXTtcbnZhciBpbmZvd2luZG93O1xuXG52YXIgUmVkUm9hZHNOR3JlZW5CdXNTdG9wcyA9IFtcbiAge1xuICAgIFwiZmVhdHVyZVR5cGVcIjogXCJwb2lcIixcbiAgICBcImVsZW1lbnRUeXBlXCI6IFwibGFiZWxzXCIsXG4gICAgXCJzdHlsZXJzXCI6IFtcbiAgICAgICAgeyB2aXNpYmlsaXR5OiBcIm9mZlwiIH1cbiAgICBdXG4gIH0sXG4gIHtcbiAgICBcImZlYXR1cmVUeXBlXCI6IFwicm9hZFwiLFxuICAgIFwic3R5bGVyc1wiOiBbXG4gICAgICB7IFwiZ2FtbWFcIjogMC42NSB9LFxuICAgICAgeyBcImh1ZVwiOiBcIiNmZjljMzBcIiB9LFxuICAgICAgeyBcInZpc2liaWxpdHlcIjogXCJvblwiIH0sXG4gICAgICB7IFwic2F0dXJhdGlvblwiOiA5OSB9LFxuICAgICAgeyBcImxpZ2h0bmVzc1wiOiAtMTIgfVxuICAgIF1cbiAgfSx7XG4gICAgXCJmZWF0dXJlVHlwZVwiOiBcInRyYW5zaXRcIixcbiAgICBcInN0eWxlcnNcIjogW1xuICAgICAgeyBcImh1ZVwiOiBcIiMwMGZmMzNcIiB9LFxuICAgICAgeyBcImdhbW1hXCI6IDAuNjAgfSxcbiAgICAgIHsgXCJzYXR1cmF0aW9uXCI6IDUgfSxcbiAgICAgIHsgXCJ2aXNpYmlsaXR5XCI6IFwib25cIiB9LFxuICAgICAgeyBcIndlaWdodFwiOiA0LjYgfSxcbiAgICAgIHsgXCJsaWdodG5lc3NcIjogLTEyIH0gLy93YXMgLTIyXG4gICAgXVxuICB9XG5dO1xuXG52YXIgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgY2VudGVyOiB7bGF0OiA0OS4yNjIzODcsIGxuZzogLTEyMy4wNjk4Njh9LC8vNDkuMjYyMzg3LCAtMTIzLjA2OTc2OFxuICAgICAgICAvLyBDb21tZXJjaWFsIEJyb2Fkd2F5IFN0YXRpb24gNDnCsDE14oCyNDXigLNOLCAxMjPCsDA04oCyMDjigLNXXG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICB6b29tQ29udHJvbDogdHJ1ZSxcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlLFxuICAgICAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgICAgIGRpc2FibGVEb3VibGVDbGlja1pvb206IHRydWUsXG4gICAgICAgIGRpc2FibGVEZWZhdWx0VUk6IHRydWUsXG4gICAgICAgIHN0eWxlczogUmVkUm9hZHNOR3JlZW5CdXNTdG9wc1xuICAgIH07XG5cbnZhciBpY29ucyA9IHtcbiAgYXNpYW46IHtcbiAgICBpY29uOiAnaW1nL2FzaWFuLnBuZydcbiAgfSxcbiAgY29mZmVlOiB7XG4gICAgaWNvbjogJ2ltZy9jb2ZmZWUucG5nJ1xuICB9LFxuICBmb29kOiB7XG4gICAgaWNvbjogJ2ltZy9mb29kLnBuZydcbiAgfSxcbiAganVpY2U6IHtcbiAgICBpY29uOiAnaW1nL2p1aWNlLnBuZydcbiAgfSxcbiAgcGl6emE6IHtcbiAgICBpY29uOiAnaW1nL3BpenphLnBuZydcbiAgfVxufTtcblxuLy8gaW52b2tlZCBieSBtYXAgPHNjcmlwdD4gaW4gaW5kZXguaHRtbFxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtZGl2JyksIG1hcE9wdGlvbnMgKTtcbiAgICBtb2RlbCA9IGdldE1vZGVsKCk7IC8vIGxvYWQgZGF0YSBvYmplY3QgZWl0aGVyIGZyb20gbG9jYWxTdG9yYWdlIG9yIGZpbGVcbiAgICAvLyB0aGVuIGJ1aWxkIHRoZSBzbGlkZSBjb250ZW50IHdpdGggYWpheCBhcGkgY2FsbHMsIGlmIG5lY2Vzc2FyeVxuICAgIGlmICggKG1vZGVsLnNwb3RzWzBdLnNsaWRlQ29udGVudCA9PT0gdW5kZWZpbmVkKSB8fFxuICAgICAgICAgKG1vZGVsLnNwb3RzWzBdLnNsaWRlQ29udGVudC5zbGljZSgwLDUpID09IFwiU29ycnlcIikpIHtcbiAgICAgICAgICAgIG1vZGVsLnNwb3RzLmZvckVhY2goIGZ1bmN0aW9uIChzcG90KSB7XG4gICAgICAgICAgICAgICAgYnVpbGRTbGlkZUNvbnRlbnQoc3BvdCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB2aWV3TW9kZWwuc3BvdExpc3QobW9kZWwuc3BvdHMpO1xuICAgIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7fSk7XG4gICAgbWFwLnNldFpvb20obW9kZWwuem9vbUxldmVsKTtcbiAgICBtYXAuc2V0Q2VudGVyKG1vZGVsLmNlbnRlcik7XG5cbiAgICAvL2J1aWxkIGFycmF5IG9mIGVhdGluZyBzcG90IG9iamVjdHMgYmFzZWQgb24gdGhlIG1vZGVsXG4gICAgbW9kZWwuc3BvdHMuZm9yRWFjaCggZnVuY3Rpb24oc3BvdCkge1xuICAgICAgICB2bVNwb3RzLnB1c2gobmV3IFNwb3Qoc3BvdCkpO1xuICAgIH0pO1xuXG4gICAgLy8gc3RheSBjZW50cmVkXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICB9KTtcbiAgICAvLyB3aGVuIHRoaW5ncyBzZXR0bGUgZG93biwgc3RvcmUgYSBjb3B5IG9mIHRoZSBtb2RlbCBsb2NhbGx5XG4gICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBsb2NhbFN0b3JhZ2UubW9kZWwgPSBKU09OLnN0cmluZ2lmeShtb2RlbCk7XG4gICAgfSwgMzAwMCk7XG59XG5cbi8vIGNvbnN0cnVjdG9yXG52YXIgU3BvdCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XG4gIHRoaXMubG9jYXRpb24gPSBkYXRhLmxvY2F0aW9uO1xuICB0aGlzLmNhdGVnb3J5ID0gZGF0YS5jYXRlZ29yeTtcbiAgdGhpcy5zbGlkZUNvbnRlbnQgPSBkYXRhLnNsaWRlQ29udGVudDtcbiAgdGhpcy5tYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgcG9zaXRpb246IHRoaXMubG9jYXRpb24sXG4gICAgICAgIHRpdGxlOiB0aGlzLm5hbWUsXG4gICAgICAgIGljb246IGljb25zW3RoaXMuY2F0ZWdvcnldLmljb24sXG4gICAgICAgIG1hcDogbWFwLFxuICAgICAgICBvcGFjaXR5OiAwLjRcbiAgfSk7XG4gIHRoaXMud2luZG93Q29udGVudCA9IGJ1aWxkV2luZG93Q29udGVudCh0aGlzLm1hcmtlcik7XG5cbiAgdGhpcy5jbGlja0V2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodGhpcy5tYXJrZXIsIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LmRvT3BlbmluZygpO1xuICAgIH0pO1xuICB0aGlzLm92ZXJFdmVudCA9IGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHRoaXMubWFya2VyLCBcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuaGlMaWdodExpc3RJdGVtKCk7XG4gIH0pO1xuICB0aGlzLm91dEV2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodGhpcy5tYXJrZXIsIFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LmxvTGlnaHRMaXN0SXRlbSgpO1xuICB9KTtcbn07XG5cblNwb3QucHJvdG90eXBlLmhpTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICQoXCJsaTpjb250YWlucyhcIiArIHRoYXQubmFtZSArIFwiKVwiKS50b2dnbGVDbGFzcyggXCJoaWxpZ2h0IHVuZGVyXCIgKTtcbn07XG5cblNwb3QucHJvdG90eXBlLmxvTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgJChcImxpOmNvbnRhaW5zKFwiICsgdGhhdC5uYW1lICsgXCIpXCIpLnRvZ2dsZUNsYXNzKFwiaGlsaWdodCB1bmRlclwiKTtcbn07XG5cblNwb3QucHJvdG90eXBlLmRvQm91bmNlID0gZnVuY3Rpb24gKCkgIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuICAgIHRoaXMubWFya2VyLnNldEFuaW1hdGlvbihnb29nbGUubWFwcy5BbmltYXRpb24uQk9VTkNFKTtcbn07XG5cblNwb3QucHJvdG90eXBlLnN0b3BCb3VuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xufTtcblxuU3BvdC5wcm90b3R5cGUuZG9PcGVuaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBjbGVhblVwU2NyZWVuKCk7XG4gICAgdGhpcy5tYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhhdC5vcGVuV2luZG93KCk7XG4gICAgICAgIHRoYXQubWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgICB9LCAxMDAwKTtcbn07XG5cblNwb3QucHJvdG90eXBlLm9wZW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHZpZXdNb2RlbC5saXN0Q29sbGFwc2UoKTtcbiAgICBpbmZvd2luZG93LnNldENvbnRlbnQodGhpcy53aW5kb3dDb250ZW50KTtcbiAgICBpbmZvd2luZG93Lm9wZW4obWFwLCB0aGlzLm1hcmtlcik7XG4gICAgdGhpcy5jbG9zZUV2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoaW5mb3dpbmRvdywgXCJjbG9zZWNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjbGVhblVwU2NyZWVuKCk7XG4gICAgICAgICAgdmlld01vZGVsLmxpc3RFeHBhbmQoKTtcbiAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5yZW1vdmVMaXN0ZW5lcih0aGF0LmNsb3NlRXZlbnQpO1xuICAgIH0pO1xufTtcblxuU3BvdC5wcm90b3R5cGUuaGlkZU1hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG51bGwpOyB9O1xuU3BvdC5wcm90b3R5cGUuc2hvd01hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG1hcCk7IH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9LTyBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbnZhciBWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gRGF0YVxuICAgIHNlbGYubGlzdE9uID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICBzZWxmLmJ1cmdlck1lbnUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNwb3RMaXN0ID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgc2VsZi5zbGlkZU9uID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zbGlkZUNvbnRlbnQgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgc2VsZi5maWx0ZXJTbG90ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuaXNTZWxlY3RlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuXG4gICAgLy8gQmVoYXZpb3Vyc1xuXG4gICAgc2VsZi5ib3VuY2VNYXJrZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3QuZG9Cb3VuY2UoKTtcbiAgICB9O1xuXG4gICAgc2VsZi51bmJvdW5jZU1hcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3Quc3RvcEJvdW5jZSgpO1xuICAgIH07XG5cbiAgICBzZWxmLnNwb3RQaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdCh0aGlzLm5hbWUpO1xuICAgICAgICBzcG90LmRvT3BlbmluZygpO1xuICAgIH07XG5cbiAgICBzZWxmLnNldEZpbHRlclNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaXNTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICB9O1xuXG4gICAgc2VsZi5maWx0ZXJTbG90LnN1YnNjcmliZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHNlbGYubGlzdEV4cGFuZCgpO1xuICAgICAgICBzZWxmLnNwb3RMaXN0KGZpbHRlckxpc3QoZGF0YSwgdm1TcG90cykpO1xuICAgICAgICByZXNldE1hcmtlcnMoc2VsZi5zcG90TGlzdCgpKTtcbiAgICB9KTtcblxuICAgIHNlbGYub25FbnRlciA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93LmFuY2hvcikge1xuICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc3BvdExpc3QoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zcG90TGlzdCgpWzBdLmRvT3BlbmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93KSBpbmZvd2luZG93LmNsb3NlKCk7IC8vZm9yIGFueSBvdGhlciBrZXlwcmVzc1xuICAgICAgICAgICAgc2VsZi5zbGlkZU9mZigpO1xuICAgICAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIG5lY2Vzc2FyeSB0byByZWZsZWN0IHRoZSB0ZXh0IGluIHRoZSBzbG90XG4gICAgfTtcblxuICAgIHNlbGYubGlzdENvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2Rpc2FibGUgZm9yIGJpZyBzY3JlZW47IGVuYWJsZSBmb3Igc21hbGxcbiAgICAgICAgdmFyIG1lZGlhcXVlcnkgPSB3aW5kb3cubWF0Y2hNZWRpYSggXCIobWF4LXdpZHRoOiA1NDlweClcIiApO1xuICAgICAgICBpZiAobWVkaWFxdWVyeS5tYXRjaGVzKSB7XG4gICAgICAgICAgICBzZWxmLmxpc3RPbihmYWxzZSk7XG4gICAgICAgICAgICBzZWxmLmJ1cmdlck1lbnUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgc2VsZi5saXN0RXhwYW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjbGVhblVwU2NyZWVuKCk7XG4gICAgICAgIHNlbGYuYnVyZ2VyTWVudShmYWxzZSk7XG4gICAgICAgIHNlbGYubGlzdE9uKHRydWUpO1xuICAgIH07XG5cbiAgICBzZWxmLm9wZW5BUElzbGlkZSA9IGZ1bmN0aW9uIChzcG90TmFtZSkge1xuICAgICAgICB2YXIgc3BvdCA9IGdldFNwb3Qoc3BvdE5hbWUpO1xuICAgICAgICBpZiAoIShzcG90LnNsaWRlQ29udGVudCkpIHtcbiAgICAgICAgICAgIGR1YlNsaWRlQ29udGVudHMoKTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3TW9kZWwuc2xpZGVDb250ZW50KHNwb3Quc2xpZGVDb250ZW50KTtcbiAgICAgICAgdmlld01vZGVsLnNsaWRlT24odHJ1ZSk7XG4gICAgfTtcblxuICAgIHNlbGYuc2xpZGVPZmYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2xpZGVPbihmYWxzZSk7XG4gICAgfTtcbn07XG5cbnZhciB2aWV3TW9kZWwgPSBuZXcgVmlld01vZGVsKCk7XG5rby5hcHBseUJpbmRpbmdzKHZpZXdNb2RlbCk7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tSEVMUEVSIEZVTkNUSU9OUy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cblxuZnVuY3Rpb24gZmlsdGVyTGlzdCh1c2VyVGV4dCwgbW9kZWxBcnJheSkge1xuLy90ZXN0IGFycmF5IGFnYWluc3QgYSByZWd1bGFyIGV4cHJlc3Npb25cbiAgICAgdmFyIHJlc3VsdD1bXSxcbiAgICAgICAgIHJlID0gbmV3IFJlZ0V4cCh1c2VyVGV4dCwgWydpJ10pO1xuICAgICBtb2RlbEFycmF5LmZvckVhY2goIGZ1bmN0aW9uKGVsZW1lbnQsIGluZGV4LCBhcnJheSkge1xuICAgICAgICBpZiAocmUudGVzdChlbGVtZW50Lm5hbWUpKSByZXN1bHQucHVzaChlbGVtZW50KTtcbiAgICAgfSk7XG4gICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGdldFNwb3QobmFtZSkge1xuLy8gcmV0dXJucyB0aGUgdmlldy1tb2RlbCBvYmplY3Qgd2l0aCB0aGUgZ2l2ZW4gbmFtZVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm1TcG90cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCB2bVNwb3RzW2ldLm5hbWUgPT0gbmFtZSApIHJldHVybiB2bVNwb3RzW2ldO1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiByZXNldE1hcmtlcnMoc3BvdHMpIHtcbi8vIGVkaXQgdGhlIHNldCBvZiBkaXNwbGF5ZWQgbWFya2VycyBiYXNlZCBvbiB0aGUgZmlsdGVyZWQgc3BvdExpc3RcbiAgICB2bVNwb3RzLmZvckVhY2goZnVuY3Rpb24oc3BvdCkge1xuICAgICAgICBzcG90LmhpZGVNYXJrZXIoKTtcbiAgICB9KTtcbiAgICBzcG90cy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgZ2V0U3BvdChpdGVtLm5hbWUpLnNob3dNYXJrZXIoKTtcbiAgICB9KTtcbn1cblxuXG5mdW5jdGlvbiBpdGNod2luZG93KCkge1xuLy8gY2FsbGVkIGluIHRoZSBjbGljayBldmVudCBsaXN0ZW5lciBvZiBpbmZvV2luZG93XG4gICAgdmlld01vZGVsLm9wZW5BUElzbGlkZShpbmZvd2luZG93LmFuY2hvci50aXRsZSk7XG59XG5cblxuZnVuY3Rpb24gY2xlYW5VcFNjcmVlbigpIHtcbi8vIGdldCByaWQgb2Ygb2xkIG92ZXItbGF5cyBhbmQgbGluZ2VyaW5nIGVmZmVjdHNcbiAgICBpbmZvd2luZG93LmNsb3NlKCk7XG4gICAgbWFwLnNldFpvb20obW9kZWwuem9vbUxldmVsKTtcbiAgICBtYXAuc2V0Q2VudGVyKG1vZGVsLmNlbnRlcik7XG4gICAgdmlld01vZGVsLnNsaWRlT2ZmKCk7XG4gICAgLy8gcmVzZXQgdGhlIGhpbGlnaHQgYW5kIHVuZGVyIGNsYXNzZXMgb24gdGhlIHNwb3QtbGlzdFxuICAgICQoXCJ1bC5zcG90LWxpc3QgbGlcIikucmVtb3ZlQ2xhc3MoXCJoaWxpZ2h0IHVuZGVyXCIpO1xufVxuXG5mdW5jdGlvbiBkdWJTbGlkZUNvbnRlbnRzKCkge1xuICAgIGlmIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQpIHtcbiAgICAgICAgbW9kZWwuc3BvdHMuZm9yRWFjaChmdW5jdGlvbihzcG90LCBpbmRleCkge1xuICAgICAgICAgICAgdm1TcG90c1tpbmRleF0uc2xpZGVDb250ZW50ID0gc3BvdC5zbGlkZUNvbnRlbnQ7XG4gICAgICAgICAgICAvLyBpbiB0aGUgZXZlbnQgdGhhdCBhcGkgY2FsbCBmYWlscywgd2Ugd2FudCB0byByZS1jb3B5IHRoZVxuICAgICAgICAgICAgLy8gbW9kZWwgbG9jYWxseSwgdG8gZGlzcGxheSBlcnJvciBtZXNzYWdlXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UubW9kZWwgPSBKU09OLnN0cmluZ2lmeShtb2RlbCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuXG5cblxuXG4vLz09PT09PT09PT09PT09PT09PT1USEUgRU5EPT09PT09PT09PT09PT09PT09PVxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4vL2Zyb20gaHR0cHM6Ly9kZXZlbG9wZXIuZm91cnNxdWFyZS5jb20vb3ZlcnZpZXcvYXV0aCN1c2VybGVzc1xuLy9odHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvc2VhcmNoP2xsPTQwLjcsLTc0JmNsaWVudF9pZD1DTElFTlRfSUQmY2xpZW50X3NlY3JldD1DTElFTlRfU0VDUkVUJnY9WVlZWU1NRERcblxuLy9mb3Vyc3F1YXJlLmNvbS92L2Jyb2Fkd2F5LXN0YXRpb24tc3VzaGkvNGFhZTljYjdmOTY0YTUyMDliNjIyMGUzXG52YXIga3IgPSB7XG4gICAgZm91cnNxdWFyZToge1xuICAgICAgICBPd25lcjogXCJLUiBEZWNrZXJcIixcbiAgICAgICAgQ2xpZW50X2lkOiBcIlpWTEtUS1NHVUxGRVEzWE1XV0kzQUwxQTJLWFlCRUtEMUxLU1VSVVpER1pZNDFKWFwiLFxuICAgICAgICBDbGllbnRfc2VjcmV0OiBcIlRNVDIwM0RIV09QUjNSNFJTTTFIRTRSTU9LRVdMR1RUMEZMTVpNVVoxT0pITUFLMVwiXG4gICAgfSxcbiAgICB5ZWxwOiB7XG4gICAgICAgIENvbnN1bWVyX0tleTogICAgXCJYcnhKT1VnR05LcTladVdoQlgxTER3XCIsXG4gICAgICAgIENvbnN1bWVyX1NlY3JldDogXCJ6cjJJNzZuVDhsME8tdHJrdXBZRTAwQjlCVEFcIixcbiAgICAgICAgVG9rZW46ICAgXCItX0Y4YU94b25SNnE1U3F2VVJ3d2dMSWRVLXF0ZVMtQlwiLFxuICAgICAgICBUb2tlbl9TZWNyZXQ6ICAgIFwiR0Y3dVJjUFdDcHpsSGNSUDNEaUpXanZjWEpFXCJcbiAgICB9LFxuICAgIHN0cmVldHZpZXc6IHtcbiAgICAgICAga2V5OiBcIkFJemFTeUFQNjMxejZXcU1vcHRvYUdoZXJoSlZCR3lOMXVQSFB0NFwiXG4gICAgfVxufTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
