"use strict";function getModel(){return localStorage.model?JSON.parse(localStorage.model):EatsModel}function buildWindowContent(e){var t="http://maps.googleapis.com/maps/api/streetview?size=200x150&location="+e.position.toString().slice(1,-1),o='<img class="bgimg" src="'+t+'">',n='"height:100%;width:80%"',i='<div onclick="itchwindow()" style='+n+">"+o+'<br><span style="color:darkgreen">'+e.title+'</span><br><span style="color:red">-CLICK FOR MORE INFO-</span></div>';return i}function buildSlideContent(e){function t(t,i){console.log("In getVenueInfo: status = "+i);var a=t.response.venues[0];$.ajax({url:fourSquareURL+"/v2/venues/"+a.id,dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:o,error:n})}function o(t){var o=t.response.venue;i="FourSquare info: <br><br>"+o.name+"<br>"+o.contact.formattedPhone+"<br>- "+o.location.address+"<br>- "+o.location.city+"<br>- "+o.location.country+"<br>x-street: "+o.location.crossStreet+"<br>Check-ins: "+o.stats.checkinsCount.toString()+"<br>"+o.likes.summary+'<br><br><span style="background-color:#'+o.ratingColor+';color:black;padding:1%">Rating: '+o.rating.toString()+'</span><br><img src="'+o.bestPhoto.prefix+"cap300"+o.bestPhoto.suffix+'">',updateSlideContent(e,i)}function n(t,o,n){var i="Sorry. 3rd party info unavailable.";updateSlideContent(e,i)}var i="",s="ll="+e.location.lat.toString()+","+e.location.lng.toString();$.ajax({url:fourSquareURL+"/v2/venues/search",dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:t,error:n})}function updateSlideContent(e,t){e.slideContent=t;var o=getSpot(e.name);o&&(console.log("in updateSlideContent: viewSpot "),o.slideContent=t)}function init(){map=new google.maps.Map(document.getElementById("map-div"),mapOptions),model=getModel(),(void 0===model.spots[0].slideContent||"Sorry"==model.spots[0].slideContent.slice(0,5))&&model.spots.forEach(function(e){buildSlideContent(e)}),viewModel.spotList(model.spots),infowindow=new google.maps.InfoWindow({}),map.setZoom(model.zoomLevel),map.setCenter(model.center),model.spots.forEach(function(e){vmSpots.push(new Spot(e))}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(model.center)}),window.setTimeout(function(){localStorage.model=JSON.stringify(model)},3e3)}function filterList(e,t){var o=[],n=new RegExp(e,["i"]);return t.forEach(function(e,t,i){n.test(e.name)&&o.push(e)}),o}function getSpot(e){var t;return vmSpots.forEach(function(o){o.name==e&&(t=o)}),t}function resetMarkers(e){vmSpots.forEach(function(e){e.hideMarker()}),e.forEach(function(e){getSpot(e.name).showMarker()})}function itchwindow(){viewModel.openAPIslide(infowindow.anchor.title)}function cleanUpScreen(){infowindow.close(),map.setZoom(model.zoomLevel),map.setCenter(model.center),viewModel.slideOff()}function dubSlideContents(){if(model.spots[0].slideContent)for(var e in model.spots)vmSpots[e].slideContent=model.spots[e].slideContent,localStorage.model=JSON.stringify(model)}var EatsModel={zoomLevel:18,center:{lat:49.262387,lng:-123.069768},spots:[{name:"Uncle Fatih's Pizza",location:{lat:49.262487,lng:-123.07}},{name:"Buddha's Orient Express",location:{lat:49.262719,lng:-123.069289}},{name:"Booster Juice",location:{lat:49.262641,lng:-123.069438}},{name:"Starbucks Coffee",location:{lat:49.261874,lng:-123.070176}},{name:"Blenz Coffee",location:{lat:49.262534,lng:-123.069529}},{name:"Megabite Pizza",location:{lat:49.262779,lng:-123.069317}},{name:"Broadway Station Sushi",location:{lat:49.262084,lng:-123.070962}}]},model={},fourSquareURL="https://api.foursquare.com",map,vmSpots=[],infowindow,RedRoadsNGreenBusStops=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{gamma:.65},{hue:"#ff9c30"},{visibility:"on"},{saturation:99},{lightness:-12}]},{featureType:"transit",stylers:[{hue:"#00ff33"},{gamma:.6},{saturation:5},{visibility:"on"},{weight:4.6},{lightness:-12}]}],mapOptions={center:{lat:49.262387,lng:-123.069768},zoom:16,zoomControl:!0,scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,disableDefaultUI:!0,styles:RedRoadsNGreenBusStops},Spot=function(e){var t=this;this.name=e.name,this.location=e.location,this.slideContent=e.slideContent,this.marker=new google.maps.Marker({position:this.location,title:this.name,map:map,opacity:.4}),this.windowContent=buildWindowContent(this.marker),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(){t.doOpening()}),this.overEvent=google.maps.event.addListener(this.marker,"mouseover",function(){t.hiLightListItem()}),this.outEvent=google.maps.event.addListener(this.marker,"mouseout",function(){t.loLightListItem()})};Spot.prototype.hiLightListItem=function(){var e=this;cleanUpScreen(),console.log("we could hi-light the "+e.name+" list item now"),$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.loLightListItem=function(){var e=this;console.log("we could lo-light the "+e.name+" list item now"),$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.doBounce=function(){cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE)},Spot.prototype.stopBounce=function(){this.marker.setAnimation(null)},Spot.prototype.doOpening=function(){var e=this;cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.openWindow(),e.marker.setAnimation(null)},1e3)},Spot.prototype.openWindow=function(){viewModel.listCollapse(),infowindow.setContent(this.windowContent),infowindow.open(map,this.marker)},Spot.prototype.hideMarker=function(){this.marker.setMap(null)},Spot.prototype.showMarker=function(){this.marker.setMap(map)};var ViewModel=function(){var e=this;e.listOn=ko.observable(!0),e.burgerMenu=ko.observable(!1),e.spotList=ko.observableArray(),e.slideOn=ko.observable(!1),e.slideContent=ko.observable(),e.filterSlot=ko.observable(),e.isSelected=ko.observable(!1),e.bounceMarker=function(){console.log("Bouncey, bouncey "+this.name);var e=getSpot(this.name);e.doBounce()},e.unbounceMarker=function(){var e=getSpot(this.name);e.stopBounce()},e.spotPick=function(){var e=getSpot(this.name);e.doOpening()},e.setFilterSelected=function(){this.isSelected(!0),cleanUpScreen(),e.listExpand()},e.filterSlot.subscribe(function(t){e.listExpand(),e.spotList(filterList(t,vmSpots)),resetMarkers(e.spotList())}),e.onEnter=function(t,o){return 13===o.keyCode?infowindow.anchor?e.openAPIslide(infowindow.anchor.title):1===e.spotList().length&&e.spotList()[0].doOpening():(infowindow&&infowindow.close(),e.slideOff(),e.listExpand()),!0},e.listCollapse=function(){var t=window.matchMedia("(max-width: 549px)");t.matches&&(e.listOn(!1),e.burgerMenu(!0))},e.listExpand=function(){cleanUpScreen(),e.burgerMenu(!1),e.listOn(!0)},e.openAPIslide=function(e){var t=getSpot(e);t.slideContent||dubSlideContents(),viewModel.slideContent(t.slideContent),viewModel.slideOn(!0)},e.slideOff=function(){this.slideOn(!1)}},viewModel=new ViewModel;ko.applyBindings(viewModel);var kr={foursquare:{Owner:"KR Decker",Client_id:"ZVLKTKSGULFEQ3XMWWI3AL1A2KXYBEKD1LKSURUZDGZY41JX",Client_secret:"TMT203DHWOPR3R4RSM1HE4RMOKEWLGTT0FLMZMUZ1OJHMAK1"},yelp:{Consumer_Key:"XrxJOUgGNKq9ZuWhBX1LDw",Consumer_Secret:"zr2I76nT8l0O-trkupYE00B9BTA",Token:"-_F8aOxonR6q5SqvURwwgLIdU-qteS-B",Token_Secret:"GF7uRcPWCpzlHcRP3DiJWjvcXJE"},streetview:{key:"AIzaSyAP631z6WqMoptoaGherhJVBGyN1uPHPt4"}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnZXRNb2RlbCIsImxvY2FsU3RvcmFnZSIsIm1vZGVsIiwiSlNPTiIsInBhcnNlIiwiRWF0c01vZGVsIiwiYnVpbGRXaW5kb3dDb250ZW50IiwibWFya2VyIiwic3RyZWV0dmlld1VybCIsInBvc2l0aW9uIiwidG9TdHJpbmciLCJzbGljZSIsInBpY3R1cmUiLCJjc3MiLCJjb250ZW50IiwidGl0bGUiLCJidWlsZFNsaWRlQ29udGVudCIsInNwb3QiLCJnZXRWZW51ZUluZm8iLCJkYXRhIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInZlbnVlIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCIkIiwiYWpheCIsInVybCIsImZvdXJTcXVhcmVVUkwiLCJpZCIsImRhdGFUeXBlIiwibG9jIiwibmFtZSIsImtyIiwiZm91cnNxdWFyZSIsIkNsaWVudF9pZCIsIkNsaWVudF9zZWNyZXQiLCJhc3luYyIsInN1Y2Nlc3MiLCJmb3JtYXRTaG93RGF0YSIsImVycm9yIiwic2VuZEVycm9yIiwiZm9ybWF0dGVkRGF0YSIsImNvbnRhY3QiLCJmb3JtYXR0ZWRQaG9uZSIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiY3Jvc3NTdHJlZXQiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJsaWtlcyIsInN1bW1hcnkiLCJyYXRpbmdDb2xvciIsInJhdGluZyIsImJlc3RQaG90byIsInByZWZpeCIsInN1ZmZpeCIsInVwZGF0ZVNsaWRlQ29udGVudCIsIm9iamVjdCIsImV4Y2VwdGlvbiIsImFqYXhfZXJyb3IiLCJsYXQiLCJsbmciLCJkYXRhU3RyaW5nIiwic2xpZGVDb250ZW50Iiwidm1TcG90IiwiZ2V0U3BvdCIsImluaXQiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1hcE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzcG90cyIsImZvckVhY2giLCJ2aWV3TW9kZWwiLCJzcG90TGlzdCIsImluZm93aW5kb3ciLCJJbmZvV2luZG93Iiwic2V0Wm9vbSIsInpvb21MZXZlbCIsInNldENlbnRlciIsImNlbnRlciIsInZtU3BvdHMiLCJwdXNoIiwiU3BvdCIsImV2ZW50IiwiYWRkRG9tTGlzdGVuZXIiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0Iiwic3RyaW5naWZ5IiwiZmlsdGVyTGlzdCIsInVzZXJUZXh0IiwibW9kZWxBcnJheSIsInJlc3VsdCIsInJlIiwiUmVnRXhwIiwiZWxlbWVudCIsImluZGV4IiwiYXJyYXkiLCJ0ZXN0IiwicmVzZXRNYXJrZXJzIiwiaGlkZU1hcmtlciIsIml0ZW0iLCJzaG93TWFya2VyIiwiaXRjaHdpbmRvdyIsIm9wZW5BUElzbGlkZSIsImFuY2hvciIsImNsZWFuVXBTY3JlZW4iLCJjbG9zZSIsInNsaWRlT2ZmIiwiZHViU2xpZGVDb250ZW50cyIsImkiLCJSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzIiwiZmVhdHVyZVR5cGUiLCJlbGVtZW50VHlwZSIsInN0eWxlcnMiLCJ2aXNpYmlsaXR5IiwiZ2FtbWEiLCJodWUiLCJzYXR1cmF0aW9uIiwibGlnaHRuZXNzIiwid2VpZ2h0Iiwiem9vbSIsInpvb21Db250cm9sIiwic2Nyb2xsd2hlZWwiLCJkcmFnZ2FibGUiLCJkaXNhYmxlRG91YmxlQ2xpY2tab29tIiwiZGlzYWJsZURlZmF1bHRVSSIsInN0eWxlcyIsInRoYXQiLCJ0aGlzIiwiTWFya2VyIiwib3BhY2l0eSIsIndpbmRvd0NvbnRlbnQiLCJjbGlja0V2ZW50IiwiYWRkTGlzdGVuZXIiLCJkb09wZW5pbmciLCJvdmVyRXZlbnQiLCJoaUxpZ2h0TGlzdEl0ZW0iLCJvdXRFdmVudCIsImxvTGlnaHRMaXN0SXRlbSIsInByb3RvdHlwZSIsInRvZ2dsZUNsYXNzIiwiZG9Cb3VuY2UiLCJzZXRBbmltYXRpb24iLCJBbmltYXRpb24iLCJCT1VOQ0UiLCJzdG9wQm91bmNlIiwib3BlbldpbmRvdyIsImxpc3RDb2xsYXBzZSIsInNldENvbnRlbnQiLCJvcGVuIiwic2V0TWFwIiwiVmlld01vZGVsIiwic2VsZiIsImxpc3RPbiIsImtvIiwib2JzZXJ2YWJsZSIsImJ1cmdlck1lbnUiLCJvYnNlcnZhYmxlQXJyYXkiLCJzbGlkZU9uIiwiZmlsdGVyU2xvdCIsImlzU2VsZWN0ZWQiLCJib3VuY2VNYXJrZXIiLCJ1bmJvdW5jZU1hcmtlciIsInNwb3RQaWNrIiwic2V0RmlsdGVyU2VsZWN0ZWQiLCJsaXN0RXhwYW5kIiwic3Vic2NyaWJlIiwib25FbnRlciIsImtleUNvZGUiLCJsZW5ndGgiLCJtZWRpYXF1ZXJ5IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJzcG90TmFtZSIsImFwcGx5QmluZGluZ3MiLCJPd25lciIsInllbHAiLCJDb25zdW1lcl9LZXkiLCJDb25zdW1lcl9TZWNyZXQiLCJUb2tlbiIsIlRva2VuX1NlY3JldCIsInN0cmVldHZpZXciLCJrZXkiXSwibWFwcGluZ3MiOiJBQUFBLFlBOENBLFNBQVNBLFlBQ0wsTUFBSUMsY0FBYUMsTUFDTkMsS0FBS0MsTUFBTUgsYUFBYUMsT0FFeEJHLFVBS2YsUUFBU0Msb0JBQW1CQyxHQUN4QixHQUFJQyxHQUFnQix3RUFDSUQsRUFBT0UsU0FBU0MsV0FBV0MsTUFBTSxFQUFFLElBSXZEQyxFQUFVLDJCQUE2QkosRUFBZ0IsS0FDdkRLLEVBQU0sMEJBQ05DLEVBQVUscUNBQ0VELEVBQU0sSUFBTUQsRUFBVSxxQ0FDdEJMLEVBQU9RLE1BQVEsdUVBRy9CLE9BQU9ELEdBVVgsUUFBU0UsbUJBQWtCQyxHQXFCdkIsUUFBU0MsR0FBYUMsRUFBTUMsR0FDeEJDLFFBQVFDLElBQUksNkJBQStCRixFQUMzQyxJQUFJRyxHQUFRSixFQUFLSyxTQUFTQyxPQUFPLEVBRWpDQyxHQUFFQyxNQUNFQyxJQUFLQyxjQUFnQixjQUFnQk4sRUFBTU8sR0FDM0NDLFNBQVUsT0FDVlosS0FBTSxXQUNRYSxFQUNOLFVBQVlmLEVBQUtnQixLQUNqQixjQUFlQyxHQUFHQyxXQUFXQyxVQUM3QixrQkFBbUJGLEdBQUdDLFdBQVdFLGNB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Qiw4QkFDakJDLE1BQVMsbUNBQ1RDLGFBQWlCLCtCQUVyQkMsWUFDSUMsSUFBSyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9NT0RFTC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLy8gZWF0cyBkYXRhOiBhbiBhcnJheSBvZiBwbGFjZXMgdG8gZWF0XG4vLyBhcm91bmQgQ29tbWVyY2lhbC1Ccm9hZHdheSBTdGF0aW9uXG4vLyBFYXN0IFZhblxuLy8gQnJpdGlzaCBDb2x1bWJpYVxuXG4vLyBiYXNpYyBkYXRhLCBsb2FkZWQgaWYgbW9yZSBkZXRhaWxlZCBtb2RlbCBub3QgZm91bmQgaW4gbG9jYWxTdG9yYWdlXG52YXIgRWF0c01vZGVsID0ge1xuICAgIHpvb21MZXZlbDogMTgsXG4gICAgY2VudGVyOiB7bGF0OiA0OS4yNjIzODcsIGxuZzogLTEyMy4wNjk3Njh9LC8vNDkuMjYyMzg3LCAtMTIzLjA2OTc2OFxuICAgIHNwb3RzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiVW5jbGUgRmF0aWgncyBQaXp6YVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjQ4NywgbG5nOiAtMTIzLjA3MDAwMH0gLy93YXMgLjI2MjUxNyAuMDcwMTc3XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQnVkZGhhJ3MgT3JpZW50IEV4cHJlc3NcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI3MTksIGxuZzogLTEyMy4wNjkyODl9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQm9vc3RlciBKdWljZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjY0MSwgbG5nOiAtMTIzLjA2OTQzOH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJTdGFyYnVja3MgQ29mZmVlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYxODc0LCBsbmc6IC0xMjMuMDcwMTc2fVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJsZW56IENvZmZlZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjUzNCwgbG5nOiAtMTIzLjA2OTUyOX1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJNZWdhYml0ZSBQaXp6YVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2Mjc3OSwgbG5nOiAtMTIzLjA2OTMxN31cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCcm9hZHdheSBTdGF0aW9uIFN1c2hpXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyMDg0LCBsbmc6IC0xMjMuMDcwOTYyfVxuICAgICAgICB9XG4gICAgXVxufTtcblxudmFyIG1vZGVsID0ge307XG5cbmZ1bmN0aW9uIGdldE1vZGVsKCkge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UubW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLm1vZGVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gRWF0c01vZGVsO1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBidWlsZFdpbmRvd0NvbnRlbnQobWFya2VyKSB7XG4gICAgdmFyIHN0cmVldHZpZXdVcmwgPSAnaHR0cDovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvc3RyZWV0dmlldz9zaXplPTIwMHgxNTAmbG9jYXRpb249JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLnBvc2l0aW9uLnRvU3RyaW5nKCkuc2xpY2UoMSwtMSkgOy8vICsgJyZrZXk9JyArIGtyLnN0cmVldHZpZXcua2V5O1xuICAgIC8vIG1hcmtlci5wb3NpdGlvbi50b1N0cmluZygpIG1ldGhvZCBjaGFuZ2VkIHRvIGluY2x1ZGUgcGFyZW50aGVzZXMsIGhlbmNlIHRoZSBzbGljZVxuICAgIC8vIGtleSBub3QgcmVxdWlyZWRcblxuICAgIHZhciBwaWN0dXJlID0gJzxpbWcgY2xhc3M9XCJiZ2ltZ1wiIHNyYz1cIicgKyBzdHJlZXR2aWV3VXJsICsgJ1wiPic7XG4gICAgdmFyIGNzcyA9ICdcImhlaWdodDoxMDAlO3dpZHRoOjgwJVwiJztcbiAgICB2YXIgY29udGVudCA9ICc8ZGl2IG9uY2xpY2s9XCJpdGNod2luZG93KClcIiBzdHlsZT0nICtcbiAgICAgICAgICAgICAgICAgICAgY3NzICsgJz4nICsgcGljdHVyZSArICc8YnI+PHNwYW4gc3R5bGU9XCJjb2xvcjpkYXJrZ3JlZW5cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLnRpdGxlICsgJzwvc3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxicj48c3BhbiBzdHlsZT1cImNvbG9yOnJlZFwiPi1DTElDSyBGT1IgTU9SRSBJTkZPLTwvc3Bhbj48L2Rpdj4nO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gM3JkIHBhcnR5IEFQSSBzdHVmZlxudmFyIGZvdXJTcXVhcmVVUkwgPSAnaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20nO1xuXG4vLyBnZXQgY29udGVudCBmb3IgaW5mbyBzbGlkZXMgZnJvbSAzcmQgcGFydHkgc291cmNlc1xuLy8gYmFzZWQgb24gaW5mbyBmcm9tIG1vZGVsXG4vLyB0aGVuIGFkZCB0byBtb2RlbCBhbmQgdG8gdmlldyBvYmplY3RzXG5mdW5jdGlvbiBidWlsZFNsaWRlQ29udGVudChzcG90KSB7XG4gICAgdmFyIGZvcm1hdHRlZERhdGEgPSBcIlwiO1xuICAgIHZhciBsb2MgPSBcImxsPVwiICsgc3BvdC5sb2NhdGlvbi5sYXQudG9TdHJpbmcoKSArIFwiLFwiICsgc3BvdC5sb2NhdGlvbi5sbmcudG9TdHJpbmcoKTtcbiAgICB2YXIgYWpheF9lcnJvcjtcblxuICAgIC8vIGdldCB0aGUgZm91cnNxdWFyZSBJRCBudW1iZXIgb2YgdGhlIHNwb3RcbiAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBmb3VyU3F1YXJlVVJMICsgJy92Mi92ZW51ZXMvc2VhcmNoJyxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBkYXRhOiAnbGltaXQ9MScgK1xuICAgICAgICAgICAgICAgICAgICAnJicgKyBsb2MgKyAnJnF1ZXJ5PScgKyBzcG90Lm5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9pZD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9pZCArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X3NlY3JldD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9zZWNyZXQgK1xuICAgICAgICAgICAgICAgICAgICAnJnY9MjAxNjAxMzAnLFxuICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBnZXRWZW51ZUluZm8sXG4gICAgICAgICAgICBlcnJvcjogc2VuZEVycm9yXG4gICAgfSk7XG5cbiAgICAvLyBnaXZlIHRoZSByZXNwb25zZSBvbiBzcGVjaWZpYyB2ZW51ZSB0byBhbm90aGVyIGNhbGwgZm9yXG4gICAgLy8gbW9yZSBkZXRhaWxlZCBpbmZvcm1hdGlvblxuICAgIGZ1bmN0aW9uIGdldFZlbnVlSW5mbyhkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJJbiBnZXRWZW51ZUluZm86IHN0YXR1cyA9IFwiICsgc3RhdHVzKTtcbiAgICAgICAgdmFyIHZlbnVlID0gZGF0YS5yZXNwb25zZS52ZW51ZXNbMF07XG4gICAgICAgIC8vaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL1ZFTlVFX0lEXG4gICAgICAgICQuYWpheCh7IC8vIHRvIGdldCB0aGUgZGV0YWlsZWQgZm91cnNxdWFyZSBvZiB0aGUgJ2NvbXBsZXRlIHZlbnVlJyBiYXNlZCBvbiBJRFxuICAgICAgICAgICAgdXJsOiBmb3VyU3F1YXJlVVJMICsgJy92Mi92ZW51ZXMvJyArIHZlbnVlLmlkLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgIGRhdGE6ICdsaW1pdD0xJyArXG4gICAgICAgICAgICAgICAgICAgICcmJyArIGxvYyArXG4gICAgICAgICAgICAgICAgICAgICcmcXVlcnk9JyArIHNwb3QubmFtZSArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X2lkPScrIGtyLmZvdXJzcXVhcmUuQ2xpZW50X2lkICtcbiAgICAgICAgICAgICAgICAgICAgJyZjbGllbnRfc2VjcmV0PScrIGtyLmZvdXJzcXVhcmUuQ2xpZW50X3NlY3JldCArXG4gICAgICAgICAgICAgICAgICAgICcmdj0yMDE2MDEzMCcsXG4gICAgICAgICAgICBhc3luYzogdHJ1ZSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZvcm1hdFNob3dEYXRhLFxuICAgICAgICAgICAgZXJyb3I6IHNlbmRFcnJvclxuICAgICAgICB9KTsvKi5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICBmb3JtYXRTaG93RGF0YShyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTsqL1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcm1hdFNob3dEYXRhKGRhdGEpe1xuICAgICAgICB2YXIgdmVudWUgPSBkYXRhLnJlc3BvbnNlLnZlbnVlO1xuICAgICAgICBmb3JtYXR0ZWREYXRhID0gJ0ZvdXJTcXVhcmUgaW5mbzogJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGJyPicgKyAnPGJyPicgKyB2ZW51ZS5uYW1lICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlbnVlLmNvbnRhY3QuZm9ybWF0dGVkUGhvbmUgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJy0gJyArIHZlbnVlLmxvY2F0aW9uLmFkZHJlc3MgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJy0gJyArIHZlbnVlLmxvY2F0aW9uLmNpdHkgICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICctICcgKyB2ZW51ZS5sb2NhdGlvbi5jb3VudHJ5ICArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAneC1zdHJlZXQ6ICcgKyB2ZW51ZS5sb2NhdGlvbi5jcm9zc1N0cmVldCArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnQ2hlY2staW5zOiAnICsgdmVudWUuc3RhdHMuY2hlY2tpbnNDb3VudC50b1N0cmluZygpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8YnI+JyArIHZlbnVlLmxpa2VzLnN1bW1hcnkgKyAnPGJyPicgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjojJyArIHZlbnVlLnJhdGluZ0NvbG9yICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc7Y29sb3I6YmxhY2s7cGFkZGluZzoxJVwiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1JhdGluZzogJyArIHZlbnVlLnJhdGluZy50b1N0cmluZygpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3NwYW4+JyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCInICsgdmVudWUuYmVzdFBob3RvLnByZWZpeCArXG4gICAgICAgICAgICAgICAgICAgICAgICAnY2FwMzAwJyArIHZlbnVlLmJlc3RQaG90by5zdWZmaXggKyAnXCI+J1xuICAgICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAvL3Nwb3Quc2xpZGVDb250ZW50ID0gZm9ybWF0dGVkRGF0YTtcbiAgICAgICAgdXBkYXRlU2xpZGVDb250ZW50KHNwb3QsIGZvcm1hdHRlZERhdGEpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZW5kRXJyb3Iob2JqZWN0LCBlcnJvciwgZXhjZXB0aW9uKSB7XG4gICAgICAgIHZhciBhamF4X2Vycm9yID0gXCJTb3JyeS4gM3JkIHBhcnR5IGluZm8gdW5hdmFpbGFibGUuXCI7XG4gICAgICAgIHVwZGF0ZVNsaWRlQ29udGVudChzcG90LCBhamF4X2Vycm9yKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVNsaWRlQ29udGVudChzcG90LCBkYXRhU3RyaW5nKSB7XG4gICAgLy8gdXBkYXRlIHRoZSBtb2RlbFxuICAgIHNwb3Quc2xpZGVDb250ZW50ID0gZGF0YVN0cmluZztcbiAgICAvLyB1cGRhdGUgdGhlIHZpZXdcbiAgICB2YXIgdm1TcG90ID0gZ2V0U3BvdChzcG90Lm5hbWUpO1xuICAgIGlmICh2bVNwb3QpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJpbiB1cGRhdGVTbGlkZUNvbnRlbnQ6IHZpZXdTcG90IFwiKTtcbiAgICAgICAgdm1TcG90LnNsaWRlQ29udGVudCA9IGRhdGFTdHJpbmc7XG4gICAgfVxufVxuXG4vLyBNYXJrTidzIGltcGxlbWVudGF0aW9uIG9mXG4vKipcbiAqIEdlbmVyYXRlcyBhIHJhbmRvbSBudW1iZXIgYW5kIHJldHVybnMgaXQgYXMgYSBzdHJpbmcgZm9yIE9BdXRoZW50aWNhdGlvblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG4vLyBmdW5jdGlvbiBub25jZV9nZW5lcmF0ZSgpIHtcbi8vICAgcmV0dXJuIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxZTEyKS50b1N0cmluZygpKTtcbi8vIH1cblxuLy8gdmFyIHllbHBfdXJsID0gWUVMUF9CQVNFX1VSTCArICdidXNpbmVzcy8nICsgc2VsZi5zZWxlY3RlZF9wbGFjZSgpLlllbHAuYnVzaW5lc3NfaWQ7XG5cbi8vICAgICB2YXIgcGFyYW1ldGVycyA9IHtcbi8vICAgICAgIG9hdXRoX2NvbnN1bWVyX2tleTogWUVMUF9LRVksXG4vLyAgICAgICBvYXV0aF90b2tlbjogWUVMUF9UT0tFTixcbi8vICAgICAgIG9hdXRoX25vbmNlOiBub25jZV9nZW5lcmF0ZSgpLFxuLy8gICAgICAgb2F1dGhfdGltZXN0YW1wOiBNYXRoLmZsb29yKERhdGUubm93KCkvMTAwMCksXG4vLyAgICAgICBvYXV0aF9zaWduYXR1cmVfbWV0aG9kOiAnSE1BQy1TSEExJyxcbi8vICAgICAgIG9hdXRoX3ZlcnNpb24gOiAnMS4wJyxcbi8vICAgICAgIGNhbGxiYWNrOiAnY2InICAgICAgICAgICAgICAvLyBUaGlzIGlzIGNydWNpYWwgdG8gaW5jbHVkZSBmb3IganNvbnAgaW1wbGVtZW50YXRpb24gaW4gQUpBWCBvciBlbHNlIHRoZSBvYXV0aC1zaWduYXR1cmUgd2lsbCBiZSB3cm9uZy5cbi8vICAgICB9O1xuXG4vLyAgICAgdmFyIGVuY29kZWRTaWduYXR1cmUgPSBvYXV0aFNpZ25hdHVyZS5nZW5lcmF0ZSgnR0VUJyx5ZWxwX3VybCwgcGFyYW1ldGVycywgWUVMUF9LRVlfU0VDUkVULCBZRUxQX1RPS0VOX1NFQ1JFVCk7XG4vLyAgICAgcGFyYW1ldGVycy5vYXV0aF9zaWduYXR1cmUgPSBlbmNvZGVkU2lnbmF0dXJlO1xuXG4vLyAgICAgdmFyIHNldHRpbmdzID0ge1xuLy8gICAgICAgdXJsOiB5ZWxwX3VybCxcbi8vICAgICAgIGRhdGE6IHBhcmFtZXRlcnMsXG4vLyAgICAgICBjYWNoZTogdHJ1ZSwgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBjcnVjaWFsIHRvIGluY2x1ZGUgYXMgd2VsbCB0byBwcmV2ZW50IGpRdWVyeSBmcm9tIGFkZGluZyBvbiBhIGNhY2hlLWJ1c3RlciBwYXJhbWV0ZXIgXCJfPTIzNDg5NDg5NzQ5ODM3XCIsIGludmFsaWRhdGluZyBvdXIgb2F1dGgtc2lnbmF0dXJlXG4vLyAgICAgICBkYXRhVHlwZTogJ2pzb25wJyxcbi8vICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdHMpIHtcbi8vICAgICAgICAgLy8gRG8gc3R1ZmYgd2l0aCByZXN1bHRzXG4vLyAgICAgICB9LFxuLy8gICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAvLyBEbyBzdHVmZiBvbiBmYWlsXG4vLyAgICAgICB9XG4vLyAgICAgfTtcblxuLy8gICAgIC8vIFNlbmQgQUpBWCBxdWVyeSB2aWEgalF1ZXJ5IGxpYnJhcnkuXG4vLyAgICAgJC5hamF4KHNldHRpbmdzKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL01BUCBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIG1hcDtcbnZhciB2bVNwb3RzID0gW107XG52YXIgaW5mb3dpbmRvdztcblxudmFyIFJlZFJvYWRzTkdyZWVuQnVzU3RvcHMgPSBbXG4gIHtcbiAgICBcImZlYXR1cmVUeXBlXCI6IFwicG9pXCIsXG4gICAgXCJlbGVtZW50VHlwZVwiOiBcImxhYmVsc1wiLFxuICAgIFwic3R5bGVyc1wiOiBbXG4gICAgICAgIHsgdmlzaWJpbGl0eTogXCJvZmZcIiB9XG4gICAgXVxuICB9LFxuICB7XG4gICAgXCJmZWF0dXJlVHlwZVwiOiBcInJvYWRcIixcbiAgICBcInN0eWxlcnNcIjogW1xuICAgICAgeyBcImdhbW1hXCI6IDAuNjUgfSxcbiAgICAgIHsgXCJodWVcIjogXCIjZmY5YzMwXCIgfSxcbiAgICAgIHsgXCJ2aXNpYmlsaXR5XCI6IFwib25cIiB9LFxuICAgICAgeyBcInNhdHVyYXRpb25cIjogOTkgfSxcbiAgICAgIHsgXCJsaWdodG5lc3NcIjogLTEyIH1cbiAgICBdXG4gIH0se1xuICAgIFwiZmVhdHVyZVR5cGVcIjogXCJ0cmFuc2l0XCIsXG4gICAgXCJzdHlsZXJzXCI6IFtcbiAgICAgIHsgXCJodWVcIjogXCIjMDBmZjMzXCIgfSxcbiAgICAgIHsgXCJnYW1tYVwiOiAwLjYwIH0sXG4gICAgICB7IFwic2F0dXJhdGlvblwiOiA1IH0sXG4gICAgICB7IFwidmlzaWJpbGl0eVwiOiBcIm9uXCIgfSxcbiAgICAgIHsgXCJ3ZWlnaHRcIjogNC42IH0sXG4gICAgICB7IFwibGlnaHRuZXNzXCI6IC0xMiB9IC8vd2FzIC0yMlxuICAgIF1cbiAgfVxuXTtcblxudmFyIG1hcE9wdGlvbnMgPSB7XG4gICAgICAgIGNlbnRlcjoge2xhdDogNDkuMjYyMzg3LCBsbmc6IC0xMjMuMDY5NzY4fSwvLzQ5LjI2MjM4NywgLTEyMy4wNjk3NjhcbiAgICAgICAgLy8gQ29tbWVyY2lhbCBCcm9hZHdheSBTdGF0aW9uIDQ5wrAxNeKAsjQ14oCzTiwgMTIzwrAwNOKAsjA44oCzV1xuICAgICAgICB6b29tOiAxNixcbiAgICAgICAgem9vbUNvbnRyb2w6IHRydWUsXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZSxcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgICBkaXNhYmxlRG91YmxlQ2xpY2tab29tOiB0cnVlLFxuICAgICAgICBkaXNhYmxlRGVmYXVsdFVJOiB0cnVlLFxuICAgICAgICBzdHlsZXM6IFJlZFJvYWRzTkdyZWVuQnVzU3RvcHNcbiAgICB9O1xuXG4vLyBpbnZva2VkIGJ5IG1hcCA8c2NyaXB0PiBpbiBpbmRleC5odG1sXG5mdW5jdGlvbiBpbml0KCkge1xuICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1kaXYnKSwgbWFwT3B0aW9ucyApO1xuICAgIG1vZGVsID0gZ2V0TW9kZWwoKTsgLy8gbG9hZCBkYXRhIG9iamVjdCBlaXRoZXIgZnJvbSBsb2NhbFN0b3JhZ2Ugb3IgZmlsZVxuICAgIC8vIHRoZW4gYnVpbGQgdGhlIHNsaWRlIGNvbnRlbnQgd2l0aCBhamF4IGFwaSBjYWxscywgaWYgbmVjZXNzYXJ5XG4gICAgaWYgKCAobW9kZWwuc3BvdHNbMF0uc2xpZGVDb250ZW50ID09PSB1bmRlZmluZWQpIHx8XG4gICAgICAgICAobW9kZWwuc3BvdHNbMF0uc2xpZGVDb250ZW50LnNsaWNlKDAsNSkgPT0gXCJTb3JyeVwiKSkge1xuICAgICAgICAgICAgbW9kZWwuc3BvdHMuZm9yRWFjaCggZnVuY3Rpb24gKHNwb3QpIHtcbiAgICAgICAgICAgICAgICBidWlsZFNsaWRlQ29udGVudChzcG90KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHZpZXdNb2RlbC5zcG90TGlzdChtb2RlbC5zcG90cyk7XG4gICAgaW5mb3dpbmRvdyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KHt9KTtcbiAgICBtYXAuc2V0Wm9vbShtb2RlbC56b29tTGV2ZWwpO1xuICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICBtb2RlbC5zcG90cy5mb3JFYWNoKCBmdW5jdGlvbihzcG90KSB7XG4gICAgICAgIHZtU3BvdHMucHVzaChuZXcgU3BvdChzcG90KSk7XG4gICAgfSk7XG4gICAgLy8gc3RheSBjZW50cmVkXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICB9KTtcbiAgICB3aW5kb3cuc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5tb2RlbCA9IEpTT04uc3RyaW5naWZ5KG1vZGVsKTtcbiAgICB9LCAzMDAwKTtcbn1cblxuLy8gY29uc3RydWN0b3JcbnZhciBTcG90ID0gZnVuY3Rpb24oZGF0YSkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcbiAgdGhpcy5sb2NhdGlvbiA9IGRhdGEubG9jYXRpb247XG4gIHRoaXMuc2xpZGVDb250ZW50ID0gZGF0YS5zbGlkZUNvbnRlbnQ7XG4gIHRoaXMubWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgIHBvc2l0aW9uOiB0aGlzLmxvY2F0aW9uLFxuICAgICAgICB0aXRsZTogdGhpcy5uYW1lLFxuICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgb3BhY2l0eTogMC40XG4gIH0pO1xuICB0aGlzLndpbmRvd0NvbnRlbnQgPSBidWlsZFdpbmRvd0NvbnRlbnQodGhpcy5tYXJrZXIpO1xuICB0aGlzLmNsaWNrRXZlbnQgPSBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcmtlciwgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuZG9PcGVuaW5nKCk7XG4gICAgfSk7XG4gIHRoaXMub3ZlckV2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodGhpcy5tYXJrZXIsIFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhhdC5oaUxpZ2h0TGlzdEl0ZW0oKTtcblxuICB9KTtcbiAgdGhpcy5vdXRFdmVudCA9IGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHRoaXMubWFya2VyLCBcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhhdC5sb0xpZ2h0TGlzdEl0ZW0oKTtcblxuICB9KTtcbn07XG5cblNwb3QucHJvdG90eXBlLmhpTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuICAgIGNvbnNvbGUubG9nKFwid2UgY291bGQgaGktbGlnaHQgdGhlIFwiICsgdGhhdC5uYW1lICsgXCIgbGlzdCBpdGVtIG5vd1wiKTtcbiAgICAkKFwibGk6Y29udGFpbnMoXCIgKyB0aGF0Lm5hbWUgKyBcIilcIikudG9nZ2xlQ2xhc3MoIFwiaGlsaWdodCB1bmRlclwiICk7Ly8udG9nZ2xlQ2xhc3MoXCJoaWxpZ2h0XCIpO1xuXG5cbn07XG5cblNwb3QucHJvdG90eXBlLmxvTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgLy9jbGVhblVwU2NyZWVuKCk7XG4gICAgY29uc29sZS5sb2coXCJ3ZSBjb3VsZCBsby1saWdodCB0aGUgXCIgKyB0aGF0Lm5hbWUgKyBcIiBsaXN0IGl0ZW0gbm93XCIpO1xuICAgICQoXCJsaTpjb250YWlucyhcIiArIHRoYXQubmFtZSArIFwiKVwiKS50b2dnbGVDbGFzcyhcImhpbGlnaHQgdW5kZXJcIik7XG5cbn07XG5cblNwb3QucHJvdG90eXBlLmRvQm91bmNlID0gZnVuY3Rpb24gKCkgIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuICAgIHRoaXMubWFya2VyLnNldEFuaW1hdGlvbihnb29nbGUubWFwcy5BbmltYXRpb24uQk9VTkNFKTtcbiAgICAvLyB3aW5kb3cuc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIHRoYXQubWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgICAvLyB9LCAzMDAwKTtcbn07XG5cblNwb3QucHJvdG90eXBlLnN0b3BCb3VuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xufVxuXG5TcG90LnByb3RvdHlwZS5kb09wZW5pbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICB0aGlzLm1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XG4gICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGF0Lm9wZW5XaW5kb3coKTtcbiAgICAgICAgdGhhdC5tYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xuICAgIH0sIDEwMDApO1xufTtcblxuU3BvdC5wcm90b3R5cGUub3BlbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2aWV3TW9kZWwubGlzdENvbGxhcHNlKCk7XG4gICAgaW5mb3dpbmRvdy5zZXRDb250ZW50KHRoaXMud2luZG93Q29udGVudCk7XG4gICAgaW5mb3dpbmRvdy5vcGVuKG1hcCwgdGhpcy5tYXJrZXIpO1xufTtcblxuU3BvdC5wcm90b3R5cGUuaGlkZU1hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG51bGwpOyB9O1xuU3BvdC5wcm90b3R5cGUuc2hvd01hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG1hcCk7IH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9LTyBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbnZhciBWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gRGF0YVxuICAgIHNlbGYubGlzdE9uID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICBzZWxmLmJ1cmdlck1lbnUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNwb3RMaXN0ID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgc2VsZi5zbGlkZU9uID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zbGlkZUNvbnRlbnQgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgc2VsZi5maWx0ZXJTbG90ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuaXNTZWxlY3RlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuXG4gICAgLy8gQmVoYXZpb3Vyc1xuXG4gICAgc2VsZi5ib3VuY2VNYXJrZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJCb3VuY2V5LCBib3VuY2V5IFwiICsgdGhpcy5uYW1lKTtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3QuZG9Cb3VuY2UoKTtcbiAgICB9O1xuXG4gICAgc2VsZi51bmJvdW5jZU1hcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3Quc3RvcEJvdW5jZSgpO1xuICAgIH1cblxuICAgIHNlbGYuc3BvdFBpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3QuZG9PcGVuaW5nKCk7XG4gICAgfTtcbiAgICBzZWxmLnNldEZpbHRlclNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaXNTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICB9O1xuICAgIHNlbGYuZmlsdGVyU2xvdC5zdWJzY3JpYmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICAgICAgc2VsZi5zcG90TGlzdChmaWx0ZXJMaXN0KGRhdGEsIHZtU3BvdHMpKTtcbiAgICAgICAgcmVzZXRNYXJrZXJzKHNlbGYuc3BvdExpc3QoKSk7XG4gICAgfSk7XG4gICAgc2VsZi5vbkVudGVyID0gZnVuY3Rpb24gKGRhdGEsIGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgICAgICAgICAgaWYgKGluZm93aW5kb3cuYW5jaG9yKSB7XG4gICAgICAgICAgICAgICAgICBzZWxmLm9wZW5BUElzbGlkZShpbmZvd2luZG93LmFuY2hvci50aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5zcG90TGlzdCgpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNwb3RMaXN0KClbMF0uZG9PcGVuaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGluZm93aW5kb3cpIGluZm93aW5kb3cuY2xvc2UoKTsgLy9mb3IgYW55IG90aGVyIGtleXByZXNzXG4gICAgICAgICAgICBzZWxmLnNsaWRlT2ZmKCk7XG4gICAgICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gbmVjZXNzYXJ5IHRvIHJlZmxlY3QgdGhlIHRleHQgaW4gdGhlIHNsb3RcbiAgICB9O1xuICAgIHNlbGYubGlzdENvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2Rpc2FibGUgZm9yIGJpZyBzY3JlZW47IGVuYWJsZSBmb3Igc21hbGxcbiAgICAgICAgdmFyIG1lZGlhcXVlcnkgPSB3aW5kb3cubWF0Y2hNZWRpYSggXCIobWF4LXdpZHRoOiA1NDlweClcIiApO1xuICAgICAgICBpZiAobWVkaWFxdWVyeS5tYXRjaGVzKSB7XG4gICAgICAgICAgICBzZWxmLmxpc3RPbihmYWxzZSk7XG4gICAgICAgICAgICBzZWxmLmJ1cmdlck1lbnUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHNlbGYubGlzdEV4cGFuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICAgICBzZWxmLmJ1cmdlck1lbnUoZmFsc2UpO1xuICAgICAgICBzZWxmLmxpc3RPbih0cnVlKTtcbiAgICB9O1xuICAgIHNlbGYub3BlbkFQSXNsaWRlID0gZnVuY3Rpb24gKHNwb3ROYW1lKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdChzcG90TmFtZSk7XG4gICAgICAgIGlmICghKHNwb3Quc2xpZGVDb250ZW50KSkge1xuICAgICAgICAgICAgZHViU2xpZGVDb250ZW50cygpO1xuICAgICAgICB9XG4gICAgICAgIHZpZXdNb2RlbC5zbGlkZUNvbnRlbnQoc3BvdC5zbGlkZUNvbnRlbnQpO1xuICAgICAgICB2aWV3TW9kZWwuc2xpZGVPbih0cnVlKTtcbiAgICB9O1xuICAgIHNlbGYuc2xpZGVPZmYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2xpZGVPbihmYWxzZSk7XG4gICAgfTtcbn07XG5cbnZhciB2aWV3TW9kZWwgPSBuZXcgVmlld01vZGVsKCk7XG5rby5hcHBseUJpbmRpbmdzKHZpZXdNb2RlbCk7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tSEVMUEVSIEZVTkNUSU9OUy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9cbi8vdGVzdCBhcnJheSBhZ2FpbnN0IGEgcmVndWxhciBleHByZXNzaW9uXG5mdW5jdGlvbiBmaWx0ZXJMaXN0KHVzZXJUZXh0LCBtb2RlbEFycmF5KSB7XG4gICAgIHZhciByZXN1bHQ9W10sXG4gICAgICAgICByZSA9IG5ldyBSZWdFeHAodXNlclRleHQsIFsnaSddKTtcbiAgICAgbW9kZWxBcnJheS5mb3JFYWNoKCBmdW5jdGlvbihlbGVtZW50LCBpbmRleCwgYXJyYXkpIHtcbiAgICAgICAgaWYgKHJlLnRlc3QoZWxlbWVudC5uYW1lKSkgcmVzdWx0LnB1c2goZWxlbWVudCk7XG4gICAgIH0pO1xuICAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBnZXRTcG90KG5hbWUpIHtcbiAgICB2YXIgcmVzdWx0O1xuICAgIHZtU3BvdHMuZm9yRWFjaCggZnVuY3Rpb24oc3BvdCkge1xuICAgICAgIGlmIChzcG90Lm5hbWUgPT0gbmFtZSkgcmVzdWx0ID0gc3BvdDtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG4vLyBlZGl0IHRoZSBzZXQgb2YgZGlzcGxheWVkIG1hcmtlcnMgYmFzZWQgb24gdGhlIGZpbHRlcmVkIHNwb3RMaXN0XG5mdW5jdGlvbiByZXNldE1hcmtlcnMoc3BvdHMpIHtcbiAgICB2bVNwb3RzLmZvckVhY2goZnVuY3Rpb24oc3BvdCkge1xuICAgICAgICBzcG90LmhpZGVNYXJrZXIoKTtcbiAgICB9KTtcbiAgICBzcG90cy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgZ2V0U3BvdChpdGVtLm5hbWUpLnNob3dNYXJrZXIoKTtcbiAgICB9KTtcbn1cblxuLy8gY2FsbGVkIGluIHRoZSBjbGljayBldmVudCBsaXN0ZW5lciBvZiBpbmZvV2luZG93XG5mdW5jdGlvbiBpdGNod2luZG93KCkge1xuICAgIHZpZXdNb2RlbC5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xufVxuXG4vLyBnZXQgcmlkIG9mIG9sZCBvdmVyLWxheXNcbmZ1bmN0aW9uIGNsZWFuVXBTY3JlZW4oKSB7XG4gICAgaW5mb3dpbmRvdy5jbG9zZSgpO1xuICAgIG1hcC5zZXRab29tKG1vZGVsLnpvb21MZXZlbCk7XG4gICAgbWFwLnNldENlbnRlcihtb2RlbC5jZW50ZXIpO1xuICAgIHZpZXdNb2RlbC5zbGlkZU9mZigpO1xufVxuXG5mdW5jdGlvbiBkdWJTbGlkZUNvbnRlbnRzKCkge1xuICAgIGlmIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQpIHtcbiAgICAgICAgZm9yICh2YXIgaSBpbiBtb2RlbC5zcG90cykge1xuICAgICAgICAgICAgdm1TcG90c1tpXS5zbGlkZUNvbnRlbnQgPSBtb2RlbC5zcG90c1tpXS5zbGlkZUNvbnRlbnQ7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UubW9kZWwgPSBKU09OLnN0cmluZ2lmeShtb2RlbCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuXG5cblxuLy89PT09PT09PT09PT09PT09PT09VEhFIEVORD09PT09PT09PT09PT09PT09PT1cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuLy9mcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLmZvdXJzcXVhcmUuY29tL292ZXJ2aWV3L2F1dGgjdXNlcmxlc3Ncbi8vaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL3NlYXJjaD9sbD00MC43LC03NCZjbGllbnRfaWQ9Q0xJRU5UX0lEJmNsaWVudF9zZWNyZXQ9Q0xJRU5UX1NFQ1JFVCZ2PVlZWVlNTUREXG5cbi8vZm91cnNxdWFyZS5jb20vdi9icm9hZHdheS1zdGF0aW9uLXN1c2hpLzRhYWU5Y2I3Zjk2NGE1MjA5YjYyMjBlM1xudmFyIGtyID0ge1xuICAgIGZvdXJzcXVhcmU6IHtcbiAgICAgICAgT3duZXI6IFwiS1IgRGVja2VyXCIsXG4gICAgICAgIENsaWVudF9pZDogXCJaVkxLVEtTR1VMRkVRM1hNV1dJM0FMMUEyS1hZQkVLRDFMS1NVUlVaREdaWTQxSlhcIixcbiAgICAgICAgQ2xpZW50X3NlY3JldDogXCJUTVQyMDNESFdPUFIzUjRSU00xSEU0Uk1PS0VXTEdUVDBGTE1aTVVaMU9KSE1BSzFcIlxuICAgIH0sXG4gICAgeWVscDoge1xuICAgICAgICBDb25zdW1lcl9LZXk6ICAgIFwiWHJ4Sk9VZ0dOS3E5WnVXaEJYMUxEd1wiLFxuICAgICAgICBDb25zdW1lcl9TZWNyZXQ6IFwienIySTc2blQ4bDBPLXRya3VwWUUwMEI5QlRBXCIsXG4gICAgICAgIFRva2VuOiAgIFwiLV9GOGFPeG9uUjZxNVNxdlVSd3dnTElkVS1xdGVTLUJcIixcbiAgICAgICAgVG9rZW5fU2VjcmV0OiAgICBcIkdGN3VSY1BXQ3B6bEhjUlAzRGlKV2p2Y1hKRVwiXG4gICAgfSxcbiAgICBzdHJlZXR2aWV3OiB7XG4gICAgICAgIGtleTogXCJBSXphU3lBUDYzMXo2V3FNb3B0b2FHaGVyaEpWQkd5TjF1UEhQdDRcIlxuICAgIH1cbn07XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
