"use strict";function getModel(){return localStorage.model?JSON.parse(localStorage.model):EatsModel}function buildWindowContent(e){var t="http://maps.googleapis.com/maps/api/streetview?size=200x150&location="+e.position.toString().slice(1,-1),o='<img class="bgimg" src="'+t+'">',n='"height:100%;width:80%"',i='<div onclick="itchwindow()" style='+n+">"+o+'<br><span style="color:darkgreen">'+e.title+'</span><br><span style="color:red">-CLICK FOR MORE INFO-</span></div>';return i}function buildSlideContent(e){function t(t,i){console.log("In getVenueInfo: status = "+i);var a=t.response.venues[0];$.ajax({url:fourSquareURL+"/v2/venues/"+a.id,dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:o,error:n})}function o(t){var o=t.response.venue;i="FourSquare info: <br><br>"+o.name+"<br>"+o.contact.formattedPhone+"<br>- "+o.location.address+"<br>- "+o.location.city+"<br>- "+o.location.country+"<br>x-street: "+o.location.crossStreet+"<br>Check-ins: "+o.stats.checkinsCount.toString()+"<br>"+o.likes.summary+'<br><br><span style="background-color:#'+o.ratingColor+';color:black;padding:1%">Rating: '+o.rating.toString()+'</span><br><img src="'+o.bestPhoto.prefix+"cap300"+o.bestPhoto.suffix+'">',updateSlideContent(e,i)}function n(t,o,n){var i="Sorry. 3rd party info unavailable.";updateSlideContent(e,i)}var i="",s="ll="+e.location.lat.toString()+","+e.location.lng.toString();$.ajax({url:fourSquareURL+"/v2/venues/search",dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:t,error:n})}function updateSlideContent(e,t){e.slideContent=t;var o=getSpot(e.name);o&&(console.log("in updateSlideContent: viewSpot "),o.slideContent=t)}function init(){map=new google.maps.Map(document.getElementById("map-div"),mapOptions),model=getModel(),(void 0===model.spots[0].slideContent||"Sorry"==model.spots[0].slideContent.slice(0,5))&&model.spots.forEach(function(e){buildSlideContent(e)}),viewModel.spotList(model.spots),infowindow=new google.maps.InfoWindow({}),map.setZoom(model.zoomLevel),map.setCenter(model.center),model.spots.forEach(function(e){vmSpots.push(new Spot(e))}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(model.center)}),window.setTimeout(function(){localStorage.model=JSON.stringify(model)},3e3)}function filterList(e,t){var o=[],n=new RegExp(e,["i"]);return t.forEach(function(e,t,i){n.test(e.name)&&o.push(e)}),o}function getSpot(e){var t;return vmSpots.forEach(function(o){o.name==e&&(t=o)}),t}function resetMarkers(e){vmSpots.forEach(function(e){e.hideMarker()}),e.forEach(function(e){getSpot(e.name).showMarker()})}function itchwindow(){viewModel.openAPIslide(infowindow.anchor.title)}function cleanUpScreen(){infowindow.close(),map.setZoom(model.zoomLevel),map.setCenter(model.center),viewModel.slideOff()}function dubSlideContents(){if(model.spots[0].slideContent)for(var e in model.spots)vmSpots[e].slideContent=model.spots[e].slideContent,localStorage.model=JSON.stringify(model)}var EatsModel={zoomLevel:18,center:{lat:49.262387,lng:-123.069768},spots:[{name:"Uncle Fatih's Pizza",location:{lat:49.262487,lng:-123.07}},{name:"Buddha's Orient Express",location:{lat:49.262719,lng:-123.069289}},{name:"Booster Juice",location:{lat:49.262641,lng:-123.069438}},{name:"Starbucks Coffee",location:{lat:49.261874,lng:-123.070176}},{name:"Blenz Coffee",location:{lat:49.262534,lng:-123.069529}},{name:"Megabite Pizza",location:{lat:49.262779,lng:-123.069317}},{name:"Broadway Station Sushi",location:{lat:49.262084,lng:-123.070962}}]},model={},fourSquareURL="https://api.foursquare.com",map,vmSpots=[],infowindow,RedRoadsNGreenBusStops=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{gamma:.65},{hue:"#ff9c30"},{visibility:"on"},{saturation:99},{lightness:-12}]},{featureType:"transit",stylers:[{hue:"#00ff33"},{gamma:.6},{saturation:5},{visibility:"on"},{weight:4.6},{lightness:-12}]}],mapOptions={center:{lat:49.262387,lng:-123.069768},zoom:16,zoomControl:!0,scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,disableDefaultUI:!0,styles:RedRoadsNGreenBusStops},Spot=function(e){var t=this;this.name=e.name,this.location=e.location,this.slideContent=e.slideContent,this.marker=new google.maps.Marker({position:this.location,title:this.name,map:map,opacity:.4}),this.windowContent=buildWindowContent(this.marker),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(){t.doOpening()}),this.overEvent=google.maps.event.addListener(this.marker,"mouseover",function(){console.log("we could hi-light the "+t.name+" list item now")}),this.outEvent=google.maps.event.addListener(this.marker,"mouseout",function(){console.log("we could lo-light the "+t.name+" list item now")})};Spot.prototype.hiLightListItem=function(){cleanUpScreen()},Spot.prototype.doOpening=function(){var e=this;cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.openWindow(),e.marker.setAnimation(null)},1e3)},Spot.prototype.openWindow=function(){viewModel.listCollapse(),infowindow.setContent(this.windowContent),infowindow.open(map,this.marker)},Spot.prototype.hideMarker=function(){this.marker.setMap(null)},Spot.prototype.showMarker=function(){this.marker.setMap(map)};var ViewModel=function(){var e=this;e.listOn=ko.observable(!0),e.burgerMenu=ko.observable(!1),e.spotList=ko.observableArray(),e.slideOn=ko.observable(!1),e.slideContent=ko.observable(),e.filterSlot=ko.observable(),e.isSelected=ko.observable(!1),e.spotPick=function(){var e=getSpot(this.name);e.doOpening()},e.setFilterSelected=function(){this.isSelected(!0),cleanUpScreen(),e.listExpand()},e.filterSlot.subscribe(function(t){e.listExpand(),e.spotList(filterList(t,vmSpots)),resetMarkers(e.spotList())}),e.onEnter=function(t,o){return 13===o.keyCode?infowindow.anchor?e.openAPIslide(infowindow.anchor.title):1===e.spotList().length&&e.spotList()[0].doOpening():(infowindow&&infowindow.close(),e.slideOff(),e.listExpand()),!0},e.listCollapse=function(){var t=window.matchMedia("(max-width: 549px)");t.matches&&(e.listOn(!1),e.burgerMenu(!0))},e.listExpand=function(){cleanUpScreen(),e.burgerMenu(!1),e.listOn(!0)},e.openAPIslide=function(e){var t=getSpot(e);t.slideContent||dubSlideContents(),viewModel.slideContent(t.slideContent),viewModel.slideOn(!0)},e.slideOff=function(){this.slideOn(!1)}},viewModel=new ViewModel;ko.applyBindings(viewModel);var kr={foursquare:{Owner:"KR Decker",Client_id:"ZVLKTKSGULFEQ3XMWWI3AL1A2KXYBEKD1LKSURUZDGZY41JX",Client_secret:"TMT203DHWOPR3R4RSM1HE4RMOKEWLGTT0FLMZMUZ1OJHMAK1"},yelp:{Consumer_Key:"XrxJOUgGNKq9ZuWhBX1LDw",Consumer_Secret:"zr2I76nT8l0O-trkupYE00B9BTA",Token:"-_F8aOxonR6q5SqvURwwgLIdU-qteS-B",Token_Secret:"GF7uRcPWCpzlHcRP3DiJWjvcXJE"},streetview:{key:"AIzaSyAP631z6WqMoptoaGherhJVBGyN1uPHPt4"}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnZXRNb2RlbCIsImxvY2FsU3RvcmFnZSIsIm1vZGVsIiwiSlNPTiIsInBhcnNlIiwiRWF0c01vZGVsIiwiYnVpbGRXaW5kb3dDb250ZW50IiwibWFya2VyIiwic3RyZWV0dmlld1VybCIsInBvc2l0aW9uIiwidG9TdHJpbmciLCJzbGljZSIsInBpY3R1cmUiLCJjc3MiLCJjb250ZW50IiwidGl0bGUiLCJidWlsZFNsaWRlQ29udGVudCIsInNwb3QiLCJnZXRWZW51ZUluZm8iLCJkYXRhIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInZlbnVlIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCIkIiwiYWpheCIsInVybCIsImZvdXJTcXVhcmVVUkwiLCJpZCIsImRhdGFUeXBlIiwibG9jIiwibmFtZSIsImtyIiwiZm91cnNxdWFyZSIsIkNsaWVudF9pZCIsIkNsaWVudF9zZWNyZXQiLCJhc3luYyIsInN1Y2Nlc3MiLCJmb3JtYXRTaG93RGF0YSIsImVycm9yIiwic2VuZEVycm9yIiwiZm9ybWF0dGVkRGF0YSIsImNvbnRhY3QiLCJmb3JtYXR0ZWRQaG9uZSIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiY3Jvc3NTdHJlZXQiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJsaWtlcyIsInN1bW1hcnkiLCJyYXRpbmdDb2xvciIsInJhdGluZyIsImJlc3RQaG90byIsInByZWZpeCIsInN1ZmZpeCIsInVwZGF0ZVNsaWRlQ29udGVudCIsIm9iamVjdCIsImV4Y2VwdGlvbiIsImFqYXhfZXJyb3IiLCJsYXQiLCJsbmciLCJkYXRhU3RyaW5nIiwic2xpZGVDb250ZW50Iiwidm1TcG90IiwiZ2V0U3BvdCIsImluaXQiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1hcE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzcG90cyIsImZvckVhY2giLCJ2aWV3TW9kZWwiLCJzcG90TGlzdCIsImluZm93aW5kb3ciLCJJbmZvV2luZG93Iiwic2V0Wm9vbSIsInpvb21MZXZlbCIsInNldENlbnRlciIsImNlbnRlciIsInZtU3BvdHMiLCJwdXNoIiwiU3BvdCIsImV2ZW50IiwiYWRkRG9tTGlzdGVuZXIiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0Iiwic3RyaW5naWZ5IiwiZmlsdGVyTGlzdCIsInVzZXJUZXh0IiwibW9kZWxBcnJheSIsInJlc3VsdCIsInJlIiwiUmVnRXhwIiwiZWxlbWVudCIsImluZGV4IiwiYXJyYXkiLCJ0ZXN0IiwicmVzZXRNYXJrZXJzIiwiaGlkZU1hcmtlciIsIml0ZW0iLCJzaG93TWFya2VyIiwiaXRjaHdpbmRvdyIsIm9wZW5BUElzbGlkZSIsImFuY2hvciIsImNsZWFuVXBTY3JlZW4iLCJjbG9zZSIsInNsaWRlT2ZmIiwiZHViU2xpZGVDb250ZW50cyIsImkiLCJSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzIiwiZmVhdHVyZVR5cGUiLCJlbGVtZW50VHlwZSIsInN0eWxlcnMiLCJ2aXNpYmlsaXR5IiwiZ2FtbWEiLCJodWUiLCJzYXR1cmF0aW9uIiwibGlnaHRuZXNzIiwid2VpZ2h0Iiwiem9vbSIsInpvb21Db250cm9sIiwic2Nyb2xsd2hlZWwiLCJkcmFnZ2FibGUiLCJkaXNhYmxlRG91YmxlQ2xpY2tab29tIiwiZGlzYWJsZURlZmF1bHRVSSIsInN0eWxlcyIsInRoYXQiLCJ0aGlzIiwiTWFya2VyIiwib3BhY2l0eSIsIndpbmRvd0NvbnRlbnQiLCJjbGlja0V2ZW50IiwiYWRkTGlzdGVuZXIiLCJkb09wZW5pbmciLCJvdmVyRXZlbnQiLCJvdXRFdmVudCIsInByb3RvdHlwZSIsImhpTGlnaHRMaXN0SXRlbSIsInNldEFuaW1hdGlvbiIsIkFuaW1hdGlvbiIsIkJPVU5DRSIsIm9wZW5XaW5kb3ciLCJsaXN0Q29sbGFwc2UiLCJzZXRDb250ZW50Iiwib3BlbiIsInNldE1hcCIsIlZpZXdNb2RlbCIsInNlbGYiLCJsaXN0T24iLCJrbyIsIm9ic2VydmFibGUiLCJidXJnZXJNZW51Iiwib2JzZXJ2YWJsZUFycmF5Iiwic2xpZGVPbiIsImZpbHRlclNsb3QiLCJpc1NlbGVjdGVkIiwic3BvdFBpY2siLCJzZXRGaWx0ZXJTZWxlY3RlZCIsImxpc3RFeHBhbmQiLCJzdWJzY3JpYmUiLCJvbkVudGVyIiwia2V5Q29kZSIsImxlbmd0aCIsIm1lZGlhcXVlcnkiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsInNwb3ROYW1lIiwiYXBwbHlCaW5kaW5ncyIsIk93bmVyIiwieWVscCIsIkNvbnN1bWVyX0tleSIsIkNvbnN1bWVyX1NlY3JldCIsIlRva2VuIiwiVG9rZW5fU2VjcmV0Iiwic3RyZWV0dmlldyIsImtleSJdLCJtYXBwaW5ncyI6IkFBQUEsWUE4Q0EsU0FBU0EsWUFDTCxNQUFJQyxjQUFhQyxNQUNOQyxLQUFLQyxNQUFNSCxhQUFhQyxPQUV4QkcsVUFLZixRQUFTQyxvQkFBbUJDLEdBQ3hCLEdBQUlDLEdBQWdCLHdFQUNJRCxFQUFPRSxTQUFTQyxXQUFXQyxNQUFNLEVBQUUsSUFJdkRDLEVBQVUsMkJBQTZCSixFQUFnQixLQUN2REssRUFBTSwwQkFDTkMsRUFBVSxxQ0FDRUQsRUFBTSxJQUFNRCxFQUFVLHFDQUN0QkwsRUFBT1EsTUFBUSx1RUFHL0IsT0FBT0QsR0FVWCxRQUFTRSxtQkFBa0JDLEdBdUJ2QixRQUFTQyxHQUFhQyxFQUFNQyxHQUN4QkMsUUFBUUMsSUFBSSw2QkFBK0JGLEVBQzNDLElBQUlHLEdBQVFKLEVBQUtLLFNBQVNDLE9BQU8sRUFFakNDLEdBQUVDLE1BQ0VDLElBQUtDLGNBQWdCLGNBQWdCTixFQUFNTyxHQUMzQ0MsU0FBVSxPQUNWWixLQUFNLFdBQ1FhLEVBQ04sVUFBWWYsRUFBS2dCLEtBQ2pCLGNBQWVDLEdBQUdDLFdBQVdDLFVBQzdCLGtCQUFtQkYsR0FBR0MsV0FBV0UsY0FDakMsY0FDUkMsT0FBTyxFQUNQQyxRQUFTQyxFQUNUQyxNQUFPQyxJQU1mLFFBQVNGLEdBQWVyQixHQUNwQixHQUFJSSxHQUFRSixFQUFLSyxTQUFTRCxL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Q0EyQyxFQUFLSSxZQUFXLEdBQ2hCSixFQUFLQyxRQUFPLElBRWhCRCxFQUFLN0MsYUFBZSxTQUFVZ0UsR0FDMUIsR0FBSS9KLEdBQU9vRCxRQUFRMkcsRUFDYi9KLEdBQWlCLGNBQ25Cb0csbUJBRUpwQyxVQUFVZCxhQUFhbEQsRUFBS2tELGNBQzVCYyxVQUFVa0YsU0FBUSxJQUV0Qk4sRUFBS3pDLFNBQVcsV0FDWnFCLEtBQUswQixTQUFRLEtBSWpCbEYsVUFBWSxHQUFJMkUsVUFDcEJHLElBQUdrQixjQUFjaEcsVUEySWpCLElBQUkvQyxLQUNBQyxZQUNJK0ksTUFBTyxZQUNQOUksVUFBVyxtREFDWEMsY0FBZSxvREFFbkI4SSxNQUNJQyxhQUFpQix5QkFDakJDLGdCQUFpQiw4QkFDakJDLE1BQVMsbUNBQ1RDLGFBQWlCLCtCQUVyQkMsWUFDSUMsSUFBSyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9NT0RFTC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLy8gZWF0cyBkYXRhOiBhbiBhcnJheSBvZiBwbGFjZXMgdG8gZWF0XG4vLyBhcm91bmQgQ29tbWVyY2lhbC1Ccm9hZHdheSBTdGF0aW9uXG4vLyBFYXN0IFZhblxuLy8gQnJpdGlzaCBDb2x1bWJpYVxuXG4vLyBiYXNpYyBkYXRhLCBsb2FkZWQgaWYgbW9yZSBkZXRhaWxlZCBtb2RlbCBub3QgZm91bmQgaW4gbG9jYWxTdG9yYWdlXG52YXIgRWF0c01vZGVsID0ge1xuICAgIHpvb21MZXZlbDogMTgsXG4gICAgY2VudGVyOiB7bGF0OiA0OS4yNjIzODcsIGxuZzogLTEyMy4wNjk3Njh9LC8vNDkuMjYyMzg3LCAtMTIzLjA2OTc2OFxuICAgIHNwb3RzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiVW5jbGUgRmF0aWgncyBQaXp6YVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjQ4NywgbG5nOiAtMTIzLjA3MDAwMH0gLy93YXMgLjI2MjUxNyAuMDcwMTc3XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQnVkZGhhJ3MgT3JpZW50IEV4cHJlc3NcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI3MTksIGxuZzogLTEyMy4wNjkyODl9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQm9vc3RlciBKdWljZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjY0MSwgbG5nOiAtMTIzLjA2OTQzOH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJTdGFyYnVja3MgQ29mZmVlXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYxODc0LCBsbmc6IC0xMjMuMDcwMTc2fVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJsZW56IENvZmZlZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjUzNCwgbG5nOiAtMTIzLjA2OTUyOX1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJNZWdhYml0ZSBQaXp6YVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2Mjc3OSwgbG5nOiAtMTIzLjA2OTMxN31cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCcm9hZHdheSBTdGF0aW9uIFN1c2hpXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyMDg0LCBsbmc6IC0xMjMuMDcwOTYyfVxuICAgICAgICB9XG4gICAgXVxufTtcblxudmFyIG1vZGVsID0ge307XG5cbmZ1bmN0aW9uIGdldE1vZGVsKCkge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UubW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLm1vZGVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gRWF0c01vZGVsO1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBidWlsZFdpbmRvd0NvbnRlbnQobWFya2VyKSB7XG4gICAgdmFyIHN0cmVldHZpZXdVcmwgPSAnaHR0cDovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvc3RyZWV0dmlldz9zaXplPTIwMHgxNTAmbG9jYXRpb249JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyLnBvc2l0aW9uLnRvU3RyaW5nKCkuc2xpY2UoMSwtMSkgOy8vICsgJyZrZXk9JyArIGtyLnN0cmVldHZpZXcua2V5O1xuICAgIC8vIG1hcmtlci5wb3NpdGlvbi50b1N0cmluZygpIG1ldGhvZCBjaGFuZ2VkIHRvIGluY2x1ZGUgcGFyZW50aGVzZXMsIGhlbmNlIHRoZSBzbGljZVxuICAgIC8vIGtleSBub3QgcmVxdWlyZWRcblxuICAgIHZhciBwaWN0dXJlID0gJzxpbWcgY2xhc3M9XCJiZ2ltZ1wiIHNyYz1cIicgKyBzdHJlZXR2aWV3VXJsICsgJ1wiPic7XG4gICAgdmFyIGNzcyA9ICdcImhlaWdodDoxMDAlO3dpZHRoOjgwJVwiJztcbiAgICB2YXIgY29udGVudCA9ICc8ZGl2IG9uY2xpY2s9XCJpdGNod2luZG93KClcIiBzdHlsZT0nICtcbiAgICAgICAgICAgICAgICAgICAgY3NzICsgJz4nICsgcGljdHVyZSArICc8YnI+PHNwYW4gc3R5bGU9XCJjb2xvcjpkYXJrZ3JlZW5cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyLnRpdGxlICsgJzwvc3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxicj48c3BhbiBzdHlsZT1cImNvbG9yOnJlZFwiPi1DTElDSyBGT1IgTU9SRSBJTkZPLTwvc3Bhbj48L2Rpdj4nO1xuXG4gICAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gM3JkIHBhcnR5IEFQSSBzdHVmZlxudmFyIGZvdXJTcXVhcmVVUkwgPSAnaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20nO1xuXG4vLyBnZXQgY29udGVudCBmb3IgaW5mbyBzbGlkZXMgZnJvbSAzcmQgcGFydHkgc291cmNlc1xuLy8gYmFzZWQgb24gaW5mbyBmcm9tIG1vZGVsXG4vLyB0aGVuIGFkZCB0byBtb2RlbCBhbmQgdG8gdmlldyBvYmplY3RzXG5mdW5jdGlvbiBidWlsZFNsaWRlQ29udGVudChzcG90KSB7XG4gICAgdmFyIGZvcm1hdHRlZERhdGEgPSBcIlwiO1xuICAgIHZhciBsb2MgPSBcImxsPVwiICsgc3BvdC5sb2NhdGlvbi5sYXQudG9TdHJpbmcoKSArIFwiLFwiICsgc3BvdC5sb2NhdGlvbi5sbmcudG9TdHJpbmcoKTtcbiAgICB2YXIgYWpheF9lcnJvcjtcblxuICAgIC8vIGdldCB0aGUgZm91cnNxdWFyZSBJRCBudW1iZXIgb2YgdGhlIHNwb3RcbiAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBmb3VyU3F1YXJlVVJMICsgJy92Mi92ZW51ZXMvc2VhcmNoJyxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBkYXRhOiAnbGltaXQ9MScgK1xuICAgICAgICAgICAgICAgICAgICAnJicgKyBsb2MgKyAnJnF1ZXJ5PScgKyBzcG90Lm5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9pZD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9pZCArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X3NlY3JldD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9zZWNyZXQgK1xuICAgICAgICAgICAgICAgICAgICAnJnY9MjAxNjAxMzAnLFxuICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBnZXRWZW51ZUluZm8sXG4gICAgICAgICAgICBlcnJvcjogc2VuZEVycm9yXG4gICAgfSk7Lyouc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgZ2V0VmVudWVJbmZvKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7Ki9cblxuICAgIC8vIGdpdmUgdGhlIHJlc3BvbnNlIG9uIHNwZWNpZmljIHZlbnVlIHRvIGFub3RoZXIgY2FsbCBmb3JcbiAgICAvLyBtb3JlIGRldGFpbGVkIGluZm9ybWF0aW9uXG4gICAgZnVuY3Rpb24gZ2V0VmVudWVJbmZvKGRhdGEsIHN0YXR1cykge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkluIGdldFZlbnVlSW5mbzogc3RhdHVzID0gXCIgKyBzdGF0dXMpO1xuICAgICAgICB2YXIgdmVudWUgPSBkYXRhLnJlc3BvbnNlLnZlbnVlc1swXTtcbiAgICAgICAgLy9odHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi92ZW51ZXMvVkVOVUVfSURcbiAgICAgICAgJC5hamF4KHsgLy8gdG8gZ2V0IHRoZSBkZXRhaWxlZCBmb3Vyc3F1YXJlIG9mIHRoZSAnY29tcGxldGUgdmVudWUnIGJhc2VkIG9uIElEXG4gICAgICAgICAgICB1cmw6IGZvdXJTcXVhcmVVUkwgKyAnL3YyL3ZlbnVlcy8nICsgdmVudWUuaWQsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgZGF0YTogJ2xpbWl0PTEnICtcbiAgICAgICAgICAgICAgICAgICAgJyYnICsgbG9jICtcbiAgICAgICAgICAgICAgICAgICAgJyZxdWVyeT0nICsgc3BvdC5uYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJyZjbGllbnRfaWQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfaWQgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9zZWNyZXQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfc2VjcmV0ICtcbiAgICAgICAgICAgICAgICAgICAgJyZ2PTIwMTYwMTMwJyxcbiAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgc3VjY2VzczogZm9ybWF0U2hvd0RhdGEsXG4gICAgICAgICAgICBlcnJvcjogc2VuZEVycm9yXG4gICAgICAgIH0pOy8qLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIGZvcm1hdFNob3dEYXRhKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pOyovXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZm9ybWF0U2hvd0RhdGEoZGF0YSl7XG4gICAgICAgIHZhciB2ZW51ZSA9IGRhdGEucmVzcG9uc2UudmVudWU7XG4gICAgICAgIGZvcm1hdHRlZERhdGEgPSAnRm91clNxdWFyZSBpbmZvOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8YnI+JyArICc8YnI+JyArIHZlbnVlLm5hbWUgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVudWUuY29udGFjdC5mb3JtYXR0ZWRQaG9uZSArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uYWRkcmVzcyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uY2l0eSAgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJy0gJyArIHZlbnVlLmxvY2F0aW9uLmNvdW50cnkgICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICd4LXN0cmVldDogJyArIHZlbnVlLmxvY2F0aW9uLmNyb3NzU3RyZWV0ICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDaGVjay1pbnM6ICcgKyB2ZW51ZS5zdGF0cy5jaGVja2luc0NvdW50LnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxicj4nICsgdmVudWUubGlrZXMuc3VtbWFyeSArICc8YnI+JyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiMnICsgdmVudWUucmF0aW5nQ29sb3IgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJztjb2xvcjpibGFjaztwYWRkaW5nOjElXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnUmF0aW5nOiAnICsgdmVudWUucmF0aW5nLnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIicgKyB2ZW51ZS5iZXN0UGhvdG8ucHJlZml4ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjYXAzMDAnICsgdmVudWUuYmVzdFBob3RvLnN1ZmZpeCArICdcIj4nXG4gICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgIC8vc3BvdC5zbGlkZUNvbnRlbnQgPSBmb3JtYXR0ZWREYXRhO1xuICAgICAgICB1cGRhdGVTbGlkZUNvbnRlbnQoc3BvdCwgZm9ybWF0dGVkRGF0YSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNlbmRFcnJvcihvYmplY3QsIGVycm9yLCBleGNlcHRpb24pIHtcbiAgICAgICAgdmFyIGFqYXhfZXJyb3IgPSBcIlNvcnJ5LiAzcmQgcGFydHkgaW5mbyB1bmF2YWlsYWJsZS5cIjtcbiAgICAgICAgdXBkYXRlU2xpZGVDb250ZW50KHNwb3QsIGFqYXhfZXJyb3IpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlU2xpZGVDb250ZW50KHNwb3QsIGRhdGFTdHJpbmcpIHtcbiAgICAvLyB1cGRhdGUgdGhlIG1vZGVsXG4gICAgc3BvdC5zbGlkZUNvbnRlbnQgPSBkYXRhU3RyaW5nO1xuICAgIC8vIHVwZGF0ZSB0aGUgdmlld1xuICAgIHZhciB2bVNwb3QgPSBnZXRTcG90KHNwb3QubmFtZSk7XG4gICAgaWYgKHZtU3BvdCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImluIHVwZGF0ZVNsaWRlQ29udGVudDogdmlld1Nwb3QgXCIpO1xuICAgICAgICB2bVNwb3Quc2xpZGVDb250ZW50ID0gZGF0YVN0cmluZztcbiAgICB9XG59XG5cbi8vIE1hcmtOJ3MgaW1wbGVtZW50YXRpb24gb2Zcbi8qKlxuICogR2VuZXJhdGVzIGEgcmFuZG9tIG51bWJlciBhbmQgcmV0dXJucyBpdCBhcyBhIHN0cmluZyBmb3IgT0F1dGhlbnRpY2F0aW9uXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKi9cbi8vIGZ1bmN0aW9uIG5vbmNlX2dlbmVyYXRlKCkge1xuLy8gICByZXR1cm4gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDFlMTIpLnRvU3RyaW5nKCkpO1xuLy8gfVxuXG4vLyB2YXIgeWVscF91cmwgPSBZRUxQX0JBU0VfVVJMICsgJ2J1c2luZXNzLycgKyBzZWxmLnNlbGVjdGVkX3BsYWNlKCkuWWVscC5idXNpbmVzc19pZDtcblxuLy8gICAgIHZhciBwYXJhbWV0ZXJzID0ge1xuLy8gICAgICAgb2F1dGhfY29uc3VtZXJfa2V5OiBZRUxQX0tFWSxcbi8vICAgICAgIG9hdXRoX3Rva2VuOiBZRUxQX1RPS0VOLFxuLy8gICAgICAgb2F1dGhfbm9uY2U6IG5vbmNlX2dlbmVyYXRlKCksXG4vLyAgICAgICBvYXV0aF90aW1lc3RhbXA6IE1hdGguZmxvb3IoRGF0ZS5ub3coKS8xMDAwKSxcbi8vICAgICAgIG9hdXRoX3NpZ25hdHVyZV9tZXRob2Q6ICdITUFDLVNIQTEnLFxuLy8gICAgICAgb2F1dGhfdmVyc2lvbiA6ICcxLjAnLFxuLy8gICAgICAgY2FsbGJhY2s6ICdjYicgICAgICAgICAgICAgIC8vIFRoaXMgaXMgY3J1Y2lhbCB0byBpbmNsdWRlIGZvciBqc29ucCBpbXBsZW1lbnRhdGlvbiBpbiBBSkFYIG9yIGVsc2UgdGhlIG9hdXRoLXNpZ25hdHVyZSB3aWxsIGJlIHdyb25nLlxuLy8gICAgIH07XG5cbi8vICAgICB2YXIgZW5jb2RlZFNpZ25hdHVyZSA9IG9hdXRoU2lnbmF0dXJlLmdlbmVyYXRlKCdHRVQnLHllbHBfdXJsLCBwYXJhbWV0ZXJzLCBZRUxQX0tFWV9TRUNSRVQsIFlFTFBfVE9LRU5fU0VDUkVUKTtcbi8vICAgICBwYXJhbWV0ZXJzLm9hdXRoX3NpZ25hdHVyZSA9IGVuY29kZWRTaWduYXR1cmU7XG5cbi8vICAgICB2YXIgc2V0dGluZ3MgPSB7XG4vLyAgICAgICB1cmw6IHllbHBfdXJsLFxuLy8gICAgICAgZGF0YTogcGFyYW1ldGVycyxcbi8vICAgICAgIGNhY2hlOiB0cnVlLCAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGNydWNpYWwgdG8gaW5jbHVkZSBhcyB3ZWxsIHRvIHByZXZlbnQgalF1ZXJ5IGZyb20gYWRkaW5nIG9uIGEgY2FjaGUtYnVzdGVyIHBhcmFtZXRlciBcIl89MjM0ODk0ODk3NDk4MzdcIiwgaW52YWxpZGF0aW5nIG91ciBvYXV0aC1zaWduYXR1cmVcbi8vICAgICAgIGRhdGFUeXBlOiAnanNvbnAnLFxuLy8gICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0cykge1xuLy8gICAgICAgICAvLyBEbyBzdHVmZiB3aXRoIHJlc3VsdHNcbi8vICAgICAgIH0sXG4vLyAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgIC8vIERvIHN0dWZmIG9uIGZhaWxcbi8vICAgICAgIH1cbi8vICAgICB9O1xuXG4vLyAgICAgLy8gU2VuZCBBSkFYIHF1ZXJ5IHZpYSBqUXVlcnkgbGlicmFyeS5cbi8vICAgICAkLmFqYXgoc2V0dGluZ3MpO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vTUFQIFZJRVdNT0RFTC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgbWFwO1xudmFyIHZtU3BvdHMgPSBbXTtcbnZhciBpbmZvd2luZG93O1xuXG52YXIgUmVkUm9hZHNOR3JlZW5CdXNTdG9wcyA9IFtcbiAge1xuICAgIFwiZmVhdHVyZVR5cGVcIjogXCJwb2lcIixcbiAgICBcImVsZW1lbnRUeXBlXCI6IFwibGFiZWxzXCIsXG4gICAgXCJzdHlsZXJzXCI6IFtcbiAgICAgICAgeyB2aXNpYmlsaXR5OiBcIm9mZlwiIH1cbiAgICBdXG4gIH0sXG4gIHtcbiAgICBcImZlYXR1cmVUeXBlXCI6IFwicm9hZFwiLFxuICAgIFwic3R5bGVyc1wiOiBbXG4gICAgICB7IFwiZ2FtbWFcIjogMC42NSB9LFxuICAgICAgeyBcImh1ZVwiOiBcIiNmZjljMzBcIiB9LFxuICAgICAgeyBcInZpc2liaWxpdHlcIjogXCJvblwiIH0sXG4gICAgICB7IFwic2F0dXJhdGlvblwiOiA5OSB9LFxuICAgICAgeyBcImxpZ2h0bmVzc1wiOiAtMTIgfVxuICAgIF1cbiAgfSx7XG4gICAgXCJmZWF0dXJlVHlwZVwiOiBcInRyYW5zaXRcIixcbiAgICBcInN0eWxlcnNcIjogW1xuICAgICAgeyBcImh1ZVwiOiBcIiMwMGZmMzNcIiB9LFxuICAgICAgeyBcImdhbW1hXCI6IDAuNjAgfSxcbiAgICAgIHsgXCJzYXR1cmF0aW9uXCI6IDUgfSxcbiAgICAgIHsgXCJ2aXNpYmlsaXR5XCI6IFwib25cIiB9LFxuICAgICAgeyBcIndlaWdodFwiOiA0LjYgfSxcbiAgICAgIHsgXCJsaWdodG5lc3NcIjogLTEyIH0gLy93YXMgLTIyXG4gICAgXVxuICB9XG5dO1xuXG52YXIgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgY2VudGVyOiB7bGF0OiA0OS4yNjIzODcsIGxuZzogLTEyMy4wNjk3Njh9LC8vNDkuMjYyMzg3LCAtMTIzLjA2OTc2OFxuICAgICAgICAvLyBDb21tZXJjaWFsIEJyb2Fkd2F5IFN0YXRpb24gNDnCsDE14oCyNDXigLNOLCAxMjPCsDA04oCyMDjigLNXXG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICB6b29tQ29udHJvbDogdHJ1ZSxcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlLFxuICAgICAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgICAgIGRpc2FibGVEb3VibGVDbGlja1pvb206IHRydWUsXG4gICAgICAgIGRpc2FibGVEZWZhdWx0VUk6IHRydWUsXG4gICAgICAgIHN0eWxlczogUmVkUm9hZHNOR3JlZW5CdXNTdG9wc1xuICAgIH07XG5cbi8vIGludm9rZWQgYnkgbWFwIDxzY3JpcHQ+IGluIGluZGV4Lmh0bWxcbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWRpdicpLCBtYXBPcHRpb25zICk7XG4gICAgbW9kZWwgPSBnZXRNb2RlbCgpOyAvLyBsb2FkIGRhdGEgb2JqZWN0IGVpdGhlciBmcm9tIGxvY2FsU3RvcmFnZSBvciBmaWxlXG4gICAgLy8gdGhlbiBidWlsZCB0aGUgc2xpZGUgY29udGVudCB3aXRoIGFqYXggYXBpIGNhbGxzLCBpZiBuZWNlc3NhcnlcbiAgICBpZiAoIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQgPT09IHVuZGVmaW5lZCkgfHxcbiAgICAgICAgIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQuc2xpY2UoMCw1KSA9PSBcIlNvcnJ5XCIpKSB7XG4gICAgICAgICAgICBtb2RlbC5zcG90cy5mb3JFYWNoKCBmdW5jdGlvbiAoc3BvdCkge1xuICAgICAgICAgICAgICAgIGJ1aWxkU2xpZGVDb250ZW50KHNwb3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmlld01vZGVsLnNwb3RMaXN0KG1vZGVsLnNwb3RzKTtcbiAgICBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe30pO1xuICAgIG1hcC5zZXRab29tKG1vZGVsLnpvb21MZXZlbCk7XG4gICAgbWFwLnNldENlbnRlcihtb2RlbC5jZW50ZXIpO1xuICAgIG1vZGVsLnNwb3RzLmZvckVhY2goIGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICAgdm1TcG90cy5wdXNoKG5ldyBTcG90KHNwb3QpKTtcbiAgICB9KTtcbiAgICAvLyBzdGF5IGNlbnRyZWRcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGREb21MaXN0ZW5lcih3aW5kb3csICdyZXNpemUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgbWFwLnNldENlbnRlcihtb2RlbC5jZW50ZXIpO1xuICAgIH0pO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLm1vZGVsID0gSlNPTi5zdHJpbmdpZnkobW9kZWwpO1xuICAgIH0sIDMwMDApO1xufVxuXG4vLyBjb25zdHJ1Y3RvclxudmFyIFNwb3QgPSBmdW5jdGlvbihkYXRhKSB7XG4gIHZhciB0aGF0ID0gdGhpcztcbiAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xuICB0aGlzLmxvY2F0aW9uID0gZGF0YS5sb2NhdGlvbjtcbiAgdGhpcy5zbGlkZUNvbnRlbnQgPSBkYXRhLnNsaWRlQ29udGVudDtcbiAgdGhpcy5tYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgcG9zaXRpb246IHRoaXMubG9jYXRpb24sXG4gICAgICAgIHRpdGxlOiB0aGlzLm5hbWUsXG4gICAgICAgIG1hcDogbWFwLFxuICAgICAgICBvcGFjaXR5OiAwLjRcbiAgfSk7XG4gIHRoaXMud2luZG93Q29udGVudCA9IGJ1aWxkV2luZG93Q29udGVudCh0aGlzLm1hcmtlcik7XG4gIHRoaXMuY2xpY2tFdmVudCA9IGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHRoaXMubWFya2VyLCBcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhhdC5kb09wZW5pbmcoKTtcbiAgICB9KTtcbiAgdGhpcy5vdmVyRXZlbnQgPSBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcmtlciwgXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAvL3RoYXQuaGlMaWdodExpc3RJdGVtKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwid2UgY291bGQgaGktbGlnaHQgdGhlIFwiICsgdGhhdC5uYW1lICsgXCIgbGlzdCBpdGVtIG5vd1wiKTtcbiAgfSk7XG4gIHRoaXMub3V0RXZlbnQgPSBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcmtlciwgXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdGhhdC5oaUxpZ2h0TGlzdEl0ZW0oKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJ3ZSBjb3VsZCBsby1saWdodCB0aGUgXCIgKyB0aGF0Lm5hbWUgKyBcIiBsaXN0IGl0ZW0gbm93XCIpO1xuICB9KTtcbn07XG5cblNwb3QucHJvdG90eXBlLmhpTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuXG59O1xuXG5TcG90LnByb3RvdHlwZS5kb09wZW5pbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICB0aGlzLm1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XG4gICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGF0Lm9wZW5XaW5kb3coKTtcbiAgICAgICAgdGhhdC5tYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xuICAgIH0sIDEwMDApO1xufTtcblxuU3BvdC5wcm90b3R5cGUub3BlbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2aWV3TW9kZWwubGlzdENvbGxhcHNlKCk7XG4gICAgaW5mb3dpbmRvdy5zZXRDb250ZW50KHRoaXMud2luZG93Q29udGVudCk7XG4gICAgaW5mb3dpbmRvdy5vcGVuKG1hcCwgdGhpcy5tYXJrZXIpO1xufTtcblxuU3BvdC5wcm90b3R5cGUuaGlkZU1hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG51bGwpOyB9O1xuU3BvdC5wcm90b3R5cGUuc2hvd01hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG1hcCk7IH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9LTyBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbnZhciBWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gRGF0YVxuICAgIHNlbGYubGlzdE9uID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICBzZWxmLmJ1cmdlck1lbnUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNwb3RMaXN0ID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgc2VsZi5zbGlkZU9uID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zbGlkZUNvbnRlbnQgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgc2VsZi5maWx0ZXJTbG90ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuaXNTZWxlY3RlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuXG4gICAgLy8gQmVoYXZpb3Vyc1xuICAgIHNlbGYuc3BvdFBpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdCh0aGlzLm5hbWUpO1xuICAgICAgICBzcG90LmRvT3BlbmluZygpO1xuICAgIH07XG4gICAgc2VsZi5zZXRGaWx0ZXJTZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmlzU2VsZWN0ZWQodHJ1ZSk7XG4gICAgICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgfTtcbiAgICBzZWxmLmZpbHRlclNsb3Quc3Vic2NyaWJlKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIHNlbGYuc3BvdExpc3QoZmlsdGVyTGlzdChkYXRhLCB2bVNwb3RzKSk7XG4gICAgICAgIHJlc2V0TWFya2VycyhzZWxmLnNwb3RMaXN0KCkpO1xuICAgIH0pO1xuICAgIHNlbGYub25FbnRlciA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93LmFuY2hvcikge1xuICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc3BvdExpc3QoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zcG90TGlzdCgpWzBdLmRvT3BlbmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93KSBpbmZvd2luZG93LmNsb3NlKCk7IC8vZm9yIGFueSBvdGhlciBrZXlwcmVzc1xuICAgICAgICAgICAgc2VsZi5zbGlkZU9mZigpO1xuICAgICAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIG5lY2Vzc2FyeSB0byByZWZsZWN0IHRoZSB0ZXh0IGluIHRoZSBzbG90XG4gICAgfTtcbiAgICBzZWxmLmxpc3RDb2xsYXBzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9kaXNhYmxlIGZvciBiaWcgc2NyZWVuOyBlbmFibGUgZm9yIHNtYWxsXG4gICAgICAgIHZhciBtZWRpYXF1ZXJ5ID0gd2luZG93Lm1hdGNoTWVkaWEoIFwiKG1heC13aWR0aDogNTQ5cHgpXCIgKTtcbiAgICAgICAgaWYgKG1lZGlhcXVlcnkubWF0Y2hlcykge1xuICAgICAgICAgICAgc2VsZi5saXN0T24oZmFsc2UpO1xuICAgICAgICAgICAgc2VsZi5idXJnZXJNZW51KHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLmxpc3RFeHBhbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICAgICAgc2VsZi5idXJnZXJNZW51KGZhbHNlKTtcbiAgICAgICAgc2VsZi5saXN0T24odHJ1ZSk7XG4gICAgfTtcbiAgICBzZWxmLm9wZW5BUElzbGlkZSA9IGZ1bmN0aW9uIChzcG90TmFtZSkge1xuICAgICAgICB2YXIgc3BvdCA9IGdldFNwb3Qoc3BvdE5hbWUpO1xuICAgICAgICBpZiAoIShzcG90LnNsaWRlQ29udGVudCkpIHtcbiAgICAgICAgICAgIGR1YlNsaWRlQ29udGVudHMoKTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3TW9kZWwuc2xpZGVDb250ZW50KHNwb3Quc2xpZGVDb250ZW50KTtcbiAgICAgICAgdmlld01vZGVsLnNsaWRlT24odHJ1ZSk7XG4gICAgfTtcbiAgICBzZWxmLnNsaWRlT2ZmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNsaWRlT24oZmFsc2UpO1xuICAgIH07XG59O1xuXG52YXIgdmlld01vZGVsID0gbmV3IFZpZXdNb2RlbCgpO1xua28uYXBwbHlCaW5kaW5ncyh2aWV3TW9kZWwpO1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUhFTFBFUiBGVU5DVElPTlMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vL3Rlc3QgYXJyYXkgYWdhaW5zdCBhIHJlZ3VsYXIgZXhwcmVzc2lvblxuZnVuY3Rpb24gZmlsdGVyTGlzdCh1c2VyVGV4dCwgbW9kZWxBcnJheSkge1xuICAgICB2YXIgcmVzdWx0PVtdLFxuICAgICAgICAgcmUgPSBuZXcgUmVnRXhwKHVzZXJUZXh0LCBbJ2knXSk7XG4gICAgIG1vZGVsQXJyYXkuZm9yRWFjaCggZnVuY3Rpb24oZWxlbWVudCwgaW5kZXgsIGFycmF5KSB7XG4gICAgICAgIGlmIChyZS50ZXN0KGVsZW1lbnQubmFtZSkpIHJlc3VsdC5wdXNoKGVsZW1lbnQpO1xuICAgICB9KTtcbiAgICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZ2V0U3BvdChuYW1lKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICB2bVNwb3RzLmZvckVhY2goIGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICBpZiAoc3BvdC5uYW1lID09IG5hbWUpIHJlc3VsdCA9IHNwb3Q7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gZWRpdCB0aGUgc2V0IG9mIGRpc3BsYXllZCBtYXJrZXJzIGJhc2VkIG9uIHRoZSBmaWx0ZXJlZCBzcG90TGlzdFxuZnVuY3Rpb24gcmVzZXRNYXJrZXJzKHNwb3RzKSB7XG4gICAgdm1TcG90cy5mb3JFYWNoKGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICAgc3BvdC5oaWRlTWFya2VyKCk7XG4gICAgfSk7XG4gICAgc3BvdHMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGdldFNwb3QoaXRlbS5uYW1lKS5zaG93TWFya2VyKCk7XG4gICAgfSk7XG59XG5cbi8vIGNhbGxlZCBpbiB0aGUgY2xpY2sgZXZlbnQgbGlzdGVuZXIgb2YgaW5mb1dpbmRvd1xuZnVuY3Rpb24gaXRjaHdpbmRvdygpIHtcbiAgICB2aWV3TW9kZWwub3BlbkFQSXNsaWRlKGluZm93aW5kb3cuYW5jaG9yLnRpdGxlKTtcbn1cblxuLy8gZ2V0IHJpZCBvZiBvbGQgb3Zlci1sYXlzXG5mdW5jdGlvbiBjbGVhblVwU2NyZWVuKCkge1xuICAgIGluZm93aW5kb3cuY2xvc2UoKTtcbiAgICBtYXAuc2V0Wm9vbShtb2RlbC56b29tTGV2ZWwpO1xuICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICB2aWV3TW9kZWwuc2xpZGVPZmYoKTtcbn1cblxuZnVuY3Rpb24gZHViU2xpZGVDb250ZW50cygpIHtcbiAgICBpZiAobW9kZWwuc3BvdHNbMF0uc2xpZGVDb250ZW50KSB7XG4gICAgICAgIGZvciAodmFyIGkgaW4gbW9kZWwuc3BvdHMpIHtcbiAgICAgICAgICAgIHZtU3BvdHNbaV0uc2xpZGVDb250ZW50ID0gbW9kZWwuc3BvdHNbaV0uc2xpZGVDb250ZW50O1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLm1vZGVsID0gSlNPTi5zdHJpbmdpZnkobW9kZWwpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PVRIRSBFTkQ9PT09PT09PT09PT09PT09PT09XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8vZnJvbSBodHRwczovL2RldmVsb3Blci5mb3Vyc3F1YXJlLmNvbS9vdmVydmlldy9hdXRoI3VzZXJsZXNzXG4vL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2g/bGw9NDAuNywtNzQmY2xpZW50X2lkPUNMSUVOVF9JRCZjbGllbnRfc2VjcmV0PUNMSUVOVF9TRUNSRVQmdj1ZWVlZTU1ERFxuXG4vL2ZvdXJzcXVhcmUuY29tL3YvYnJvYWR3YXktc3RhdGlvbi1zdXNoaS80YWFlOWNiN2Y5NjRhNTIwOWI2MjIwZTNcbnZhciBrciA9IHtcbiAgICBmb3Vyc3F1YXJlOiB7XG4gICAgICAgIE93bmVyOiBcIktSIERlY2tlclwiLFxuICAgICAgICBDbGllbnRfaWQ6IFwiWlZMS1RLU0dVTEZFUTNYTVdXSTNBTDFBMktYWUJFS0QxTEtTVVJVWkRHWlk0MUpYXCIsXG4gICAgICAgIENsaWVudF9zZWNyZXQ6IFwiVE1UMjAzREhXT1BSM1I0UlNNMUhFNFJNT0tFV0xHVFQwRkxNWk1VWjFPSkhNQUsxXCJcbiAgICB9LFxuICAgIHllbHA6IHtcbiAgICAgICAgQ29uc3VtZXJfS2V5OiAgICBcIlhyeEpPVWdHTktxOVp1V2hCWDFMRHdcIixcbiAgICAgICAgQ29uc3VtZXJfU2VjcmV0OiBcInpyMkk3Nm5UOGwwTy10cmt1cFlFMDBCOUJUQVwiLFxuICAgICAgICBUb2tlbjogICBcIi1fRjhhT3hvblI2cTVTcXZVUnd3Z0xJZFUtcXRlUy1CXCIsXG4gICAgICAgIFRva2VuX1NlY3JldDogICAgXCJHRjd1UmNQV0NwemxIY1JQM0RpSldqdmNYSkVcIlxuICAgIH0sXG4gICAgc3RyZWV0dmlldzoge1xuICAgICAgICBrZXk6IFwiQUl6YVN5QVA2MzF6NldxTW9wdG9hR2hlcmhKVkJHeU4xdVBIUHQ0XCJcbiAgICB9XG59O1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
