"use strict";function getModel(){return localStorage.model?JSON.parse(localStorage.model):EatsModel}function buildWindowContent(e){var t="http://maps.googleapis.com/maps/api/streetview?size=200x150&location="+e.position.toString().slice(1,-1),o='<img class="bgimg" src="'+t+'">',n='"height:100%;width:80%"',i='<div onclick="itchwindow()" style='+n+">"+o+'<br><span style="color:darkgreen">'+e.title+'</span><br><span style="color:red">-CLICK FOR MORE INFO-</span></div>';return i}function buildSlideContent(e){function t(t,i){console.log("In getVenueInfo: status = "+i);var a=t.response.venues[0];$.ajax({url:fourSquareURL+"/v2/venues/"+a.id,dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:o,error:n})}function o(t){var o=t.response.venue;i="FourSquare info: <br><br>"+o.name+"<br>"+o.contact.formattedPhone+"<br>- "+o.location.address+"<br>- "+o.location.city+"<br>- "+o.location.country+"<br>x-street: "+o.location.crossStreet+"<br>Check-ins: "+o.stats.checkinsCount.toString()+"<br>"+o.likes.summary+'<br><br><span style="background-color:#'+o.ratingColor+';color:black;padding:1%">Rating: '+o.rating.toString()+'</span><br><img src="'+o.bestPhoto.prefix+"cap300"+o.bestPhoto.suffix+'">',updateSlideContent(e,i)}function n(t,o,n){var i="Sorry. 3rd party info unavailable.";updateSlideContent(e,i)}var i="",s="ll="+e.location.lat.toString()+","+e.location.lng.toString();$.ajax({url:fourSquareURL+"/v2/venues/search",dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:t,error:n})}function updateSlideContent(e,t){e.slideContent=t;var o=getSpot(e.name);o&&(console.log("in updateSlideContent: viewSpot "),o.slideContent=t)}function init(){map=new google.maps.Map(document.getElementById("map-div"),mapOptions),model=getModel(),(void 0===model.spots[0].slideContent||"Sorry"==model.spots[0].slideContent.slice(0,5))&&model.spots.forEach(function(e){buildSlideContent(e)}),viewModel.spotList(model.spots),infowindow=new google.maps.InfoWindow({}),map.setZoom(model.zoomLevel),map.setCenter(model.center),model.spots.forEach(function(e){vmSpots.push(new Spot(e))}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(model.center)}),window.setTimeout(function(){localStorage.model=JSON.stringify(model)},3e3)}function filterList(e,t){var o=[],n=new RegExp(e,["i"]);return t.forEach(function(e,t,i){n.test(e.name)&&o.push(e)}),o}function getSpot(e){var t;return vmSpots.forEach(function(o){o.name==e&&(t=o)}),t}function resetMarkers(e){vmSpots.forEach(function(e){e.hideMarker()}),e.forEach(function(e){getSpot(e.name).showMarker()})}function itchwindow(){viewModel.openAPIslide(infowindow.anchor.title)}function cleanUpScreen(){infowindow.close(),map.setZoom(model.zoomLevel),map.setCenter(model.center),viewModel.slideOff()}function dubSlideContents(){if(model.spots[0].slideContent)for(var e in model.spots)vmSpots[e].slideContent=model.spots[e].slideContent,localStorage.model=JSON.stringify(model)}var EatsModel={zoomLevel:18,center:{lat:49.262387,lng:-123.069768},spots:[{name:"Uncle Fatih's Pizza",location:{lat:49.262437,lng:-123.07075}},{name:"Buddha's Orient Express",location:{lat:49.262719,lng:-123.069289}},{name:"Booster Juice",location:{lat:49.262641,lng:-123.069438}},{name:"Starbucks Coffee",location:{lat:49.261874,lng:-123.070176}},{name:"Blenz Coffee",location:{lat:49.262534,lng:-123.069529}},{name:"Megabite Pizza",location:{lat:49.262779,lng:-123.069317}},{name:"Broadway Station Sushi",location:{lat:49.262084,lng:-123.070962}}]},model={},fourSquareURL="https://api.foursquare.com",map,vmSpots=[],infowindow,RedRoadsNGreenBusStops=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{gamma:.65},{hue:"#ff9c30"},{visibility:"on"},{saturation:99},{lightness:-12}]},{featureType:"transit",stylers:[{hue:"#00ff33"},{gamma:.6},{saturation:5},{visibility:"on"},{weight:4.6},{lightness:-12}]}],mapOptions={center:{lat:49.262387,lng:-123.069768},zoom:16,zoomControl:!0,scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,disableDefaultUI:!0,styles:RedRoadsNGreenBusStops},Spot=function(e){var t=this;this.name=e.name,this.location=e.location,this.slideContent=e.slideContent,this.marker=new google.maps.Marker({position:this.location,title:this.name,map:map,opacity:.4}),this.windowContent=buildWindowContent(this.marker),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(){t.doOpening()}),this.overEvent=google.maps.event.addListener(this.marker,"mouseover",function(){t.hiLightListItem()}),this.outEvent=google.maps.event.addListener(this.marker,"mouseout",function(){t.loLightListItem()})};Spot.prototype.hiLightListItem=function(){var e=this;cleanUpScreen(),$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.loLightListItem=function(){var e=this;$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.doBounce=function(){cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE)},Spot.prototype.stopBounce=function(){this.marker.setAnimation(null)},Spot.prototype.doOpening=function(){var e=this;cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.openWindow(),e.marker.setAnimation(null)},1e3)},Spot.prototype.openWindow=function(){viewModel.listCollapse(),infowindow.setContent(this.windowContent),infowindow.open(map,this.marker)},Spot.prototype.hideMarker=function(){this.marker.setMap(null)},Spot.prototype.showMarker=function(){this.marker.setMap(map)};var ViewModel=function(){var e=this;e.listOn=ko.observable(!0),e.burgerMenu=ko.observable(!1),e.spotList=ko.observableArray(),e.slideOn=ko.observable(!1),e.slideContent=ko.observable(),e.filterSlot=ko.observable(),e.isSelected=ko.observable(!1),e.bounceMarker=function(){var e=getSpot(this.name);e.doBounce()},e.unbounceMarker=function(){var e=getSpot(this.name);e.stopBounce()},e.spotPick=function(){var e=getSpot(this.name);e.doOpening()},e.setFilterSelected=function(){this.isSelected(!0),cleanUpScreen(),e.listExpand()},e.filterSlot.subscribe(function(t){e.listExpand(),e.spotList(filterList(t,vmSpots)),resetMarkers(e.spotList())}),e.onEnter=function(t,o){return 13===o.keyCode?infowindow.anchor?e.openAPIslide(infowindow.anchor.title):1===e.spotList().length&&e.spotList()[0].doOpening():(infowindow&&infowindow.close(),e.slideOff(),e.listExpand()),!0},e.listCollapse=function(){var t=window.matchMedia("(max-width: 549px)");t.matches&&(e.listOn(!1),e.burgerMenu(!0))},e.listExpand=function(){cleanUpScreen(),e.burgerMenu(!1),e.listOn(!0)},e.openAPIslide=function(e){var t=getSpot(e);t.slideContent||dubSlideContents(),viewModel.slideContent(t.slideContent),viewModel.slideOn(!0)},e.slideOff=function(){this.slideOn(!1)}},viewModel=new ViewModel;ko.applyBindings(viewModel);var kr={foursquare:{Owner:"KR Decker",Client_id:"ZVLKTKSGULFEQ3XMWWI3AL1A2KXYBEKD1LKSURUZDGZY41JX",Client_secret:"TMT203DHWOPR3R4RSM1HE4RMOKEWLGTT0FLMZMUZ1OJHMAK1"},yelp:{Consumer_Key:"XrxJOUgGNKq9ZuWhBX1LDw",Consumer_Secret:"zr2I76nT8l0O-trkupYE00B9BTA",Token:"-_F8aOxonR6q5SqvURwwgLIdU-qteS-B",Token_Secret:"GF7uRcPWCpzlHcRP3DiJWjvcXJE"},streetview:{key:"AIzaSyAP631z6WqMoptoaGherhJVBGyN1uPHPt4"}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnZXRNb2RlbCIsImxvY2FsU3RvcmFnZSIsIm1vZGVsIiwiSlNPTiIsInBhcnNlIiwiRWF0c01vZGVsIiwiYnVpbGRXaW5kb3dDb250ZW50IiwibWFya2VyIiwic3RyZWV0dmlld1VybCIsInBvc2l0aW9uIiwidG9TdHJpbmciLCJzbGljZSIsInBpY3R1cmUiLCJjc3MiLCJjb250ZW50IiwidGl0bGUiLCJidWlsZFNsaWRlQ29udGVudCIsInNwb3QiLCJnZXRWZW51ZUluZm8iLCJkYXRhIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInZlbnVlIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCIkIiwiYWpheCIsInVybCIsImZvdXJTcXVhcmVVUkwiLCJpZCIsImRhdGFUeXBlIiwibG9jIiwibmFtZSIsImtyIiwiZm91cnNxdWFyZSIsIkNsaWVudF9pZCIsIkNsaWVudF9zZWNyZXQiLCJhc3luYyIsInN1Y2Nlc3MiLCJmb3JtYXRTaG93RGF0YSIsImVycm9yIiwic2VuZEVycm9yIiwiZm9ybWF0dGVkRGF0YSIsImNvbnRhY3QiLCJmb3JtYXR0ZWRQaG9uZSIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiY3Jvc3NTdHJlZXQiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJsaWtlcyIsInN1bW1hcnkiLCJyYXRpbmdDb2xvciIsInJhdGluZyIsImJlc3RQaG90byIsInByZWZpeCIsInN1ZmZpeCIsInVwZGF0ZVNsaWRlQ29udGVudCIsIm9iamVjdCIsImV4Y2VwdGlvbiIsImFqYXhfZXJyb3IiLCJsYXQiLCJsbmciLCJkYXRhU3RyaW5nIiwic2xpZGVDb250ZW50Iiwidm1TcG90IiwiZ2V0U3BvdCIsImluaXQiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1hcE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzcG90cyIsImZvckVhY2giLCJ2aWV3TW9kZWwiLCJzcG90TGlzdCIsImluZm93aW5kb3ciLCJJbmZvV2luZG93Iiwic2V0Wm9vbSIsInpvb21MZXZlbCIsInNldENlbnRlciIsImNlbnRlciIsInZtU3BvdHMiLCJwdXNoIiwiU3BvdCIsImV2ZW50IiwiYWRkRG9tTGlzdGVuZXIiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0Iiwic3RyaW5naWZ5IiwiZmlsdGVyTGlzdCIsInVzZXJUZXh0IiwibW9kZWxBcnJheSIsInJlc3VsdCIsInJlIiwiUmVnRXhwIiwiZWxlbWVudCIsImluZGV4IiwiYXJyYXkiLCJ0ZXN0IiwicmVzZXRNYXJrZXJzIiwiaGlkZU1hcmtlciIsIml0ZW0iLCJzaG93TWFya2VyIiwiaXRjaHdpbmRvdyIsIm9wZW5BUElzbGlkZSIsImFuY2hvciIsImNsZWFuVXBTY3JlZW4iLCJjbG9zZSIsInNsaWRlT2ZmIiwiZHViU2xpZGVDb250ZW50cyIsImkiLCJSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzIiwiZmVhdHVyZVR5cGUiLCJlbGVtZW50VHlwZSIsInN0eWxlcnMiLCJ2aXNpYmlsaXR5IiwiZ2FtbWEiLCJodWUiLCJzYXR1cmF0aW9uIiwibGlnaHRuZXNzIiwid2VpZ2h0Iiwiem9vbSIsInpvb21Db250cm9sIiwic2Nyb2xsd2hlZWwiLCJkcmFnZ2FibGUiLCJkaXNhYmxlRG91YmxlQ2xpY2tab29tIiwiZGlzYWJsZURlZmF1bHRVSSIsInN0eWxlcyIsInRoYXQiLCJ0aGlzIiwiTWFya2VyIiwib3BhY2l0eSIsIndpbmRvd0NvbnRlbnQiLCJjbGlja0V2ZW50IiwiYWRkTGlzdGVuZXIiLCJkb09wZW5pbmciLCJvdmVyRXZlbnQiLCJoaUxpZ2h0TGlzdEl0ZW0iLCJvdXRFdmVudCIsImxvTGlnaHRMaXN0SXRlbSIsInByb3RvdHlwZSIsInRvZ2dsZUNsYXNzIiwiZG9Cb3VuY2UiLCJzZXRBbmltYXRpb24iLCJBbmltYXRpb24iLCJCT1VOQ0UiLCJzdG9wQm91bmNlIiwib3BlbldpbmRvdyIsImxpc3RDb2xsYXBzZSIsInNldENvbnRlbnQiLCJvcGVuIiwic2V0TWFwIiwiVmlld01vZGVsIiwic2VsZiIsImxpc3RPbiIsImtvIiwib2JzZXJ2YWJsZSIsImJ1cmdlck1lbnUiLCJvYnNlcnZhYmxlQXJyYXkiLCJzbGlkZU9uIiwiZmlsdGVyU2xvdCIsImlzU2VsZWN0ZWQiLCJib3VuY2VNYXJrZXIiLCJ1bmJvdW5jZU1hcmtlciIsInNwb3RQaWNrIiwic2V0RmlsdGVyU2VsZWN0ZWQiLCJsaXN0RXhwYW5kIiwic3Vic2NyaWJlIiwib25FbnRlciIsImtleUNvZGUiLCJsZW5ndGgiLCJtZWRpYXF1ZXJ5IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJzcG90TmFtZSIsImFwcGx5QmluZGluZ3MiLCJPd25lciIsInllbHAiLCJDb25zdW1lcl9LZXkiLCJDb25zdW1lcl9TZWNyZXQiLCJUb2tlbiIsIlRva2VuX1NlY3JldCIsInN0cmVldHZpZXciLCJrZXkiXSwibWFwcGluZ3MiOiJBQUFBLFlBOENBLFNBQVNBLFlBQ0wsTUFBSUMsY0FBYUMsTUFDTkMsS0FBS0MsTUFBTUgsYUFBYUMsT0FFeEJHLFVBS2YsUUFBU0Msb0JBQW1CQyxHQUN4QixHQUFJQyxHQUFnQix3RUFDSUQsRUFBT0UsU0FBU0MsV0FBV0MsTUFBTSxFQUFFLElBSXZEQyxFQUFVLDJCQUE2QkosRUFBZ0IsS0FDdkRLLEVBQU0sMEJBQ05DLEVBQVUscUNBQ0VELEVBQU0sSUFBTUQsRUFBVSxxQ0FDdEJMLEVBQU9RLE1BQVEsdUVBRy9CLE9BQU9ELEdBVVgsUUFBU0UsbUJBQWtCQyxHQXFCdkIsUUFBU0MsR0FBYUMsRUFBTUMsR0FDeEJDLFFBQVFDLElBQUksNkJBQStCRixFQUMzQyxJQUFJRyxHQUFRSixFQUFLSyxTQUFTQyxPQUFPLEVBRWpDQyxHQUFFQyxNQUNFQyxJQUFLQyxjQUFnQixjQUFnQk4sRUFBTU8sR0FDM0NDLFNBQVUsT0FDVlosS0FBTSxXQUNRYSxFQUNOLFVBQVlmLEVBQUtnQixLQUNqQixjQUFlQyxHQUFHQyxXQUFXQyxVQUM3QixrQkFBbUJGLEdBQUdDLFdBQVdFLGNB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Ly8vLy8vLy8vLy8vLy8vLy8vL01PREVMLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLyBlYXRzIGRhdGE6IGFuIGFycmF5IG9mIHBsYWNlcyB0byBlYXRcbi8vIGFyb3VuZCBDb21tZXJjaWFsLUJyb2Fkd2F5IFN0YXRpb25cbi8vIEVhc3QgVmFuXG4vLyBCcml0aXNoIENvbHVtYmlhXG5cbi8vIGJhc2ljIGRhdGEsIGxvYWRlZCBpZiBtb3JlIGRldGFpbGVkIG1vZGVsIG5vdCBmb3VuZCBpbiBsb2NhbFN0b3JhZ2VcbnZhciBFYXRzTW9kZWwgPSB7XG4gICAgem9vbUxldmVsOiAxOCxcbiAgICBjZW50ZXI6IHtsYXQ6IDQ5LjI2MjM4NywgbG5nOiAtMTIzLjA2OTc2OH0sLy80OS4yNjIzODcsIC0xMjMuMDY5NzY4XG4gICAgc3BvdHM6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJVbmNsZSBGYXRpaCdzIFBpenphXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNDM3LCBsbmc6IC0xMjMuMDcwNzUwfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJ1ZGRoYSdzIE9yaWVudCBFeHByZXNzXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNzE5LCBsbmc6IC0xMjMuMDY5Mjg5fVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJvb3N0ZXIgSnVpY2VcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI2NDEsIGxuZzogLTEyMy4wNjk0Mzh9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiU3RhcmJ1Y2tzIENvZmZlZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MTg3NCwgbG5nOiAtMTIzLjA3MDE3Nn1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCbGVueiBDb2ZmZWVcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI1MzQsIGxuZzogLTEyMy4wNjk1Mjl9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiTWVnYWJpdGUgUGl6emFcIixcbiAgICAgICAgICAgIGxvY2F0aW9uOiB7bGF0OiA0OS4yNjI3NzksIGxuZzogLTEyMy4wNjkzMTd9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQnJvYWR3YXkgU3RhdGlvbiBTdXNoaVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjA4NCwgbG5nOiAtMTIzLjA3MDk2Mn1cbiAgICAgICAgfVxuICAgIF1cbn07XG5cbnZhciBtb2RlbCA9IHt9O1xuXG5mdW5jdGlvbiBnZXRNb2RlbCgpIHtcbiAgICBpZiAobG9jYWxTdG9yYWdlLm1vZGVsKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5tb2RlbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIEVhdHNNb2RlbDtcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gYnVpbGRXaW5kb3dDb250ZW50KG1hcmtlcikge1xuICAgIHZhciBzdHJlZXR2aWV3VXJsID0gJ2h0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3N0cmVldHZpZXc/c2l6ZT0yMDB4MTUwJmxvY2F0aW9uPScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5wb3NpdGlvbi50b1N0cmluZygpLnNsaWNlKDEsLTEpIDsvLyArICcma2V5PScgKyBrci5zdHJlZXR2aWV3LmtleTtcbiAgICAvLyBtYXJrZXIucG9zaXRpb24udG9TdHJpbmcoKSBtZXRob2QgY2hhbmdlZCB0byBpbmNsdWRlIHBhcmVudGhlc2VzLCBoZW5jZSB0aGUgc2xpY2VcbiAgICAvLyBrZXkgbm90IHJlcXVpcmVkXG5cbiAgICB2YXIgcGljdHVyZSA9ICc8aW1nIGNsYXNzPVwiYmdpbWdcIiBzcmM9XCInICsgc3RyZWV0dmlld1VybCArICdcIj4nO1xuICAgIHZhciBjc3MgPSAnXCJoZWlnaHQ6MTAwJTt3aWR0aDo4MCVcIic7XG4gICAgdmFyIGNvbnRlbnQgPSAnPGRpdiBvbmNsaWNrPVwiaXRjaHdpbmRvdygpXCIgc3R5bGU9JyArXG4gICAgICAgICAgICAgICAgICAgIGNzcyArICc+JyArIHBpY3R1cmUgKyAnPGJyPjxzcGFuIHN0eWxlPVwiY29sb3I6ZGFya2dyZWVuXCI+JyArXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci50aXRsZSArICc8L3NwYW4+JyArXG4gICAgICAgICAgICAgICAgICAgICc8YnI+PHNwYW4gc3R5bGU9XCJjb2xvcjpyZWRcIj4tQ0xJQ0sgRk9SIE1PUkUgSU5GTy08L3NwYW4+PC9kaXY+JztcblxuICAgIHJldHVybiBjb250ZW50O1xufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDNyZCBwYXJ0eSBBUEkgc3R1ZmZcbnZhciBmb3VyU3F1YXJlVVJMID0gJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tJztcblxuLy8gZ2V0IGNvbnRlbnQgZm9yIGluZm8gc2xpZGVzIGZyb20gM3JkIHBhcnR5IHNvdXJjZXNcbi8vIGJhc2VkIG9uIGluZm8gZnJvbSBtb2RlbFxuLy8gdGhlbiBhZGQgdG8gbW9kZWwgYW5kIHRvIHZpZXcgb2JqZWN0c1xuZnVuY3Rpb24gYnVpbGRTbGlkZUNvbnRlbnQoc3BvdCkge1xuICAgIHZhciBmb3JtYXR0ZWREYXRhID0gXCJcIjtcbiAgICB2YXIgbG9jID0gXCJsbD1cIiArIHNwb3QubG9jYXRpb24ubGF0LnRvU3RyaW5nKCkgKyBcIixcIiArIHNwb3QubG9jYXRpb24ubG5nLnRvU3RyaW5nKCk7XG4gICAgdmFyIGFqYXhfZXJyb3I7XG5cbiAgICAvLyBnZXQgdGhlIGZvdXJzcXVhcmUgSUQgbnVtYmVyIG9mIHRoZSBzcG90XG4gICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogZm91clNxdWFyZVVSTCArICcvdjIvdmVudWVzL3NlYXJjaCcsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgZGF0YTogJ2xpbWl0PTEnICtcbiAgICAgICAgICAgICAgICAgICAgJyYnICsgbG9jICsgJyZxdWVyeT0nICsgc3BvdC5uYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJyZjbGllbnRfaWQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfaWQgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9zZWNyZXQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfc2VjcmV0ICtcbiAgICAgICAgICAgICAgICAgICAgJyZ2PTIwMTYwMTMwJyxcbiAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgc3VjY2VzczogZ2V0VmVudWVJbmZvLFxuICAgICAgICAgICAgZXJyb3I6IHNlbmRFcnJvclxuICAgIH0pO1xuXG4gICAgLy8gZ2l2ZSB0aGUgcmVzcG9uc2Ugb24gc3BlY2lmaWMgdmVudWUgdG8gYW5vdGhlciBjYWxsIGZvclxuICAgIC8vIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb25cbiAgICBmdW5jdGlvbiBnZXRWZW51ZUluZm8oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiSW4gZ2V0VmVudWVJbmZvOiBzdGF0dXMgPSBcIiArIHN0YXR1cyk7XG4gICAgICAgIHZhciB2ZW51ZSA9IGRhdGEucmVzcG9uc2UudmVudWVzWzBdO1xuICAgICAgICAvL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9WRU5VRV9JRFxuICAgICAgICAkLmFqYXgoeyAvLyB0byBnZXQgdGhlIGRldGFpbGVkIGZvdXJzcXVhcmUgb2YgdGhlICdjb21wbGV0ZSB2ZW51ZScgYmFzZWQgb24gSURcbiAgICAgICAgICAgIHVybDogZm91clNxdWFyZVVSTCArICcvdjIvdmVudWVzLycgKyB2ZW51ZS5pZCxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBkYXRhOiAnbGltaXQ9MScgK1xuICAgICAgICAgICAgICAgICAgICAnJicgKyBsb2MgK1xuICAgICAgICAgICAgICAgICAgICAnJnF1ZXJ5PScgKyBzcG90Lm5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9pZD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9pZCArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X3NlY3JldD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9zZWNyZXQgK1xuICAgICAgICAgICAgICAgICAgICAnJnY9MjAxNjAxMzAnLFxuICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBmb3JtYXRTaG93RGF0YSxcbiAgICAgICAgICAgIGVycm9yOiBzZW5kRXJyb3JcbiAgICAgICAgfSk7Lyouc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgZm9ybWF0U2hvd0RhdGEocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSk7Ki9cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmb3JtYXRTaG93RGF0YShkYXRhKXtcbiAgICAgICAgdmFyIHZlbnVlID0gZGF0YS5yZXNwb25zZS52ZW51ZTtcbiAgICAgICAgZm9ybWF0dGVkRGF0YSA9ICdGb3VyU3F1YXJlIGluZm86ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxicj4nICsgJzxicj4nICsgdmVudWUubmFtZSArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZW51ZS5jb250YWN0LmZvcm1hdHRlZFBob25lICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICctICcgKyB2ZW51ZS5sb2NhdGlvbi5hZGRyZXNzICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICctICcgKyB2ZW51ZS5sb2NhdGlvbi5jaXR5ICArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uY291bnRyeSAgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ3gtc3RyZWV0OiAnICsgdmVudWUubG9jYXRpb24uY3Jvc3NTdHJlZXQgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NoZWNrLWluczogJyArIHZlbnVlLnN0YXRzLmNoZWNraW5zQ291bnQudG9TdHJpbmcoKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGJyPicgKyB2ZW51ZS5saWtlcy5zdW1tYXJ5ICsgJzxicj4nICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8c3BhbiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6IycgKyB2ZW51ZS5yYXRpbmdDb2xvciArXG4gICAgICAgICAgICAgICAgICAgICAgICAnO2NvbG9yOmJsYWNrO3BhZGRpbmc6MSVcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdSYXRpbmc6ICcgKyB2ZW51ZS5yYXRpbmcudG9TdHJpbmcoKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPicgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPVwiJyArIHZlbnVlLmJlc3RQaG90by5wcmVmaXggK1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NhcDMwMCcgKyB2ZW51ZS5iZXN0UGhvdG8uc3VmZml4ICsgJ1wiPidcbiAgICAgICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgLy9zcG90LnNsaWRlQ29udGVudCA9IGZvcm1hdHRlZERhdGE7XG4gICAgICAgIHVwZGF0ZVNsaWRlQ29udGVudChzcG90LCBmb3JtYXR0ZWREYXRhKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2VuZEVycm9yKG9iamVjdCwgZXJyb3IsIGV4Y2VwdGlvbikge1xuICAgICAgICB2YXIgYWpheF9lcnJvciA9IFwiU29ycnkuIDNyZCBwYXJ0eSBpbmZvIHVuYXZhaWxhYmxlLlwiO1xuICAgICAgICB1cGRhdGVTbGlkZUNvbnRlbnQoc3BvdCwgYWpheF9lcnJvcik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVTbGlkZUNvbnRlbnQoc3BvdCwgZGF0YVN0cmluZykge1xuICAgIC8vIHVwZGF0ZSB0aGUgbW9kZWxcbiAgICBzcG90LnNsaWRlQ29udGVudCA9IGRhdGFTdHJpbmc7XG4gICAgLy8gdXBkYXRlIHRoZSB2aWV3XG4gICAgdmFyIHZtU3BvdCA9IGdldFNwb3Qoc3BvdC5uYW1lKTtcbiAgICBpZiAodm1TcG90KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiaW4gdXBkYXRlU2xpZGVDb250ZW50OiB2aWV3U3BvdCBcIik7XG4gICAgICAgIHZtU3BvdC5zbGlkZUNvbnRlbnQgPSBkYXRhU3RyaW5nO1xuICAgIH1cbn1cblxuLy8gTWFya04ncyBpbXBsZW1lbnRhdGlvbiBvZlxuLyoqXG4gKiBHZW5lcmF0ZXMgYSByYW5kb20gbnVtYmVyIGFuZCByZXR1cm5zIGl0IGFzIGEgc3RyaW5nIGZvciBPQXV0aGVudGljYXRpb25cbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqL1xuLy8gZnVuY3Rpb24gbm9uY2VfZ2VuZXJhdGUoKSB7XG4vLyAgIHJldHVybiAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMWUxMikudG9TdHJpbmcoKSk7XG4vLyB9XG5cbi8vIHZhciB5ZWxwX3VybCA9IFlFTFBfQkFTRV9VUkwgKyAnYnVzaW5lc3MvJyArIHNlbGYuc2VsZWN0ZWRfcGxhY2UoKS5ZZWxwLmJ1c2luZXNzX2lkO1xuXG4vLyAgICAgdmFyIHBhcmFtZXRlcnMgPSB7XG4vLyAgICAgICBvYXV0aF9jb25zdW1lcl9rZXk6IFlFTFBfS0VZLFxuLy8gICAgICAgb2F1dGhfdG9rZW46IFlFTFBfVE9LRU4sXG4vLyAgICAgICBvYXV0aF9ub25jZTogbm9uY2VfZ2VuZXJhdGUoKSxcbi8vICAgICAgIG9hdXRoX3RpbWVzdGFtcDogTWF0aC5mbG9vcihEYXRlLm5vdygpLzEwMDApLFxuLy8gICAgICAgb2F1dGhfc2lnbmF0dXJlX21ldGhvZDogJ0hNQUMtU0hBMScsXG4vLyAgICAgICBvYXV0aF92ZXJzaW9uIDogJzEuMCcsXG4vLyAgICAgICBjYWxsYmFjazogJ2NiJyAgICAgICAgICAgICAgLy8gVGhpcyBpcyBjcnVjaWFsIHRvIGluY2x1ZGUgZm9yIGpzb25wIGltcGxlbWVudGF0aW9uIGluIEFKQVggb3IgZWxzZSB0aGUgb2F1dGgtc2lnbmF0dXJlIHdpbGwgYmUgd3JvbmcuXG4vLyAgICAgfTtcblxuLy8gICAgIHZhciBlbmNvZGVkU2lnbmF0dXJlID0gb2F1dGhTaWduYXR1cmUuZ2VuZXJhdGUoJ0dFVCcseWVscF91cmwsIHBhcmFtZXRlcnMsIFlFTFBfS0VZX1NFQ1JFVCwgWUVMUF9UT0tFTl9TRUNSRVQpO1xuLy8gICAgIHBhcmFtZXRlcnMub2F1dGhfc2lnbmF0dXJlID0gZW5jb2RlZFNpZ25hdHVyZTtcblxuLy8gICAgIHZhciBzZXR0aW5ncyA9IHtcbi8vICAgICAgIHVybDogeWVscF91cmwsXG4vLyAgICAgICBkYXRhOiBwYXJhbWV0ZXJzLFxuLy8gICAgICAgY2FjaGU6IHRydWUsICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgY3J1Y2lhbCB0byBpbmNsdWRlIGFzIHdlbGwgdG8gcHJldmVudCBqUXVlcnkgZnJvbSBhZGRpbmcgb24gYSBjYWNoZS1idXN0ZXIgcGFyYW1ldGVyIFwiXz0yMzQ4OTQ4OTc0OTgzN1wiLCBpbnZhbGlkYXRpbmcgb3VyIG9hdXRoLXNpZ25hdHVyZVxuLy8gICAgICAgZGF0YVR5cGU6ICdqc29ucCcsXG4vLyAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHRzKSB7XG4vLyAgICAgICAgIC8vIERvIHN0dWZmIHdpdGggcmVzdWx0c1xuLy8gICAgICAgfSxcbi8vICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHtcbi8vICAgICAgICAgLy8gRG8gc3R1ZmYgb24gZmFpbFxuLy8gICAgICAgfVxuLy8gICAgIH07XG5cbi8vICAgICAvLyBTZW5kIEFKQVggcXVlcnkgdmlhIGpRdWVyeSBsaWJyYXJ5LlxuLy8gICAgICQuYWpheChzZXR0aW5ncyk7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9NQVAgVklFV01PREVMLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbnZhciBtYXA7XG52YXIgdm1TcG90cyA9IFtdO1xudmFyIGluZm93aW5kb3c7XG5cbnZhciBSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzID0gW1xuICB7XG4gICAgXCJmZWF0dXJlVHlwZVwiOiBcInBvaVwiLFxuICAgIFwiZWxlbWVudFR5cGVcIjogXCJsYWJlbHNcIixcbiAgICBcInN0eWxlcnNcIjogW1xuICAgICAgICB7IHZpc2liaWxpdHk6IFwib2ZmXCIgfVxuICAgIF1cbiAgfSxcbiAge1xuICAgIFwiZmVhdHVyZVR5cGVcIjogXCJyb2FkXCIsXG4gICAgXCJzdHlsZXJzXCI6IFtcbiAgICAgIHsgXCJnYW1tYVwiOiAwLjY1IH0sXG4gICAgICB7IFwiaHVlXCI6IFwiI2ZmOWMzMFwiIH0sXG4gICAgICB7IFwidmlzaWJpbGl0eVwiOiBcIm9uXCIgfSxcbiAgICAgIHsgXCJzYXR1cmF0aW9uXCI6IDk5IH0sXG4gICAgICB7IFwibGlnaHRuZXNzXCI6IC0xMiB9XG4gICAgXVxuICB9LHtcbiAgICBcImZlYXR1cmVUeXBlXCI6IFwidHJhbnNpdFwiLFxuICAgIFwic3R5bGVyc1wiOiBbXG4gICAgICB7IFwiaHVlXCI6IFwiIzAwZmYzM1wiIH0sXG4gICAgICB7IFwiZ2FtbWFcIjogMC42MCB9LFxuICAgICAgeyBcInNhdHVyYXRpb25cIjogNSB9LFxuICAgICAgeyBcInZpc2liaWxpdHlcIjogXCJvblwiIH0sXG4gICAgICB7IFwid2VpZ2h0XCI6IDQuNiB9LFxuICAgICAgeyBcImxpZ2h0bmVzc1wiOiAtMTIgfSAvL3dhcyAtMjJcbiAgICBdXG4gIH1cbl07XG5cbnZhciBtYXBPcHRpb25zID0ge1xuICAgICAgICBjZW50ZXI6IHtsYXQ6IDQ5LjI2MjM4NywgbG5nOiAtMTIzLjA2OTc2OH0sLy80OS4yNjIzODcsIC0xMjMuMDY5NzY4XG4gICAgICAgIC8vIENvbW1lcmNpYWwgQnJvYWR3YXkgU3RhdGlvbiA0OcKwMTXigLI0NeKAs04sIDEyM8KwMDTigLIwOOKAs1dcbiAgICAgICAgem9vbTogMTYsXG4gICAgICAgIHpvb21Db250cm9sOiB0cnVlLFxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2UsXG4gICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgZGlzYWJsZURvdWJsZUNsaWNrWm9vbTogdHJ1ZSxcbiAgICAgICAgZGlzYWJsZURlZmF1bHRVSTogdHJ1ZSxcbiAgICAgICAgc3R5bGVzOiBSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzXG4gICAgfTtcblxuLy8gaW52b2tlZCBieSBtYXAgPHNjcmlwdD4gaW4gaW5kZXguaHRtbFxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtZGl2JyksIG1hcE9wdGlvbnMgKTtcbiAgICBtb2RlbCA9IGdldE1vZGVsKCk7IC8vIGxvYWQgZGF0YSBvYmplY3QgZWl0aGVyIGZyb20gbG9jYWxTdG9yYWdlIG9yIGZpbGVcbiAgICAvLyB0aGVuIGJ1aWxkIHRoZSBzbGlkZSBjb250ZW50IHdpdGggYWpheCBhcGkgY2FsbHMsIGlmIG5lY2Vzc2FyeVxuICAgIGlmICggKG1vZGVsLnNwb3RzWzBdLnNsaWRlQ29udGVudCA9PT0gdW5kZWZpbmVkKSB8fFxuICAgICAgICAgKG1vZGVsLnNwb3RzWzBdLnNsaWRlQ29udGVudC5zbGljZSgwLDUpID09IFwiU29ycnlcIikpIHtcbiAgICAgICAgICAgIG1vZGVsLnNwb3RzLmZvckVhY2goIGZ1bmN0aW9uIChzcG90KSB7XG4gICAgICAgICAgICAgICAgYnVpbGRTbGlkZUNvbnRlbnQoc3BvdCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB2aWV3TW9kZWwuc3BvdExpc3QobW9kZWwuc3BvdHMpO1xuICAgIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7fSk7XG4gICAgbWFwLnNldFpvb20obW9kZWwuem9vbUxldmVsKTtcbiAgICBtYXAuc2V0Q2VudGVyKG1vZGVsLmNlbnRlcik7XG4gICAgbW9kZWwuc3BvdHMuZm9yRWFjaCggZnVuY3Rpb24oc3BvdCkge1xuICAgICAgICB2bVNwb3RzLnB1c2gobmV3IFNwb3Qoc3BvdCkpO1xuICAgIH0pO1xuICAgIC8vIHN0YXkgY2VudHJlZFxuICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZERvbUxpc3RlbmVyKHdpbmRvdywgJ3Jlc2l6ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICBtYXAuc2V0Q2VudGVyKG1vZGVsLmNlbnRlcik7XG4gICAgfSk7XG4gICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBsb2NhbFN0b3JhZ2UubW9kZWwgPSBKU09OLnN0cmluZ2lmeShtb2RlbCk7XG4gICAgfSwgMzAwMCk7XG59XG5cbi8vIGNvbnN0cnVjdG9yXG52YXIgU3BvdCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XG4gIHRoaXMubG9jYXRpb24gPSBkYXRhLmxvY2F0aW9uO1xuICB0aGlzLnNsaWRlQ29udGVudCA9IGRhdGEuc2xpZGVDb250ZW50O1xuICB0aGlzLm1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICBwb3NpdGlvbjogdGhpcy5sb2NhdGlvbixcbiAgICAgICAgdGl0bGU6IHRoaXMubmFtZSxcbiAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgIG9wYWNpdHk6IDAuNFxuICB9KTtcbiAgdGhpcy53aW5kb3dDb250ZW50ID0gYnVpbGRXaW5kb3dDb250ZW50KHRoaXMubWFya2VyKTtcbiAgdGhpcy5jbGlja0V2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodGhpcy5tYXJrZXIsIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LmRvT3BlbmluZygpO1xuICAgIH0pO1xuICB0aGlzLm92ZXJFdmVudCA9IGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHRoaXMubWFya2VyLCBcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuaGlMaWdodExpc3RJdGVtKCk7XG5cbiAgfSk7XG4gIHRoaXMub3V0RXZlbnQgPSBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcmtlciwgXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQubG9MaWdodExpc3RJdGVtKCk7XG5cbiAgfSk7XG59O1xuXG5TcG90LnByb3RvdHlwZS5oaUxpZ2h0TGlzdEl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICAkKFwibGk6Y29udGFpbnMoXCIgKyB0aGF0Lm5hbWUgKyBcIilcIikudG9nZ2xlQ2xhc3MoIFwiaGlsaWdodCB1bmRlclwiICk7XG59O1xuXG5TcG90LnByb3RvdHlwZS5sb0xpZ2h0TGlzdEl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICQoXCJsaTpjb250YWlucyhcIiArIHRoYXQubmFtZSArIFwiKVwiKS50b2dnbGVDbGFzcyhcImhpbGlnaHQgdW5kZXJcIik7XG59O1xuXG5TcG90LnByb3RvdHlwZS5kb0JvdW5jZSA9IGZ1bmN0aW9uICgpICB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICB0aGlzLm1hcmtlci5zZXRBbmltYXRpb24oZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkJPVU5DRSk7XG59O1xuXG5TcG90LnByb3RvdHlwZS5zdG9wQm91bmNlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbn1cblxuU3BvdC5wcm90b3R5cGUuZG9PcGVuaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBjbGVhblVwU2NyZWVuKCk7XG4gICAgdGhpcy5tYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhhdC5vcGVuV2luZG93KCk7XG4gICAgICAgIHRoYXQubWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgICB9LCAxMDAwKTtcbn07XG5cblNwb3QucHJvdG90eXBlLm9wZW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmlld01vZGVsLmxpc3RDb2xsYXBzZSgpO1xuICAgIGluZm93aW5kb3cuc2V0Q29udGVudCh0aGlzLndpbmRvd0NvbnRlbnQpO1xuICAgIGluZm93aW5kb3cub3BlbihtYXAsIHRoaXMubWFya2VyKTtcbn07XG5cblNwb3QucHJvdG90eXBlLmhpZGVNYXJrZXIgPSBmdW5jdGlvbiAoKSB7IHRoaXMubWFya2VyLnNldE1hcChudWxsKTsgfTtcblNwb3QucHJvdG90eXBlLnNob3dNYXJrZXIgPSBmdW5jdGlvbiAoKSB7IHRoaXMubWFya2VyLnNldE1hcChtYXApOyB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vS08gVklFV01PREVMLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgVmlld01vZGVsID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIC8vIERhdGFcbiAgICBzZWxmLmxpc3RPbiA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XG4gICAgc2VsZi5idXJnZXJNZW51ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zcG90TGlzdCA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xuICAgIHNlbGYuc2xpZGVPbiA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICAgIHNlbGYuc2xpZGVDb250ZW50ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuZmlsdGVyU2xvdCA9IGtvLm9ic2VydmFibGUoKTtcbiAgICBzZWxmLmlzU2VsZWN0ZWQgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcblxuICAgIC8vIEJlaGF2aW91cnNcblxuICAgIHNlbGYuYm91bmNlTWFya2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdCh0aGlzLm5hbWUpO1xuICAgICAgICBzcG90LmRvQm91bmNlKCk7XG4gICAgfTtcblxuICAgIHNlbGYudW5ib3VuY2VNYXJrZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdCh0aGlzLm5hbWUpO1xuICAgICAgICBzcG90LnN0b3BCb3VuY2UoKTtcbiAgICB9XG5cbiAgICBzZWxmLnNwb3RQaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdCh0aGlzLm5hbWUpO1xuICAgICAgICBzcG90LmRvT3BlbmluZygpO1xuICAgIH07XG4gICAgc2VsZi5zZXRGaWx0ZXJTZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmlzU2VsZWN0ZWQodHJ1ZSk7XG4gICAgICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgfTtcbiAgICBzZWxmLmZpbHRlclNsb3Quc3Vic2NyaWJlKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIHNlbGYuc3BvdExpc3QoZmlsdGVyTGlzdChkYXRhLCB2bVNwb3RzKSk7XG4gICAgICAgIHJlc2V0TWFya2VycyhzZWxmLnNwb3RMaXN0KCkpO1xuICAgIH0pO1xuICAgIHNlbGYub25FbnRlciA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93LmFuY2hvcikge1xuICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc3BvdExpc3QoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zcG90TGlzdCgpWzBdLmRvT3BlbmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93KSBpbmZvd2luZG93LmNsb3NlKCk7IC8vZm9yIGFueSBvdGhlciBrZXlwcmVzc1xuICAgICAgICAgICAgc2VsZi5zbGlkZU9mZigpO1xuICAgICAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIG5lY2Vzc2FyeSB0byByZWZsZWN0IHRoZSB0ZXh0IGluIHRoZSBzbG90XG4gICAgfTtcbiAgICBzZWxmLmxpc3RDb2xsYXBzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9kaXNhYmxlIGZvciBiaWcgc2NyZWVuOyBlbmFibGUgZm9yIHNtYWxsXG4gICAgICAgIHZhciBtZWRpYXF1ZXJ5ID0gd2luZG93Lm1hdGNoTWVkaWEoIFwiKG1heC13aWR0aDogNTQ5cHgpXCIgKTtcbiAgICAgICAgaWYgKG1lZGlhcXVlcnkubWF0Y2hlcykge1xuICAgICAgICAgICAgc2VsZi5saXN0T24oZmFsc2UpO1xuICAgICAgICAgICAgc2VsZi5idXJnZXJNZW51KHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzZWxmLmxpc3RFeHBhbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFuVXBTY3JlZW4oKTtcbiAgICAgICAgc2VsZi5idXJnZXJNZW51KGZhbHNlKTtcbiAgICAgICAgc2VsZi5saXN0T24odHJ1ZSk7XG4gICAgfTtcbiAgICBzZWxmLm9wZW5BUElzbGlkZSA9IGZ1bmN0aW9uIChzcG90TmFtZSkge1xuICAgICAgICB2YXIgc3BvdCA9IGdldFNwb3Qoc3BvdE5hbWUpO1xuICAgICAgICBpZiAoIShzcG90LnNsaWRlQ29udGVudCkpIHtcbiAgICAgICAgICAgIGR1YlNsaWRlQ29udGVudHMoKTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3TW9kZWwuc2xpZGVDb250ZW50KHNwb3Quc2xpZGVDb250ZW50KTtcbiAgICAgICAgdmlld01vZGVsLnNsaWRlT24odHJ1ZSk7XG4gICAgfTtcbiAgICBzZWxmLnNsaWRlT2ZmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNsaWRlT24oZmFsc2UpO1xuICAgIH07XG59O1xuXG52YXIgdmlld01vZGVsID0gbmV3IFZpZXdNb2RlbCgpO1xua28uYXBwbHlCaW5kaW5ncyh2aWV3TW9kZWwpO1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUhFTFBFUiBGVU5DVElPTlMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vL3Rlc3QgYXJyYXkgYWdhaW5zdCBhIHJlZ3VsYXIgZXhwcmVzc2lvblxuZnVuY3Rpb24gZmlsdGVyTGlzdCh1c2VyVGV4dCwgbW9kZWxBcnJheSkge1xuICAgICB2YXIgcmVzdWx0PVtdLFxuICAgICAgICAgcmUgPSBuZXcgUmVnRXhwKHVzZXJUZXh0LCBbJ2knXSk7XG4gICAgIG1vZGVsQXJyYXkuZm9yRWFjaCggZnVuY3Rpb24oZWxlbWVudCwgaW5kZXgsIGFycmF5KSB7XG4gICAgICAgIGlmIChyZS50ZXN0KGVsZW1lbnQubmFtZSkpIHJlc3VsdC5wdXNoKGVsZW1lbnQpO1xuICAgICB9KTtcbiAgICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZ2V0U3BvdChuYW1lKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICB2bVNwb3RzLmZvckVhY2goIGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICBpZiAoc3BvdC5uYW1lID09IG5hbWUpIHJlc3VsdCA9IHNwb3Q7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gZWRpdCB0aGUgc2V0IG9mIGRpc3BsYXllZCBtYXJrZXJzIGJhc2VkIG9uIHRoZSBmaWx0ZXJlZCBzcG90TGlzdFxuZnVuY3Rpb24gcmVzZXRNYXJrZXJzKHNwb3RzKSB7XG4gICAgdm1TcG90cy5mb3JFYWNoKGZ1bmN0aW9uKHNwb3QpIHtcbiAgICAgICAgc3BvdC5oaWRlTWFya2VyKCk7XG4gICAgfSk7XG4gICAgc3BvdHMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGdldFNwb3QoaXRlbS5uYW1lKS5zaG93TWFya2VyKCk7XG4gICAgfSk7XG59XG5cbi8vIGNhbGxlZCBpbiB0aGUgY2xpY2sgZXZlbnQgbGlzdGVuZXIgb2YgaW5mb1dpbmRvd1xuZnVuY3Rpb24gaXRjaHdpbmRvdygpIHtcbiAgICB2aWV3TW9kZWwub3BlbkFQSXNsaWRlKGluZm93aW5kb3cuYW5jaG9yLnRpdGxlKTtcbn1cblxuLy8gZ2V0IHJpZCBvZiBvbGQgb3Zlci1sYXlzXG5mdW5jdGlvbiBjbGVhblVwU2NyZWVuKCkge1xuICAgIGluZm93aW5kb3cuY2xvc2UoKTtcbiAgICBtYXAuc2V0Wm9vbShtb2RlbC56b29tTGV2ZWwpO1xuICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICB2aWV3TW9kZWwuc2xpZGVPZmYoKTtcbn1cblxuZnVuY3Rpb24gZHViU2xpZGVDb250ZW50cygpIHtcbiAgICBpZiAobW9kZWwuc3BvdHNbMF0uc2xpZGVDb250ZW50KSB7XG4gICAgICAgIGZvciAodmFyIGkgaW4gbW9kZWwuc3BvdHMpIHtcbiAgICAgICAgICAgIHZtU3BvdHNbaV0uc2xpZGVDb250ZW50ID0gbW9kZWwuc3BvdHNbaV0uc2xpZGVDb250ZW50O1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLm1vZGVsID0gSlNPTi5zdHJpbmdpZnkobW9kZWwpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PVRIRSBFTkQ9PT09PT09PT09PT09PT09PT09XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8vZnJvbSBodHRwczovL2RldmVsb3Blci5mb3Vyc3F1YXJlLmNvbS9vdmVydmlldy9hdXRoI3VzZXJsZXNzXG4vL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2g/bGw9NDAuNywtNzQmY2xpZW50X2lkPUNMSUVOVF9JRCZjbGllbnRfc2VjcmV0PUNMSUVOVF9TRUNSRVQmdj1ZWVlZTU1ERFxuXG4vL2ZvdXJzcXVhcmUuY29tL3YvYnJvYWR3YXktc3RhdGlvbi1zdXNoaS80YWFlOWNiN2Y5NjRhNTIwOWI2MjIwZTNcbnZhciBrciA9IHtcbiAgICBmb3Vyc3F1YXJlOiB7XG4gICAgICAgIE93bmVyOiBcIktSIERlY2tlclwiLFxuICAgICAgICBDbGllbnRfaWQ6IFwiWlZMS1RLU0dVTEZFUTNYTVdXSTNBTDFBMktYWUJFS0QxTEtTVVJVWkRHWlk0MUpYXCIsXG4gICAgICAgIENsaWVudF9zZWNyZXQ6IFwiVE1UMjAzREhXT1BSM1I0UlNNMUhFNFJNT0tFV0xHVFQwRkxNWk1VWjFPSkhNQUsxXCJcbiAgICB9LFxuICAgIHllbHA6IHtcbiAgICAgICAgQ29uc3VtZXJfS2V5OiAgICBcIlhyeEpPVWdHTktxOVp1V2hCWDFMRHdcIixcbiAgICAgICAgQ29uc3VtZXJfU2VjcmV0OiBcInpyMkk3Nm5UOGwwTy10cmt1cFlFMDBCOUJUQVwiLFxuICAgICAgICBUb2tlbjogICBcIi1fRjhhT3hvblI2cTVTcXZVUnd3Z0xJZFUtcXRlUy1CXCIsXG4gICAgICAgIFRva2VuX1NlY3JldDogICAgXCJHRjd1UmNQV0NwemxIY1JQM0RpSldqdmNYSkVcIlxuICAgIH0sXG4gICAgc3RyZWV0dmlldzoge1xuICAgICAgICBrZXk6IFwiQUl6YVN5QVA2MzF6NldxTW9wdG9hR2hlcmhKVkJHeU4xdVBIUHQ0XCJcbiAgICB9XG59O1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
