"use strict";function getModel(){return localStorage.model?JSON.parse(localStorage.model):EatsModel}function buildWindowContent(e){var t="http://maps.googleapis.com/maps/api/streetview?size=300x250&location="+e.position.toString().slice(1,-1),o='<img class="bgimg" src="'+t+'">',n='"height:100%;width:80%"',i='<div onclick="itchwindow()" style='+n+">"+o+'<br><span style="color:darkgreen">'+e.title+'</span><br><span style="color:red">-CLICK FOR MORE INFO-</span></div>';return i}function buildSlideContent(e){function t(t,i){console.log("In getVenueInfo: status = "+i);var a=t.response.venues[0];$.ajax({url:fourSquareURL+"/v2/venues/"+a.id,dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:o,error:n})}function o(t){var o=t.response.venue;i="FourSquare info: <br><br>"+o.name+"<br>"+o.contact.formattedPhone+"<br>- "+o.location.address+"<br>- "+o.location.city+"<br>- "+o.location.country+"<br>x-street: "+o.location.crossStreet+"<br>Check-ins: "+o.stats.checkinsCount.toString()+"<br>"+o.likes.summary+'<br><br><span style="background-color:#'+o.ratingColor+';color:black;padding:1%">Rating: '+o.rating.toString()+'</span><br><img src="'+o.bestPhoto.prefix+"cap300"+o.bestPhoto.suffix+'">',updateSlideContent(e,i)}function n(t,o,n){var i="Sorry. 3rd party info unavailable.";updateSlideContent(e,i)}var i="",s="ll="+e.location.lat.toString()+","+e.location.lng.toString();$.ajax({url:fourSquareURL+"/v2/venues/search",dataType:"json",data:"limit=1&"+s+"&query="+e.name+"&client_id="+kr.foursquare.Client_id+"&client_secret="+kr.foursquare.Client_secret+"&v=20160130",async:!0,success:t,error:n})}function updateSlideContent(e,t){e.slideContent=t;var o=getSpot(e.name);o&&(console.log("in updateSlideContent: viewSpot "),o.slideContent=t)}function init(){map=new google.maps.Map(document.getElementById("map-div"),mapOptions),model=getModel(),(void 0===model.spots[0].slideContent||"Sorry"==model.spots[0].slideContent.slice(0,5))&&model.spots.forEach(function(e){buildSlideContent(e)}),viewModel.spotList(model.spots),viewModel.filterOn(!narrowScreen()),infowindow=new google.maps.InfoWindow({}),map.setZoom(model.zoomLevel),map.setCenter(model.center),model.spots.forEach(function(e){vmSpots.push(new Spot(e))}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(model.center),viewModel.filterOn(!narrowScreen())}),window.setTimeout(function(){localStorage.model=JSON.stringify(model)},3e3)}function filterList(e,t){var o=[],n=new RegExp(e,["i"]);return t.forEach(function(e,t,i){n.test(e.name)&&o.push(e)}),o}function getSpot(e){for(var t=0;t<vmSpots.length;t++)if(vmSpots[t].name==e)return vmSpots[t]}function resetMarkers(e){vmSpots.forEach(function(e){e.hideMarker()}),e.forEach(function(e){getSpot(e.name).showMarker()})}function itchwindow(){viewModel.openAPIslide(infowindow.anchor.title)}function cleanUpScreen(){infowindow.close(),map.setZoom(model.zoomLevel),map.setCenter(model.center),viewModel.slideOff(),$("ul.spot-list li").removeClass("hilight under")}function dubSlideContents(){model.spots[0].slideContent&&model.spots.forEach(function(e,t){vmSpots[t].slideContent=e.slideContent,localStorage.model=JSON.stringify(model)})}function narrowScreen(){var e=window.matchMedia("(max-width: 549px)");return e.matches?!0:void 0}var EatsModel={zoomLevel:18,center:{lat:49.262387,lng:-123.069956},spots:[{name:"Uncle Fatih's Pizza",location:{lat:49.262437,lng:-123.070215},category:"pizza"},{name:"Buddha's Orient Express",location:{lat:49.262719,lng:-123.069289},category:"asian"},{name:"Booster Juice",location:{lat:49.262641,lng:-123.069438},category:"juice"},{name:"Starbucks Coffee",location:{lat:49.261874,lng:-123.070076},category:"coffee"},{name:"Blenz Coffee",location:{lat:49.262534,lng:-123.069529},category:"coffee"},{name:"Megabite Pizza",location:{lat:49.262779,lng:-123.069317},category:"pizza"},{name:"Broadway Station Sushi",location:{lat:49.262084,lng:-123.070962},category:"asian"}]},model={},fourSquareURL="https://api.foursquare.com",map,vmSpots=[],infowindow,RedRoadsNGreenBusStops=[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{gamma:.65},{hue:"#ff9c30"},{visibility:"on"},{saturation:99},{lightness:-12}]},{featureType:"transit",stylers:[{hue:"#00ff33"},{gamma:.6},{saturation:5},{visibility:"on"},{weight:4.6},{lightness:-12}]}],mapOptions={center:{lat:49.262387,lng:-123.069868},zoom:16,zoomControl:!0,scrollwheel:!1,draggable:!0,disableDoubleClickZoom:!0,disableDefaultUI:!0,styles:RedRoadsNGreenBusStops},icons={asian:{icon:"img/asian.png"},coffee:{icon:"img/coffee.png"},food:{icon:"img/food.png"},juice:{icon:"img/juice.png"},pizza:{icon:"img/pizza.png"}},Spot=function(e){var t=this;this.name=e.name,this.location=e.location,this.category=e.category,this.slideContent=e.slideContent,this.marker=new google.maps.Marker({position:this.location,title:this.name,icon:icons[this.category].icon,map:map,opacity:.4}),this.windowContent=buildWindowContent(this.marker),this.clickEvent=google.maps.event.addListener(this.marker,"click",function(){t.doOpening()}),this.overEvent=google.maps.event.addListener(this.marker,"mouseover",function(){t.hiLightListItem()}),this.outEvent=google.maps.event.addListener(this.marker,"mouseout",function(){t.loLightListItem()})};Spot.prototype.hiLightListItem=function(){var e=this;cleanUpScreen(),$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.loLightListItem=function(){var e=this;$("li:contains("+e.name+")").toggleClass("hilight under")},Spot.prototype.doBounce=function(){cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE)},Spot.prototype.stopBounce=function(){this.marker.setAnimation(null)},Spot.prototype.doOpening=function(){var e=this;cleanUpScreen(),this.marker.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.openWindow(),e.marker.setAnimation(null)},1e3)},Spot.prototype.openWindow=function(){var e=this;viewModel.listCollapse(),infowindow.setContent(this.windowContent),infowindow.open(map,this.marker),this.closeEvent=google.maps.event.addListener(infowindow,"closeclick",function(){cleanUpScreen(),viewModel.listExpand(),google.maps.event.removeListener(e.closeEvent)})},Spot.prototype.hideMarker=function(){this.marker.setMap(null)},Spot.prototype.showMarker=function(){this.marker.setMap(map)};var ViewModel=function(){var e=this;e.listOn=ko.observable(!0),e.burgerMenu=ko.observable(!1),e.spotList=ko.observableArray(),e.slideOn=ko.observable(!1),e.slideContent=ko.observable(),e.filterOn=ko.observable(!0),e.filterSlot=ko.observable(),e.isSelected=ko.observable(!1),e.bounceMarker=function(){var e=getSpot(this.name);e.doBounce()},e.unbounceMarker=function(){var e=getSpot(this.name);e.stopBounce()},e.spotPick=function(){var e=getSpot(this.name);e.doOpening()},e.setFilterSelected=function(){this.isSelected(!0),cleanUpScreen(),e.listExpand()},e.filterSlot.subscribe(function(t){e.listExpand(),e.spotList(filterList(t,vmSpots)),resetMarkers(e.spotList())}),e.onEnter=function(t,o){return 13===o.keyCode?infowindow.anchor?e.openAPIslide(infowindow.anchor.title):1===e.spotList().length&&e.spotList()[0].doOpening():(infowindow&&infowindow.close(),e.slideOff(),e.listExpand()),!0},e.listCollapse=function(){narrowScreen()&&(e.listOn(!1),e.burgerMenu(!0))},e.listExpand=function(){cleanUpScreen(),e.burgerMenu(!1),e.listOn(!0)},e.openAPIslide=function(e){var t=getSpot(e);t.slideContent||dubSlideContents(),viewModel.slideContent(t.slideContent),viewModel.slideOn(!0)},e.slideOff=function(){this.slideOn(!1)}},viewModel=new ViewModel;ko.applyBindings(viewModel);var kr={foursquare:{Owner:"KR Decker",Client_id:"ZVLKTKSGULFEQ3XMWWI3AL1A2KXYBEKD1LKSURUZDGZY41JX",Client_secret:"TMT203DHWOPR3R4RSM1HE4RMOKEWLGTT0FLMZMUZ1OJHMAK1"},yelp:{Consumer_Key:"XrxJOUgGNKq9ZuWhBX1LDw",Consumer_Secret:"zr2I76nT8l0O-trkupYE00B9BTA",Token:"-_F8aOxonR6q5SqvURwwgLIdU-qteS-B",Token_Secret:"GF7uRcPWCpzlHcRP3DiJWjvcXJE"},streetview:{key:"AIzaSyAP631z6WqMoptoaGherhJVBGyN1uPHPt4"}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnZXRNb2RlbCIsImxvY2FsU3RvcmFnZSIsIm1vZGVsIiwiSlNPTiIsInBhcnNlIiwiRWF0c01vZGVsIiwiYnVpbGRXaW5kb3dDb250ZW50IiwibWFya2VyIiwic3RyZWV0dmlld1VybCIsInBvc2l0aW9uIiwidG9TdHJpbmciLCJzbGljZSIsInBpY3R1cmUiLCJjc3MiLCJjb250ZW50IiwidGl0bGUiLCJidWlsZFNsaWRlQ29udGVudCIsInNwb3QiLCJnZXRWZW51ZUluZm8iLCJkYXRhIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInZlbnVlIiwicmVzcG9uc2UiLCJ2ZW51ZXMiLCIkIiwiYWpheCIsInVybCIsImZvdXJTcXVhcmVVUkwiLCJpZCIsImRhdGFUeXBlIiwibG9jIiwibmFtZSIsImtyIiwiZm91cnNxdWFyZSIsIkNsaWVudF9pZCIsIkNsaWVudF9zZWNyZXQiLCJhc3luYyIsInN1Y2Nlc3MiLCJmb3JtYXRTaG93RGF0YSIsImVycm9yIiwic2VuZEVycm9yIiwiZm9ybWF0dGVkRGF0YSIsImNvbnRhY3QiLCJmb3JtYXR0ZWRQaG9uZSIsImxvY2F0aW9uIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiY3Jvc3NTdHJlZXQiLCJzdGF0cyIsImNoZWNraW5zQ291bnQiLCJsaWtlcyIsInN1bW1hcnkiLCJyYXRpbmdDb2xvciIsInJhdGluZyIsImJlc3RQaG90byIsInByZWZpeCIsInN1ZmZpeCIsInVwZGF0ZVNsaWRlQ29udGVudCIsIm9iamVjdCIsImV4Y2VwdGlvbiIsImFqYXhfZXJyb3IiLCJsYXQiLCJsbmciLCJkYXRhU3RyaW5nIiwic2xpZGVDb250ZW50Iiwidm1TcG90IiwiZ2V0U3BvdCIsImluaXQiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1hcE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzcG90cyIsImZvckVhY2giLCJ2aWV3TW9kZWwiLCJzcG90TGlzdCIsImZpbHRlck9uIiwibmFycm93U2NyZWVuIiwiaW5mb3dpbmRvdyIsIkluZm9XaW5kb3ciLCJzZXRab29tIiwiem9vbUxldmVsIiwic2V0Q2VudGVyIiwiY2VudGVyIiwidm1TcG90cyIsInB1c2giLCJTcG90IiwiZXZlbnQiLCJhZGREb21MaXN0ZW5lciIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJzdHJpbmdpZnkiLCJmaWx0ZXJMaXN0IiwidXNlclRleHQiLCJtb2RlbEFycmF5IiwicmVzdWx0IiwicmUiLCJSZWdFeHAiLCJlbGVtZW50IiwiaW5kZXgiLCJhcnJheSIsInRlc3QiLCJpIiwibGVuZ3RoIiwicmVzZXRNYXJrZXJzIiwiaGlkZU1hcmtlciIsIml0ZW0iLCJzaG93TWFya2VyIiwiaXRjaHdpbmRvdyIsIm9wZW5BUElzbGlkZSIsImFuY2hvciIsImNsZWFuVXBTY3JlZW4iLCJjbG9zZSIsInNsaWRlT2ZmIiwicmVtb3ZlQ2xhc3MiLCJkdWJTbGlkZUNvbnRlbnRzIiwibWVkaWFxdWVyeSIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwiY2F0ZWdvcnkiLCJSZWRSb2Fkc05HcmVlbkJ1c1N0b3BzIiwiZmVhdHVyZVR5cGUiLCJlbGVtZW50VHlwZSIsInN0eWxlcnMiLCJ2aXNpYmlsaXR5IiwiZ2FtbWEiLCJodWUiLCJzYXR1cmF0aW9uIiwibGlnaHRuZXNzIiwid2VpZ2h0Iiwiem9vbSIsInpvb21Db250cm9sIiwic2Nyb2xsd2hlZWwiLCJkcmFnZ2FibGUiLCJkaXNhYmxlRG91YmxlQ2xpY2tab29tIiwiZGlzYWJsZURlZmF1bHRVSSIsInN0eWxlcyIsImljb25zIiwiYXNpYW4iLCJpY29uIiwiY29mZmVlIiwiZm9vZCIsImp1aWNlIiwicGl6emEiLCJ0aGF0IiwidGhpcyIsIk1hcmtlciIsIm9wYWNpdHkiLCJ3aW5kb3dDb250ZW50IiwiY2xpY2tFdmVudCIsImFkZExpc3RlbmVyIiwiZG9PcGVuaW5nIiwib3ZlckV2ZW50IiwiaGlMaWdodExpc3RJdGVtIiwib3V0RXZlbnQiLCJsb0xpZ2h0TGlzdEl0ZW0iLCJwcm90b3R5cGUiLCJ0b2dnbGVDbGFzcyIsImRvQm91bmNlIiwic2V0QW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiQk9VTkNFIiwic3RvcEJvdW5jZSIsIm9wZW5XaW5kb3ciLCJsaXN0Q29sbGFwc2UiLCJzZXRDb250ZW50Iiwib3BlbiIsImNsb3NlRXZlbnQiLCJsaXN0RXhwYW5kIiwicmVtb3ZlTGlzdGVuZXIiLCJzZXRNYXAiLCJWaWV3TW9kZWwiLCJzZWxmIiwibGlzdE9uIiwia28iLCJvYnNlcnZhYmxlIiwiYnVyZ2VyTWVudSIsIm9ic2VydmFibGVBcnJheSIsInNsaWRlT24iLCJmaWx0ZXJTbG90IiwiaXNTZWxlY3RlZCIsImJvdW5jZU1hcmtlciIsInVuYm91bmNlTWFya2VyIiwic3BvdFBpY2siLCJzZXRGaWx0ZXJTZWxlY3RlZCIsInN1YnNjcmliZSIsIm9uRW50ZXIiLCJrZXlDb2RlIiwic3BvdE5hbWUiLCJhcHBseUJpbmRpbmdzIiwiT3duZXIiLCJ5ZWxwIiwiQ29uc3VtZXJfS2V5IiwiQ29uc3VtZXJfU2VjcmV0IiwiVG9rZW4iLCJUb2tlbl9TZWNyZXQiLCJzdHJlZXR2aWV3Iiwia2V5Il0sIm1hcHBpbmdzIjoiQUFPQSxZQXFEQSxTQUFTQSxZQUNMLE1BQUlDLGNBQWFDLE1BQ05DLEtBQUtDLE1BQU1ILGFBQWFDLE9BRXhCRyxVQUtmLFFBQVNDLG9CQUFtQkMsR0FDeEIsR0FBSUMsR0FBZ0Isd0VBQ0lELEVBQU9FLFNBQVNDLFdBQVdDLE1BQU0sRUFBRSxJQUl2REMsRUFBVSwyQkFBNkJKLEVBQWdCLEtBQ3ZESyxFQUFNLDBCQUNOQyxFQUFVLHFDQUNFRCxFQUFNLElBQU1ELEVBQVUscUNBQ3RCTCxFQUFPUSxNQUFRLHVFQUcvQixPQUFPRCxHQVVYLFFBQVNFLG1CQUFrQkMsR0FxQnZCLFFBQVNDLEdBQWFDLEVBQU1DLEdBQ3hCQyxRQUFRQyxJQUFJLDZCQUErQkYsRUFDM0MsSUFBSUcsR0FBUUosRUFBS0ssU0FBU0MsT0FBTyxFQUVqQ0Ms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LE9BQ1Q4RCxFQUFLL0QsYUFBYS9CLFdBQVdnQyxPQUFPdEcsT0FHUCxJQUEzQm9LLEVBQUtqRyxXQUFXNEIsUUFDaEJxRSxFQUFLakcsV0FBVyxHQUFHNEUsYUFLdkJ6RSxZQUFZQSxXQUFXa0MsUUFDM0I0RCxFQUFLM0QsV0FDTDJELEVBQUtKLGVBRUYsR0FHWEksRUFBS1IsYUFBZSxXQVFadkYsaUJBQ0YrRixFQUFLQyxRQUFPLEdBQ1pELEVBQUtJLFlBQVcsS0FJdEJKLEVBQUtKLFdBQWEsV0FDZHpELGdCQUNBNkQsRUFBS0ksWUFBVyxHQUNoQkosRUFBS0MsUUFBTyxJQUdoQkQsRUFBSy9ELGFBQWUsU0FBVStFLEdBQzFCLEdBQUlsTCxHQUFPb0QsUUFBUThILEVBQ2JsTCxHQUFpQixjQUNuQnlHLG1CQUVKekMsVUFBVWQsYUFBYWxELEVBQUtrRCxjQUM1QmMsVUFBVXdHLFNBQVEsSUFHdEJOLEVBQUszRCxTQUFXLFdBQ1pnQyxLQUFLaUMsU0FBUSxLQUlqQnhHLFVBQVksR0FBSWlHLFVBQ3BCRyxJQUFHZSxjQUFjbkgsVUFrSmpCLElBQUkvQyxLQUNBQyxZQUNJa0ssTUFBTyxZQUNQakssVUFBVyxtREFDWEMsY0FBZSxvREFFbkJpSyxNQUNJQyxhQUFpQix5QkFDakJDLGdCQUFpQiw4QkFDakJDLE1BQVMsbUNBQ1RDLGFBQWlCLCtCQUVyQkMsWUFDSUMsSUFBSyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vKGZ1bmN0aW9uICgpIHtcbi8vICAgJ3VzZSBzdHJpY3QnO1xuICAgLy8gdGhpcyBmdW5jdGlvbiBpcyBzdHJpY3QuLi5cblxuXG5cbid1c2Ugc3RyaWN0Jztcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL01PREVMLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLyBlYXRzIGRhdGE6IGFuIGFycmF5IG9mIHBsYWNlcyB0byBlYXRcbi8vIGFyb3VuZCBDb21tZXJjaWFsLUJyb2Fkd2F5IFN0YXRpb25cbi8vIEVhc3QgVmFuXG4vLyBCcml0aXNoIENvbHVtYmlhXG5cbi8vIGJhc2ljIGRhdGEsIGxvYWRlZCBpZiBtb3JlIGRldGFpbGVkIG1vZGVsIG5vdCBmb3VuZCBpbiBsb2NhbFN0b3JhZ2VcbnZhciBFYXRzTW9kZWwgPSB7XG4gICAgem9vbUxldmVsOiAxOCxcbiAgICBjZW50ZXI6IHtsYXQ6IDQ5LjI2MjM4NywgbG5nOiAtMTIzLjA2OTk1Nn0sLy80OS4yNjIzODcsIC0xMjMuMDY5NzY4XG4gICAgc3BvdHM6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJVbmNsZSBGYXRpaCdzIFBpenphXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNDM3LCBsbmc6IC0xMjMuMDcwMjE1fSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcInBpenphXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCdWRkaGEncyBPcmllbnQgRXhwcmVzc1wiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjcxOSwgbG5nOiAtMTIzLjA2OTI4OX0sXG4gICAgICAgICAgICBjYXRlZ29yeTogXCJhc2lhblwiXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiQm9vc3RlciBKdWljZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjY0MSwgbG5nOiAtMTIzLjA2OTQzOH0sXG4gICAgICAgICAgICBjYXRlZ29yeTogXCJqdWljZVwiXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwiU3RhcmJ1Y2tzIENvZmZlZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MTg3NCwgbG5nOiAtMTIzLjA3MDA3Nn0sXG4gICAgICAgICAgICBjYXRlZ29yeTogXCJjb2ZmZWVcIlxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIkJsZW56IENvZmZlZVwiLFxuICAgICAgICAgICAgbG9jYXRpb246IHtsYXQ6IDQ5LjI2MjUzNCwgbG5nOiAtMTIzLjA2OTUyOX0sXG4gICAgICAgICAgICBjYXRlZ29yeTogXCJjb2ZmZWVcIlxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiBcIk1lZ2FiaXRlIFBpenphXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyNzc5LCBsbmc6IC0xMjMuMDY5MzE3fSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcInBpenphXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJCcm9hZHdheSBTdGF0aW9uIFN1c2hpXCIsXG4gICAgICAgICAgICBsb2NhdGlvbjoge2xhdDogNDkuMjYyMDg0LCBsbmc6IC0xMjMuMDcwOTYyfSxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBcImFzaWFuXCJcbiAgICAgICAgfVxuICAgIF1cbn07XG5cbnZhciBtb2RlbCA9IHt9O1xuXG5mdW5jdGlvbiBnZXRNb2RlbCgpIHtcbiAgICBpZiAobG9jYWxTdG9yYWdlLm1vZGVsKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5tb2RlbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIEVhdHNNb2RlbDtcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gYnVpbGRXaW5kb3dDb250ZW50KG1hcmtlcikge1xuICAgIHZhciBzdHJlZXR2aWV3VXJsID0gJ2h0dHA6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL3N0cmVldHZpZXc/c2l6ZT0zMDB4MjUwJmxvY2F0aW9uPScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlci5wb3NpdGlvbi50b1N0cmluZygpLnNsaWNlKDEsLTEpIDsvLyArICcma2V5PScgKyBrci5zdHJlZXR2aWV3LmtleTtcbiAgICAvLyBtYXJrZXIucG9zaXRpb24udG9TdHJpbmcoKSBtZXRob2QgY2hhbmdlZCB0byBpbmNsdWRlIHBhcmVudGhlc2VzLCBoZW5jZSB0aGUgc2xpY2VcbiAgICAvLyBrZXkgbm90IHJlcXVpcmVkXG5cbiAgICB2YXIgcGljdHVyZSA9ICc8aW1nIGNsYXNzPVwiYmdpbWdcIiBzcmM9XCInICsgc3RyZWV0dmlld1VybCArICdcIj4nO1xuICAgIHZhciBjc3MgPSAnXCJoZWlnaHQ6MTAwJTt3aWR0aDo4MCVcIic7XG4gICAgdmFyIGNvbnRlbnQgPSAnPGRpdiBvbmNsaWNrPVwiaXRjaHdpbmRvdygpXCIgc3R5bGU9JyArXG4gICAgICAgICAgICAgICAgICAgIGNzcyArICc+JyArIHBpY3R1cmUgKyAnPGJyPjxzcGFuIHN0eWxlPVwiY29sb3I6ZGFya2dyZWVuXCI+JyArXG4gICAgICAgICAgICAgICAgICAgIG1hcmtlci50aXRsZSArICc8L3NwYW4+JyArXG4gICAgICAgICAgICAgICAgICAgICc8YnI+PHNwYW4gc3R5bGU9XCJjb2xvcjpyZWRcIj4tQ0xJQ0sgRk9SIE1PUkUgSU5GTy08L3NwYW4+PC9kaXY+JztcblxuICAgIHJldHVybiBjb250ZW50O1xufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDNyZCBwYXJ0eSBBUEkgc3R1ZmZcbnZhciBmb3VyU3F1YXJlVVJMID0gJ2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tJztcblxuLy8gZ2V0IGNvbnRlbnQgZm9yIGluZm8gc2xpZGVzIGZyb20gM3JkIHBhcnR5IHNvdXJjZXNcbi8vIGJhc2VkIG9uIGluZm8gZnJvbSBtb2RlbFxuLy8gdGhlbiBhZGQgdG8gbW9kZWwgYW5kIHRvIHZpZXcgb2JqZWN0c1xuZnVuY3Rpb24gYnVpbGRTbGlkZUNvbnRlbnQoc3BvdCkge1xuICAgIHZhciBmb3JtYXR0ZWREYXRhID0gXCJcIjtcbiAgICB2YXIgbG9jID0gXCJsbD1cIiArIHNwb3QubG9jYXRpb24ubGF0LnRvU3RyaW5nKCkgKyBcIixcIiArIHNwb3QubG9jYXRpb24ubG5nLnRvU3RyaW5nKCk7XG4gICAgdmFyIGFqYXhfZXJyb3I7XG5cbiAgICAvLyBnZXQgdGhlIGZvdXJzcXVhcmUgSUQgbnVtYmVyIG9mIHRoZSBzcG90XG4gICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogZm91clNxdWFyZVVSTCArICcvdjIvdmVudWVzL3NlYXJjaCcsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgZGF0YTogJ2xpbWl0PTEnICtcbiAgICAgICAgICAgICAgICAgICAgJyYnICsgbG9jICsgJyZxdWVyeT0nICsgc3BvdC5uYW1lICtcbiAgICAgICAgICAgICAgICAgICAgJyZjbGllbnRfaWQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfaWQgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9zZWNyZXQ9Jysga3IuZm91cnNxdWFyZS5DbGllbnRfc2VjcmV0ICtcbiAgICAgICAgICAgICAgICAgICAgJyZ2PTIwMTYwMTMwJyxcbiAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgc3VjY2VzczogZ2V0VmVudWVJbmZvLFxuICAgICAgICAgICAgZXJyb3I6IHNlbmRFcnJvclxuICAgIH0pO1xuXG4gICAgLy8gZ2l2ZSB0aGUgcmVzcG9uc2Ugb24gc3BlY2lmaWMgdmVudWUgdG8gYW5vdGhlciBjYWxsIGZvclxuICAgIC8vIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb25cbiAgICBmdW5jdGlvbiBnZXRWZW51ZUluZm8oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiSW4gZ2V0VmVudWVJbmZvOiBzdGF0dXMgPSBcIiArIHN0YXR1cyk7XG4gICAgICAgIHZhciB2ZW51ZSA9IGRhdGEucmVzcG9uc2UudmVudWVzWzBdO1xuICAgICAgICAvL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9WRU5VRV9JRFxuICAgICAgICAkLmFqYXgoeyAvLyB0byBnZXQgdGhlIGRldGFpbGVkIGZvdXJzcXVhcmUgb2YgdGhlICdjb21wbGV0ZSB2ZW51ZScgYmFzZWQgb24gSURcbiAgICAgICAgICAgIHVybDogZm91clNxdWFyZVVSTCArICcvdjIvdmVudWVzLycgKyB2ZW51ZS5pZCxcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICBkYXRhOiAnbGltaXQ9MScgK1xuICAgICAgICAgICAgICAgICAgICAnJicgKyBsb2MgK1xuICAgICAgICAgICAgICAgICAgICAnJnF1ZXJ5PScgKyBzcG90Lm5hbWUgK1xuICAgICAgICAgICAgICAgICAgICAnJmNsaWVudF9pZD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9pZCArXG4gICAgICAgICAgICAgICAgICAgICcmY2xpZW50X3NlY3JldD0nKyBrci5mb3Vyc3F1YXJlLkNsaWVudF9zZWNyZXQgK1xuICAgICAgICAgICAgICAgICAgICAnJnY9MjAxNjAxMzAnLFxuICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBmb3JtYXRTaG93RGF0YSxcbiAgICAgICAgICAgIGVycm9yOiBzZW5kRXJyb3JcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZm9ybWF0U2hvd0RhdGEoZGF0YSl7XG4gICAgICAgIHZhciB2ZW51ZSA9IGRhdGEucmVzcG9uc2UudmVudWU7XG4gICAgICAgIGZvcm1hdHRlZERhdGEgPSAnRm91clNxdWFyZSBpbmZvOiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8YnI+JyArICc8YnI+JyArIHZlbnVlLm5hbWUgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVudWUuY29udGFjdC5mb3JtYXR0ZWRQaG9uZSArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uYWRkcmVzcyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnLSAnICsgdmVudWUubG9jYXRpb24uY2l0eSAgKyAnPGJyPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJy0gJyArIHZlbnVlLmxvY2F0aW9uLmNvdW50cnkgICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICd4LXN0cmVldDogJyArIHZlbnVlLmxvY2F0aW9uLmNyb3NzU3RyZWV0ICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDaGVjay1pbnM6ICcgKyB2ZW51ZS5zdGF0cy5jaGVja2luc0NvdW50LnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzxicj4nICsgdmVudWUubGlrZXMuc3VtbWFyeSArICc8YnI+JyArICc8YnI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiMnICsgdmVudWUucmF0aW5nQ29sb3IgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJztjb2xvcjpibGFjaztwYWRkaW5nOjElXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAnUmF0aW5nOiAnICsgdmVudWUucmF0aW5nLnRvU3RyaW5nKCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgJzwvc3Bhbj4nICsgJzxicj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIicgKyB2ZW51ZS5iZXN0UGhvdG8ucHJlZml4ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjYXAzMDAnICsgdmVudWUuYmVzdFBob3RvLnN1ZmZpeCArICdcIj4nXG4gICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgIC8vc3BvdC5zbGlkZUNvbnRlbnQgPSBmb3JtYXR0ZWREYXRhO1xuICAgICAgICB1cGRhdGVTbGlkZUNvbnRlbnQoc3BvdCwgZm9ybWF0dGVkRGF0YSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNlbmRFcnJvcihvYmplY3QsIGVycm9yLCBleGNlcHRpb24pIHtcbiAgICAgICAgLy8gaWYgYXBpIG5vdCB3b3JraW5nIChhbmQgbG9jYWwgc3RvcmFnZSBpcyBjbGVhcmVkKVxuICAgICAgICAvLyB0aGVuIGNvbnRlbnQgb2YgZWFjaCBzbGlkZSBpcyBzZXQgdG8gZXJyb3IgbXNnXG4gICAgICAgIHZhciBhamF4X2Vycm9yID0gXCJTb3JyeS4gM3JkIHBhcnR5IGluZm8gdW5hdmFpbGFibGUuXCI7XG4gICAgICAgIHVwZGF0ZVNsaWRlQ29udGVudChzcG90LCBhamF4X2Vycm9yKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVNsaWRlQ29udGVudChzcG90LCBkYXRhU3RyaW5nKSB7XG4gICAgLy8gdXBkYXRlIHRoZSBtb2RlbFxuICAgIHNwb3Quc2xpZGVDb250ZW50ID0gZGF0YVN0cmluZztcbiAgICAvLyB1cGRhdGUgdGhlIHZpZXdcbiAgICB2YXIgdm1TcG90ID0gZ2V0U3BvdChzcG90Lm5hbWUpO1xuICAgIGlmICh2bVNwb3QpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJpbiB1cGRhdGVTbGlkZUNvbnRlbnQ6IHZpZXdTcG90IFwiKTtcbiAgICAgICAgdm1TcG90LnNsaWRlQ29udGVudCA9IGRhdGFTdHJpbmc7XG4gICAgfVxufVxuXG4vLyBNYXJrTidzIGltcGxlbWVudGF0aW9uIG9mXG4vKipcbiAqIEdlbmVyYXRlcyBhIHJhbmRvbSBudW1iZXIgYW5kIHJldHVybnMgaXQgYXMgYSBzdHJpbmcgZm9yIE9BdXRoZW50aWNhdGlvblxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG4vLyBmdW5jdGlvbiBub25jZV9nZW5lcmF0ZSgpIHtcbi8vICAgcmV0dXJuIChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxZTEyKS50b1N0cmluZygpKTtcbi8vIH1cblxuLy8gdmFyIHllbHBfdXJsID0gWUVMUF9CQVNFX1VSTCArICdidXNpbmVzcy8nICsgc2VsZi5zZWxlY3RlZF9wbGFjZSgpLlllbHAuYnVzaW5lc3NfaWQ7XG5cbi8vICAgICB2YXIgcGFyYW1ldGVycyA9IHtcbi8vICAgICAgIG9hdXRoX2NvbnN1bWVyX2tleTogWUVMUF9LRVksXG4vLyAgICAgICBvYXV0aF90b2tlbjogWUVMUF9UT0tFTixcbi8vICAgICAgIG9hdXRoX25vbmNlOiBub25jZV9nZW5lcmF0ZSgpLFxuLy8gICAgICAgb2F1dGhfdGltZXN0YW1wOiBNYXRoLmZsb29yKERhdGUubm93KCkvMTAwMCksXG4vLyAgICAgICBvYXV0aF9zaWduYXR1cmVfbWV0aG9kOiAnSE1BQy1TSEExJyxcbi8vICAgICAgIG9hdXRoX3ZlcnNpb24gOiAnMS4wJyxcbi8vICAgICAgIGNhbGxiYWNrOiAnY2InICAgICAgICAgICAgICAvLyBUaGlzIGlzIGNydWNpYWwgdG8gaW5jbHVkZSBmb3IganNvbnAgaW1wbGVtZW50YXRpb24gaW4gQUpBWCBvciBlbHNlIHRoZSBvYXV0aC1zaWduYXR1cmUgd2lsbCBiZSB3cm9uZy5cbi8vICAgICB9O1xuXG4vLyAgICAgdmFyIGVuY29kZWRTaWduYXR1cmUgPSBvYXV0aFNpZ25hdHVyZS5nZW5lcmF0ZSgnR0VUJyx5ZWxwX3VybCwgcGFyYW1ldGVycywgWUVMUF9LRVlfU0VDUkVULCBZRUxQX1RPS0VOX1NFQ1JFVCk7XG4vLyAgICAgcGFyYW1ldGVycy5vYXV0aF9zaWduYXR1cmUgPSBlbmNvZGVkU2lnbmF0dXJlO1xuXG4vLyAgICAgdmFyIHNldHRpbmdzID0ge1xuLy8gICAgICAgdXJsOiB5ZWxwX3VybCxcbi8vICAgICAgIGRhdGE6IHBhcmFtZXRlcnMsXG4vLyAgICAgICBjYWNoZTogdHJ1ZSwgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBjcnVjaWFsIHRvIGluY2x1ZGUgYXMgd2VsbCB0byBwcmV2ZW50IGpRdWVyeSBmcm9tIGFkZGluZyBvbiBhIGNhY2hlLWJ1c3RlciBwYXJhbWV0ZXIgXCJfPTIzNDg5NDg5NzQ5ODM3XCIsIGludmFsaWRhdGluZyBvdXIgb2F1dGgtc2lnbmF0dXJlXG4vLyAgICAgICBkYXRhVHlwZTogJ2pzb25wJyxcbi8vICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdHMpIHtcbi8vICAgICAgICAgLy8gRG8gc3R1ZmYgd2l0aCByZXN1bHRzXG4vLyAgICAgICB9LFxuLy8gICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICAvLyBEbyBzdHVmZiBvbiBmYWlsXG4vLyAgICAgICB9XG4vLyAgICAgfTtcblxuLy8gICAgIC8vIFNlbmQgQUpBWCBxdWVyeSB2aWEgalF1ZXJ5IGxpYnJhcnkuXG4vLyAgICAgJC5hamF4KHNldHRpbmdzKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL01BUCBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIG1hcDtcbnZhciB2bVNwb3RzID0gW107XG52YXIgaW5mb3dpbmRvdztcblxudmFyIFJlZFJvYWRzTkdyZWVuQnVzU3RvcHMgPSBbXG4gIHtcbiAgICBcImZlYXR1cmVUeXBlXCI6IFwicG9pXCIsXG4gICAgXCJlbGVtZW50VHlwZVwiOiBcImxhYmVsc1wiLFxuICAgIFwic3R5bGVyc1wiOiBbXG4gICAgICAgIHsgdmlzaWJpbGl0eTogXCJvZmZcIiB9XG4gICAgXVxuICB9LFxuICB7XG4gICAgXCJmZWF0dXJlVHlwZVwiOiBcInJvYWRcIixcbiAgICBcInN0eWxlcnNcIjogW1xuICAgICAgeyBcImdhbW1hXCI6IDAuNjUgfSxcbiAgICAgIHsgXCJodWVcIjogXCIjZmY5YzMwXCIgfSxcbiAgICAgIHsgXCJ2aXNpYmlsaXR5XCI6IFwib25cIiB9LFxuICAgICAgeyBcInNhdHVyYXRpb25cIjogOTkgfSxcbiAgICAgIHsgXCJsaWdodG5lc3NcIjogLTEyIH1cbiAgICBdXG4gIH0se1xuICAgIFwiZmVhdHVyZVR5cGVcIjogXCJ0cmFuc2l0XCIsXG4gICAgXCJzdHlsZXJzXCI6IFtcbiAgICAgIHsgXCJodWVcIjogXCIjMDBmZjMzXCIgfSxcbiAgICAgIHsgXCJnYW1tYVwiOiAwLjYwIH0sXG4gICAgICB7IFwic2F0dXJhdGlvblwiOiA1IH0sXG4gICAgICB7IFwidmlzaWJpbGl0eVwiOiBcIm9uXCIgfSxcbiAgICAgIHsgXCJ3ZWlnaHRcIjogNC42IH0sXG4gICAgICB7IFwibGlnaHRuZXNzXCI6IC0xMiB9IC8vd2FzIC0yMlxuICAgIF1cbiAgfVxuXTtcblxudmFyIG1hcE9wdGlvbnMgPSB7XG4gICAgICAgIGNlbnRlcjoge2xhdDogNDkuMjYyMzg3LCBsbmc6IC0xMjMuMDY5ODY4fSwvLzQ5LjI2MjM4NywgLTEyMy4wNjk3NjhcbiAgICAgICAgLy8gQ29tbWVyY2lhbCBCcm9hZHdheSBTdGF0aW9uIDQ5wrAxNeKAsjQ14oCzTiwgMTIzwrAwNOKAsjA44oCzV1xuICAgICAgICB6b29tOiAxNixcbiAgICAgICAgem9vbUNvbnRyb2w6IHRydWUsXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZSxcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgICBkaXNhYmxlRG91YmxlQ2xpY2tab29tOiB0cnVlLFxuICAgICAgICBkaXNhYmxlRGVmYXVsdFVJOiB0cnVlLFxuICAgICAgICBzdHlsZXM6IFJlZFJvYWRzTkdyZWVuQnVzU3RvcHNcbiAgICB9O1xuXG52YXIgaWNvbnMgPSB7XG4gIGFzaWFuOiB7XG4gICAgaWNvbjogJ2ltZy9hc2lhbi5wbmcnXG4gIH0sXG4gIGNvZmZlZToge1xuICAgIGljb246ICdpbWcvY29mZmVlLnBuZydcbiAgfSxcbiAgZm9vZDoge1xuICAgIGljb246ICdpbWcvZm9vZC5wbmcnXG4gIH0sXG4gIGp1aWNlOiB7XG4gICAgaWNvbjogJ2ltZy9qdWljZS5wbmcnXG4gIH0sXG4gIHBpenphOiB7XG4gICAgaWNvbjogJ2ltZy9waXp6YS5wbmcnXG4gIH1cbn07XG5cbi8vIGludm9rZWQgYnkgbWFwIDxzY3JpcHQ+IGluIGluZGV4Lmh0bWxcbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWRpdicpLCBtYXBPcHRpb25zICk7XG4gICAgbW9kZWwgPSBnZXRNb2RlbCgpOyAvLyBsb2FkIGRhdGEgb2JqZWN0IGVpdGhlciBmcm9tIGxvY2FsU3RvcmFnZSBvciBmaWxlXG4gICAgLy8gdGhlbiBidWlsZCB0aGUgc2xpZGUgY29udGVudCB3aXRoIGFqYXggYXBpIGNhbGxzLCBpZiBuZWNlc3NhcnlcbiAgICBpZiAoIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQgPT09IHVuZGVmaW5lZCkgfHxcbiAgICAgICAgIChtb2RlbC5zcG90c1swXS5zbGlkZUNvbnRlbnQuc2xpY2UoMCw1KSA9PSBcIlNvcnJ5XCIpKSB7XG4gICAgICAgICAgICBtb2RlbC5zcG90cy5mb3JFYWNoKCBmdW5jdGlvbiAoc3BvdCkge1xuICAgICAgICAgICAgICAgIGJ1aWxkU2xpZGVDb250ZW50KHNwb3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmlld01vZGVsLnNwb3RMaXN0KG1vZGVsLnNwb3RzKTtcbiAgICB2aWV3TW9kZWwuZmlsdGVyT24oIW5hcnJvd1NjcmVlbigpKTtcblxuICAgIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7fSk7XG4gICAgbWFwLnNldFpvb20obW9kZWwuem9vbUxldmVsKTtcbiAgICBtYXAuc2V0Q2VudGVyKG1vZGVsLmNlbnRlcik7XG5cbiAgICAvL2J1aWxkIGFycmF5IG9mIGVhdGluZyBzcG90IG9iamVjdHMgYmFzZWQgb24gdGhlIG1vZGVsXG4gICAgbW9kZWwuc3BvdHMuZm9yRWFjaCggZnVuY3Rpb24oc3BvdCkge1xuICAgICAgICB2bVNwb3RzLnB1c2gobmV3IFNwb3Qoc3BvdCkpO1xuICAgIH0pO1xuXG4gICAgLy8gc3RheSBjZW50cmVkXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIG1hcC5zZXRDZW50ZXIobW9kZWwuY2VudGVyKTtcbiAgICAgICAgdmlld01vZGVsLmZpbHRlck9uKCFuYXJyb3dTY3JlZW4oKSk7XG4gICAgfSk7XG5cbiAgICAvLyB3aGVuIHRoaW5ncyBzZXR0bGUgZG93biwgc3RvcmUgYSBjb3B5IG9mIHRoZSBtb2RlbCBsb2NhbGx5XG4gICAgd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBsb2NhbFN0b3JhZ2UubW9kZWwgPSBKU09OLnN0cmluZ2lmeShtb2RlbCk7XG4gICAgfSwgMzAwMCk7XG59XG5cbi8vIGNvbnN0cnVjdG9yXG52YXIgU3BvdCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XG4gIHRoaXMubG9jYXRpb24gPSBkYXRhLmxvY2F0aW9uO1xuICB0aGlzLmNhdGVnb3J5ID0gZGF0YS5jYXRlZ29yeTtcbiAgdGhpcy5zbGlkZUNvbnRlbnQgPSBkYXRhLnNsaWRlQ29udGVudDtcbiAgdGhpcy5tYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgcG9zaXRpb246IHRoaXMubG9jYXRpb24sXG4gICAgICAgIHRpdGxlOiB0aGlzLm5hbWUsXG4gICAgICAgIGljb246IGljb25zW3RoaXMuY2F0ZWdvcnldLmljb24sXG4gICAgICAgIG1hcDogbWFwLFxuICAgICAgICBvcGFjaXR5OiAwLjRcbiAgfSk7XG4gIHRoaXMud2luZG93Q29udGVudCA9IGJ1aWxkV2luZG93Q29udGVudCh0aGlzLm1hcmtlcik7XG5cbiAgdGhpcy5jbGlja0V2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodGhpcy5tYXJrZXIsIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LmRvT3BlbmluZygpO1xuICAgIH0pO1xuICB0aGlzLm92ZXJFdmVudCA9IGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHRoaXMubWFya2VyLCBcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoYXQuaGlMaWdodExpc3RJdGVtKCk7XG4gIH0pO1xuICB0aGlzLm91dEV2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIodGhpcy5tYXJrZXIsIFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGF0LmxvTGlnaHRMaXN0SXRlbSgpO1xuICB9KTtcbn07XG5cblNwb3QucHJvdG90eXBlLmhpTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICQoXCJsaTpjb250YWlucyhcIiArIHRoYXQubmFtZSArIFwiKVwiKS50b2dnbGVDbGFzcyggXCJoaWxpZ2h0IHVuZGVyXCIgKTtcbn07XG5cblNwb3QucHJvdG90eXBlLmxvTGlnaHRMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgJChcImxpOmNvbnRhaW5zKFwiICsgdGhhdC5uYW1lICsgXCIpXCIpLnRvZ2dsZUNsYXNzKFwiaGlsaWdodCB1bmRlclwiKTtcbn07XG5cblNwb3QucHJvdG90eXBlLmRvQm91bmNlID0gZnVuY3Rpb24gKCkgIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgY2xlYW5VcFNjcmVlbigpO1xuICAgIHRoaXMubWFya2VyLnNldEFuaW1hdGlvbihnb29nbGUubWFwcy5BbmltYXRpb24uQk9VTkNFKTtcbn07XG5cblNwb3QucHJvdG90eXBlLnN0b3BCb3VuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tYXJrZXIuc2V0QW5pbWF0aW9uKG51bGwpO1xufTtcblxuU3BvdC5wcm90b3R5cGUuZG9PcGVuaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBjbGVhblVwU2NyZWVuKCk7XG4gICAgdGhpcy5tYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhhdC5vcGVuV2luZG93KCk7XG4gICAgICAgIHRoYXQubWFya2VyLnNldEFuaW1hdGlvbihudWxsKTtcbiAgICB9LCAxMDAwKTtcbn07XG5cblNwb3QucHJvdG90eXBlLm9wZW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHZpZXdNb2RlbC5saXN0Q29sbGFwc2UoKTtcbiAgICBpbmZvd2luZG93LnNldENvbnRlbnQodGhpcy53aW5kb3dDb250ZW50KTtcbiAgICBpbmZvd2luZG93Lm9wZW4obWFwLCB0aGlzLm1hcmtlcik7XG4gICAgdGhpcy5jbG9zZUV2ZW50ID0gZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoaW5mb3dpbmRvdywgXCJjbG9zZWNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjbGVhblVwU2NyZWVuKCk7XG4gICAgICAgICAgdmlld01vZGVsLmxpc3RFeHBhbmQoKTtcbiAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5yZW1vdmVMaXN0ZW5lcih0aGF0LmNsb3NlRXZlbnQpO1xuICAgIH0pO1xufTtcblxuU3BvdC5wcm90b3R5cGUuaGlkZU1hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG51bGwpOyB9O1xuU3BvdC5wcm90b3R5cGUuc2hvd01hcmtlciA9IGZ1bmN0aW9uICgpIHsgdGhpcy5tYXJrZXIuc2V0TWFwKG1hcCk7IH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9LTyBWSUVXTU9ERUwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbnZhciBWaWV3TW9kZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gRGF0YVxuICAgIHNlbGYubGlzdE9uID0ga28ub2JzZXJ2YWJsZSh0cnVlKTtcbiAgICBzZWxmLmJ1cmdlck1lbnUgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgICBzZWxmLnNwb3RMaXN0ID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgc2VsZi5zbGlkZU9uID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gICAgc2VsZi5zbGlkZUNvbnRlbnQgPSBrby5vYnNlcnZhYmxlKCk7XG4gICAgc2VsZi5maWx0ZXJPbiA9IGtvLm9ic2VydmFibGUodHJ1ZSk7XG4gICAgc2VsZi5maWx0ZXJTbG90ID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgIHNlbGYuaXNTZWxlY3RlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuXG4gICAgLy8gQmVoYXZpb3Vyc1xuXG4gICAgc2VsZi5ib3VuY2VNYXJrZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3QuZG9Cb3VuY2UoKTtcbiAgICB9O1xuXG4gICAgc2VsZi51bmJvdW5jZU1hcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHRoaXMubmFtZSk7XG4gICAgICAgIHNwb3Quc3RvcEJvdW5jZSgpO1xuICAgIH07XG5cbiAgICBzZWxmLnNwb3RQaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzcG90ID0gZ2V0U3BvdCh0aGlzLm5hbWUpO1xuICAgICAgICBzcG90LmRvT3BlbmluZygpO1xuICAgIH07XG5cbiAgICBzZWxmLnNldEZpbHRlclNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaXNTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICAgICBzZWxmLmxpc3RFeHBhbmQoKTtcbiAgICB9O1xuXG4gICAgc2VsZi5maWx0ZXJTbG90LnN1YnNjcmliZShmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHNlbGYubGlzdEV4cGFuZCgpO1xuICAgICAgICBzZWxmLnNwb3RMaXN0KGZpbHRlckxpc3QoZGF0YSwgdm1TcG90cykpO1xuICAgICAgICByZXNldE1hcmtlcnMoc2VsZi5zcG90TGlzdCgpKTtcbiAgICB9KTtcblxuICAgIHNlbGYub25FbnRlciA9IGZ1bmN0aW9uIChkYXRhLCBldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93LmFuY2hvcikge1xuICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuQVBJc2xpZGUoaW5mb3dpbmRvdy5hbmNob3IudGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc3BvdExpc3QoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zcG90TGlzdCgpWzBdLmRvT3BlbmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbmZvd2luZG93KSBpbmZvd2luZG93LmNsb3NlKCk7IC8vZm9yIGFueSBvdGhlciBrZXlwcmVzc1xuICAgICAgICAgICAgc2VsZi5zbGlkZU9mZigpO1xuICAgICAgICAgICAgc2VsZi5saXN0RXhwYW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIG5lY2Vzc2FyeSB0byByZWZsZWN0IHRoZSB0ZXh0IGluIHRoZSBzbG90XG4gICAgfTtcblxuICAgIHNlbGYubGlzdENvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2Rpc2FibGUgZm9yIGJpZyBzY3JlZW47IGVuYWJsZSBmb3Igc21hbGxcbiAgICAgICAgLy8gdmFyIG1lZGlhcXVlcnkgPSB3aW5kb3cubWF0Y2hNZWRpYSggXCIobWF4LXdpZHRoOiA1NDlweClcIiApO1xuICAgICAgICAvLyBpZiAobWVkaWFxdWVyeS5tYXRjaGVzKSB7XG4gICAgICAgIC8vICAgICBzZWxmLmxpc3RPbihmYWxzZSk7XG4gICAgICAgIC8vICAgICBzZWxmLmJ1cmdlck1lbnUodHJ1ZSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICBpZiAobmFycm93U2NyZWVuKCkpIHtcbiAgICAgICAgICBzZWxmLmxpc3RPbihmYWxzZSk7XG4gICAgICAgICAgc2VsZi5idXJnZXJNZW51KHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHNlbGYubGlzdEV4cGFuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYW5VcFNjcmVlbigpO1xuICAgICAgICBzZWxmLmJ1cmdlck1lbnUoZmFsc2UpO1xuICAgICAgICBzZWxmLmxpc3RPbih0cnVlKTtcbiAgICB9O1xuXG4gICAgc2VsZi5vcGVuQVBJc2xpZGUgPSBmdW5jdGlvbiAoc3BvdE5hbWUpIHtcbiAgICAgICAgdmFyIHNwb3QgPSBnZXRTcG90KHNwb3ROYW1lKTtcbiAgICAgICAgaWYgKCEoc3BvdC5zbGlkZUNvbnRlbnQpKSB7XG4gICAgICAgICAgICBkdWJTbGlkZUNvbnRlbnRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmlld01vZGVsLnNsaWRlQ29udGVudChzcG90LnNsaWRlQ29udGVudCk7XG4gICAgICAgIHZpZXdNb2RlbC5zbGlkZU9uKHRydWUpO1xuICAgIH07XG5cbiAgICBzZWxmLnNsaWRlT2ZmID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNsaWRlT24oZmFsc2UpO1xuICAgIH07XG59O1xuXG52YXIgdmlld01vZGVsID0gbmV3IFZpZXdNb2RlbCgpO1xua28uYXBwbHlCaW5kaW5ncyh2aWV3TW9kZWwpO1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUhFTFBFUiBGVU5DVElPTlMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG5cbmZ1bmN0aW9uIGZpbHRlckxpc3QodXNlclRleHQsIG1vZGVsQXJyYXkpIHtcbi8vdGVzdCBhcnJheSBhZ2FpbnN0IGEgcmVndWxhciBleHByZXNzaW9uXG4gICAgIHZhciByZXN1bHQ9W10sXG4gICAgICAgICByZSA9IG5ldyBSZWdFeHAodXNlclRleHQsIFsnaSddKTtcbiAgICAgbW9kZWxBcnJheS5mb3JFYWNoKCBmdW5jdGlvbihlbGVtZW50LCBpbmRleCwgYXJyYXkpIHtcbiAgICAgICAgaWYgKHJlLnRlc3QoZWxlbWVudC5uYW1lKSkgcmVzdWx0LnB1c2goZWxlbWVudCk7XG4gICAgIH0pO1xuICAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBnZXRTcG90KG5hbWUpIHtcbi8vIHJldHVybnMgdGhlIHZpZXctbW9kZWwgb2JqZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtU3BvdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICggdm1TcG90c1tpXS5uYW1lID09IG5hbWUgKSByZXR1cm4gdm1TcG90c1tpXTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlc2V0TWFya2VycyhzcG90cykge1xuLy8gZWRpdCB0aGUgc2V0IG9mIGRpc3BsYXllZCBtYXJrZXJzIGJhc2VkIG9uIHRoZSBmaWx0ZXJlZCBzcG90TGlzdFxuICAgIHZtU3BvdHMuZm9yRWFjaChmdW5jdGlvbihzcG90KSB7XG4gICAgICAgIHNwb3QuaGlkZU1hcmtlcigpO1xuICAgIH0pO1xuICAgIHNwb3RzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBnZXRTcG90KGl0ZW0ubmFtZSkuc2hvd01hcmtlcigpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBpdGNod2luZG93KCkge1xuLy8gY2FsbGVkIGluIHRoZSBjbGljayBldmVudCBsaXN0ZW5lciBvZiBpbmZvV2luZG93XG4gICAgdmlld01vZGVsLm9wZW5BUElzbGlkZShpbmZvd2luZG93LmFuY2hvci50aXRsZSk7XG59XG5cbmZ1bmN0aW9uIGNsZWFuVXBTY3JlZW4oKSB7XG4vLyBnZXQgcmlkIG9mIG9sZCBvdmVyLWxheXMgYW5kIGxpbmdlcmluZyBlZmZlY3RzXG4gICAgaW5mb3dpbmRvdy5jbG9zZSgpO1xuICAgIG1hcC5zZXRab29tKG1vZGVsLnpvb21MZXZlbCk7XG4gICAgbWFwLnNldENlbnRlcihtb2RlbC5jZW50ZXIpO1xuICAgIHZpZXdNb2RlbC5zbGlkZU9mZigpO1xuICAgIC8vIHJlc2V0IHRoZSBoaWxpZ2h0IGFuZCB1bmRlciBjbGFzc2VzIG9uIHRoZSBzcG90LWxpc3RcbiAgICAkKFwidWwuc3BvdC1saXN0IGxpXCIpLnJlbW92ZUNsYXNzKFwiaGlsaWdodCB1bmRlclwiKTtcbn1cblxuZnVuY3Rpb24gZHViU2xpZGVDb250ZW50cygpIHtcbiAgICBpZiAobW9kZWwuc3BvdHNbMF0uc2xpZGVDb250ZW50KSB7XG4gICAgICAgIG1vZGVsLnNwb3RzLmZvckVhY2goZnVuY3Rpb24oc3BvdCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZtU3BvdHNbaW5kZXhdLnNsaWRlQ29udGVudCA9IHNwb3Quc2xpZGVDb250ZW50O1xuICAgICAgICAgICAgLy8gaW4gdGhlIGV2ZW50IHRoYXQgYXBpIGNhbGwgZmFpbHMsIHdlIHdhbnQgdG8gcmUtY29weSB0aGVcbiAgICAgICAgICAgIC8vIG1vZGVsIGxvY2FsbHksIHRvIGRpc3BsYXkgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLm1vZGVsID0gSlNPTi5zdHJpbmdpZnkobW9kZWwpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5hcnJvd1NjcmVlbigpIHtcbiAgdmFyIG1lZGlhcXVlcnkgPSB3aW5kb3cubWF0Y2hNZWRpYSggXCIobWF4LXdpZHRoOiA1NDlweClcIiApO1xuICBpZiAobWVkaWFxdWVyeS5tYXRjaGVzKSByZXR1cm4gdHJ1ZTtcbn1cblxuXG5cbi8vPT09PT09PT09PT09PT09PT09PVRIRSBFTkQ9PT09PT09PT09PT09PT09PT09XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8vZnJvbSBodHRwczovL2RldmVsb3Blci5mb3Vyc3F1YXJlLmNvbS9vdmVydmlldy9hdXRoI3VzZXJsZXNzXG4vL2h0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9zZWFyY2g/bGw9NDAuNywtNzQmY2xpZW50X2lkPUNMSUVOVF9JRCZjbGllbnRfc2VjcmV0PUNMSUVOVF9TRUNSRVQmdj1ZWVlZTU1ERFxuXG4vL2ZvdXJzcXVhcmUuY29tL3YvYnJvYWR3YXktc3RhdGlvbi1zdXNoaS80YWFlOWNiN2Y5NjRhNTIwOWI2MjIwZTNcbnZhciBrciA9IHtcbiAgICBmb3Vyc3F1YXJlOiB7XG4gICAgICAgIE93bmVyOiBcIktSIERlY2tlclwiLFxuICAgICAgICBDbGllbnRfaWQ6IFwiWlZMS1RLU0dVTEZFUTNYTVdXSTNBTDFBMktYWUJFS0QxTEtTVVJVWkRHWlk0MUpYXCIsXG4gICAgICAgIENsaWVudF9zZWNyZXQ6IFwiVE1UMjAzREhXT1BSM1I0UlNNMUhFNFJNT0tFV0xHVFQwRkxNWk1VWjFPSkhNQUsxXCJcbiAgICB9LFxuICAgIHllbHA6IHtcbiAgICAgICAgQ29uc3VtZXJfS2V5OiAgICBcIlhyeEpPVWdHTktxOVp1V2hCWDFMRHdcIixcbiAgICAgICAgQ29uc3VtZXJfU2VjcmV0OiBcInpyMkk3Nm5UOGwwTy10cmt1cFlFMDBCOUJUQVwiLFxuICAgICAgICBUb2tlbjogICBcIi1fRjhhT3hvblI2cTVTcXZVUnd3Z0xJZFUtcXRlUy1CXCIsXG4gICAgICAgIFRva2VuX1NlY3JldDogICAgXCJHRjd1UmNQV0NwemxIY1JQM0RpSldqdmNYSkVcIlxuICAgIH0sXG4gICAgc3RyZWV0dmlldzoge1xuICAgICAgICBrZXk6IFwiQUl6YVN5QVA2MzF6NldxTW9wdG9hR2hlcmhKVkJHeU4xdVBIUHQ0XCJcbiAgICB9XG59O1xuXG5cbi8vfSgpKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
